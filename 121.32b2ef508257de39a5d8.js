/*! For license information please see 121.32b2ef508257de39a5d8.js.LICENSE.txt */
"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[121],{58761:(t,e,r)=>{r.d(e,{K:()=>n});var n={name:"canyonSkybox",src:[r(91676),r(70902),r(642),r(96949),r(84855),r(55436)],type:"cube-map"}},85285:(t,e,r)=>{r.d(e,{Eb:()=>l,GV:()=>p,P6:()=>s,Vi:()=>i,eL:()=>c,oJ:()=>f,qZ:()=>a,vd:()=>u,w0:()=>h});var n,o=r(71881),i=null!==(n="prod")?n:"dev",a=!1,u=!1,c=!1,s=!1,l=!0,f="none",h=o.$.COIN_ITEM,p=function(){return"time-trials-test"===f||"grand-prix-test"===f};"dev"!==i&&(f="none",a=!1,u=!1,c=!1,h=o.$.COIN_ITEM,s=!1,l=!1)},8987:(t,e,r)=>{r.d(e,{N:()=>y,c:()=>d});var n=r(48418),o=r(73002),i=r(97774),a=r(17507),u=r(9332),c=r(85285);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function l(){l=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new C(n||[]);return o(a,"_invoke",{value:T(t,r,u)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var y="suspendedStart",d="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function S(){}var x={};f(x,a,(function(){return this}));var O=Object.getPrototypeOf,P=O&&O(O(A([])));P&&P!==r&&n.call(P,a)&&(x=P);var E=S.prototype=g.prototype=Object.create(x);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var c=p(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==s(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function T(e,r,n){var o=y;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=_(u,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===y)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var s=p(e,r,n);if("normal"===s.type){if(o=n.done?m:d,s.arg===b)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=m,n.method="throw",n.arg=s.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(s(e)+" is not iterable")}return w.prototype=S,o(E,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=f(S,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,S):(t.__proto__=S,f(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(k.prototype),f(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(h(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),f(E,c,"Generator"),f(E,a,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function f(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function h(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){f(i,n,o,a,u,"next",t)}function u(t){f(i,n,o,a,u,"throw",t)}a(void 0)}))}}var p=(0,a.Z)(function(){var t=h(l().mark((function t(e){var r;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=n.Xd.network.region,t.next=4,fetch("".concat(o.h.getRegionPath(r),"/broadcast/logError"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),(0,u.Z)();case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}(),2e3,{leading:!0,trailing:!1});function y(){window.addEventListener("error",function(){var t=h(l().mark((function t(e){var r,n;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{n={env:c.Vi,userId:i.u.getTrackingId(),message:e.message,bubbles:e.bubbles,lineno:e.lineno,colno:e.colno,error:null===(r=e.error)||void 0===r?void 0:r.stack},p(n)}catch(t){(0,u.Z)()}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),window.addEventListener("unhandledrejection",(function(t){try{var e,r,n={env:c.Vi,userId:i.u.getTrackingId(),message:(null===(e=t.reason)||void 0===e?void 0:e.message)||"Unhandled promise rejection",stack:(null===(r=t.reason)||void 0===r?void 0:r.stack)||null};p(n)}catch(t){(0,u.Z)()}}))}function d(t){return v.apply(this,arguments)}function v(){return(v=h(l().mark((function t(e){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p(e));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},50602:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a(n.key),n)}}function i(t,e,r){return(e=a(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}r.d(e,{Z:()=>u});var u=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,"listeners",{}),i(this,"i",0)},(e=[{key:"push",value:function(t){Object.values(this.listeners).forEach((function(e){return e(t)}))}},{key:"addListener",value:function(t){var e=this,r=this.i++;return this.listeners[r]=t,function(){delete e.listeners[r]}}}])&&o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()},54516:(t,e,r)=>{r.d(e,{F:()=>O,h:()=>P});var n=r(69628);const o=r.p+"b8c0589b669aa7e3bb8a.webp",i=r.p+"a3b2bea749d6c4c3a31f.webp";var a=r(78099);const u=r.p+"d5ac0cbcf8fd4787608b.webp",c=r.p+"b270f12609097caced23.webp";var s=r(94433);const l=r.p+"d94a0f1a022bd488d8c7.webp",f=r.p+"3e4bfb05dc9f5ebf46e8.webp";var h=r(72172);const p=r.p+"57ab58f65d892c9fe873.webp",y=r.p+"232023d6a8ad6213c8e5.webp";var d=r(36496);const v=r.p+"d9afd60916d8a41a98fa.webp",m=r.p+"fce1eb86e3057ca31efd.webp";var b=r(5037);function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function w(){w=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new C(n||[]);return o(a,"_invoke",{value:T(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function S(){}var x={};s(x,a,(function(){return this}));var O=Object.getPrototypeOf,P=O&&O(O(A([])));P&&P!==r&&n.call(P,a)&&(x=P);var E=S.prototype=m.prototype=Object.create(x);function j(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==g(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function T(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=_(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(g(e)+" is not iterable")}return b.prototype=S,o(E,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:b,configurable:!0}),b.displayName=s(S,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,S):(t.__proto__=S,s(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(k.prototype),s(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),s(E,c,"Generator"),s(E,a,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function S(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}var x=function(t){return t.default},O=[{id:n.MapIds.CANYON,name:"Cloudveil Canyon",author:"The Drift.io Team",modulePath:function(){return Promise.all([r.e(302),r.e(545),r.e(146),r.e(259),r.e(224)]).then(r.bind(r,60224)).then(x)},bannerImg:o,loaderImg:i,miniMap:a},{id:n.MapIds.VINEYARD,name:"Vineyard View Circuit",author:"The Drift.io Team",modulePath:function(){return Promise.all([r.e(302),r.e(361),r.e(545),r.e(638)]).then(r.bind(r,18638)).then(x)},bannerImg:u,loaderImg:c,miniMap:s},{id:n.MapIds.SKI_RESORT,name:"Grand Glacier Resort",author:"The Drift.io Team",modulePath:function(){return Promise.all([r.e(302),r.e(545),r.e(146),r.e(222)]).then(r.bind(r,14222)).then(x)},bannerImg:l,loaderImg:f,miniMap:h},{id:n.MapIds.BEACH,name:"Caldera Cove",author:"The Drift.io Team",modulePath:function(){return Promise.all([r.e(302),r.e(545),r.e(942),r.e(527)]).then(r.bind(r,87527)).then(x)},bannerImg:p,loaderImg:y,miniMap:d},{id:n.MapIds.DELTA_DISTRICT,name:"Delta District",author:"The Drift.io Team",modulePath:function(){return Promise.all([r.e(302),r.e(545),r.e(942),r.e(892)]).then(r.bind(r,56892)).then(x)},bannerImg:v,loaderImg:m,miniMap:b}];function P(t){return E.apply(this,arguments)}function E(){var t;return t=w().mark((function t(e){var r,n;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=O.find((function(t){return t.id===e}))){t.next=3;break}throw new Error("Map with id ".concat(e," not found"));case 3:return t.next=5,r.modulePath();case 5:return n=t.sent,t.abrupt("return",new n);case 7:case"end":return t.stop()}}),t)})),E=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){S(i,n,o,a,u,"next",t)}function u(t){S(i,n,o,a,u,"throw",t)}a(void 0)}))},E.apply(this,arguments)}},74650:(t,e,r)=>{r.d(e,{O:()=>x,q:()=>O});var n=r(69628),o=r(84350),i=r(93606),a=r(54322),u=r(87887),c=r(74769),s=r(35101),l=r(39279),f=r(68465),h=r(6842),p=r(99714),y=r(44775),d=r(92893),v=r(51526);function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function g(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=m(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==m(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var w,S={ost1:{img:r(73967),name:"Drift.io OST 1"}},x=g(g(g(g(g({},n.MapIds.CANYON,{type:"loop",introSrc:i,loopSrc:a,title:"Cloudveil Canyon",album:S.ost1,colors:["#422503","#fa8107"],artist:"Devin Chin"}),n.MapIds.VINEYARD,{type:"loop",introSrc:u,loopSrc:c,title:"Vineyard View Circuit",album:S.ost1,colors:["#034212","#0eeb4d"],artist:"Devin Chin"}),n.MapIds.SKI_RESORT,{type:"loop",introSrc:s,loopSrc:l,title:"Grand Glacier Resort",album:S.ost1,colors:["#032b42","#07a1fa"],artist:"Devin Chin"}),n.MapIds.BEACH,{type:"loop",introSrc:f,loopSrc:h,title:"Caldera Cove",album:S.ost1,colors:["#034236","#07faf2"],artist:"Devin Chin"}),n.MapIds.DELTA_DISTRICT,{type:"loop",introSrc:p,loopSrc:y,title:"Delta District",album:S.ost1,colors:["#323538","#dcedfc"],artist:"Devin Chin"}),O=[{type:"regular",src:o,colors:["#420303","#fa0707"],title:"Into Forever",album:S.ost1,artist:"Devin Chin & Katelyn Isaacson"}].concat(function(t){if(Array.isArray(t))return b(t)}(w=Object.values(x))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(w)||function(t,e){if(t){if("string"==typeof t)return b(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(t,e):void 0}}(w)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[{type:"loop",introSrc:d,loopSrc:v,title:"Cursed Catacombs",album:S.ost1,colors:["#290342","#9107fa"],artist:"Devin Chin"}])},47056:(t,e,r)=>{r.d(e,{$v:()=>l,CH:()=>h,I6:()=>u,N:()=>d,SY:()=>i,ZP:()=>m,dX:()=>y,gg:()=>f,gi:()=>a,lQ:()=>s,wq:()=>c,yR:()=>v,yi:()=>p});var n=(0,r(52438).oM)({name:"game",initialState:{loading:-1,startOfGame:!0,waitingToStart:!0,boosting:!1,paused:!1,enteringMatch:!1,position:1,laps:{lap:0,maxLaps:0},highPing:!1,inventoryVisible:!1,playState:"SPECTATING"},reducers:{setGameLoading:function(t,e){var r=e.payload;t.loading=r},setBoosting:function(t,e){var r=e.payload;t.boosting=r},setPaused:function(t,e){var r=e.payload;t.paused=r},setPosition:function(t,e){var r=e.payload;t.position=r},setStartOfGame:function(t,e){var r=e.payload;t.startOfGame=r},setCountDown:function(t,e){var r=e.payload;t.countDown=r},setLapInfo:function(t,e){var r,n,o=e.payload;t.laps.lap=null!==(r=o.lap)&&void 0!==r?r:t.laps.lap,t.laps.maxLaps=null!==(n=o.maxLaps)&&void 0!==n?n:t.laps.maxLaps},setHighPing:function(t,e){var r=e.payload;t.highPing=r},setInventoryVisibility:function(t,e){var r=e.payload;t.inventoryVisible=r},setEnteringMatch:function(t,e){var r=e.payload;t.enteringMatch=r},setWaitingToStart:function(t,e){var r=e.payload;t.waitingToStart=r},setPlayState:function(t,e){var r=e.payload;t.playState=r}}}),o=n.actions,i=o.setGameLoading,a=o.setBoosting,u=o.setPaused,c=o.setPosition,s=o.setStartOfGame,l=o.setCountDown,f=o.setLapInfo,h=o.setHighPing,p=o.setInventoryVisibility,y=o.setEnteringMatch,d=o.setWaitingToStart,v=o.setPlayState;const m=n.reducer},41475:(t,e,r)=>{r.d(e,{Z:()=>i,h:()=>o});var n=(0,r(52438).oM)({name:"gamepad",initialState:{activeIndex:null,gamepadBrand:"xbox"},reducers:{setGamepad:function(t,e){var r=e.payload;t.activeIndex=r?r.index:null,r&&(r.id.toLowerCase().includes("xbox")?t.gamepadBrand="xbox":r.id.toLowerCase().includes("playstation")?t.gamepadBrand="playstation":r.id.toLowerCase().includes("vendor: 057e product: 2009")&&(t.gamepadBrand="switch"))}}}),o=n.actions.setGamepad;const i=n.reducer},27255:(t,e,r)=>{r.d(e,{Cr:()=>h,Hz:()=>d,K4:()=>y,Ts:()=>S,Vp:()=>f,ZP:()=>x,_D:()=>a,aX:()=>c,aq:()=>u,bs:()=>s,ck:()=>m,dF:()=>l,hB:()=>b,jY:()=>v,o$:()=>g,te:()=>w,wE:()=>p});var n={updateScene:function(t,e){var r=e.payload;t.scene=r},updateFirstInteraction:function(t,e){var r=e.payload;t.firstInteraction=r},gameInitialized:function(t){t.gameInitialized=!0},networkInitialized:function(t,e){var r=e.payload;t.networkInitialized=r},firstSceneLoaded:function(t){t.firstSceneLoaded=!0},updateAlert:function(t,e){var r=e.payload;t.alert=r},setLoading:function(t,e){var r=e.payload;t.loading=r},updateGameKeys:function(t,e){var r=e.payload;t.gameKeys=r},addMessage:function(t,e){var r=e.payload;t.messages.push(r)},clearMessages:function(t){t.messages=[]},updateProfile:function(t,e){var r=e.payload;t.isActiveUser=void 0!==r,t.profile=r},updateCoins:function(t,e){var r=e.payload;t.profile&&(t.profile.coins=r)},updateGems:function(t,e){var r=e.payload;t.profile&&(t.profile.gems=r)},updateLoginModalOpen:function(t,e){var r=e.payload;t.loginModalOpen=r},updateTransitionLoading:function(t,e){var r=e.payload;t.transitionLoading=r},setInitialLoadComplete:function(t,e){var r=e.payload;t.initialLoadComplete=r}},o=(0,r(52438).oM)({name:"global",initialState:{scene:"MAIN-MENU",firstInteraction:!1,gameInitialized:!1,networkInitialized:!1,initialLoadComplete:!1,firstSceneLoaded:!1,alert:void 0,loading:!0,transitionLoading:void 0,messages:[],loginModalOpen:!1},reducers:n}),i=o.actions,a=i.updateTransitionLoading,u=i.updateScene,c=i.updateFirstInteraction,s=i.gameInitialized,l=i.networkInitialized,f=i.firstSceneLoaded,h=i.updateAlert,p=i.updateGameKeys,y=i.setLoading,d=i.addMessage,v=i.clearMessages,m=i.updateProfile,b=i.updateLoginModalOpen,g=i.updateCoins,w=i.updateGems,S=i.setInitialLoadComplete;const x=o.reducer},96849:(t,e,r)=>{r.d(e,{JX:()=>p,ZP:()=>y,iX:()=>f,oS:()=>l,wh:()=>h});var n=r(52438),o=r(82279);function i(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var u={setGrandPrixResults:function(t,e){var r=e.payload;r&&(t.playerIndex=r.playerIndex,t.players=i(r.players).sort((function(t,e){return(0,o.qJ)(t)&&(0,o.qJ)(e)?0:(0,o.qJ)(t)?1:(0,o.qJ)(e)?-1:t.placement-e.placement})))},setGrandPrixResultsVisibility:function(t,e){var r=e.payload;t.resultsVisible=r},setFinishedBanner:function(t,e){var r=e.payload;t.finishedBanner=r},setCanGetResults:function(t,e){var r=e.payload;t.canGetResults=r},setOnPodium:function(t,e){var r=e.payload;t.onPodium=r}},c=(0,n.oM)({name:"grandPrix",initialState:{resultsVisible:!1,canGetResults:!1,players:[],round:0,finishedBanner:!1,onPodium:!1},reducers:u}),s=c.actions,l=s.setGrandPrixResultsVisibility,f=s.setFinishedBanner,h=s.setGrandPrixResults,p=(s.setCanGetResults,s.setOnPodium);const y=c.reducer},93192:(t,e,r)=>{r.d(e,{I3:()=>f,T8:()=>l,Xf:()=>y,YA:()=>h,ZP:()=>v,n:()=>s,pe:()=>d,tu:()=>c,z:()=>p});var n=r(52438),o=r(69628),i={setRoom:function(t,e){var r=e.payload;t.room=r},navigateBack:function(t,e){var r=e.payload;t.page=t.page.slice(0,t.page.length-(null!=r?r:1))},navigateTo:function(t,e){var r=e.payload;t.page.push(r)},closePage:function(t){t.page=[]},setPage:function(t,e){var r=e.payload;t.page=Array.isArray(r)?r:[r]},setOpenCoinsModal:function(t,e){var r=e.payload;t.openCoinsModal=r},setOpenGemsModal:function(t,e){var r=e.payload;t.openGemsModal=r},setDisplayReward:function(t,e){var r=e.payload;t.displayReward=r}},a=(0,n.oM)({name:"mainMenu",initialState:{room:{state:"menu",gameType:"GrandPrix",roomId:"",players:{},region:"us-east",mapId:o.MapIds.CANYON},page:[],openCoinsModal:!1,openGemsModal:!1},reducers:i}),u=a.actions,c=u.setRoom,s=u.navigateBack,l=u.navigateTo,f=u.closePage,h=u.setPage,p=u.setOpenCoinsModal,y=u.setOpenGemsModal,d=u.setDisplayReward;const v=a.reducer},71274:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function a(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(e,{Pw:()=>h,ZP:()=>p,k$:()=>l,lr:()=>f});var u={updateAllMusicSettings:function(t,e){var r=e.payload;return i(i({},t),{},{visualizerEnabled:r.visualizerEnabled})},setSongPlaying:function(t,e){var r=e.payload;t.songPlaying=r},updateVisualizerEnabled:function(t,e){var r=e.payload;t.visualizerEnabled=r}},c=(0,r(52438).oM)({name:"music",initialState:{visualizerEnabled:!1},reducers:u}),s=c.actions,l=s.updateAllMusicSettings,f=s.setSongPlaying,h=s.updateVisualizerEnabled;const p=c.reducer},18973:(t,e,r)=>{r.d(e,{ZP:()=>u,b6:()=>i,km:()=>a});var n=(0,r(52438).oM)({name:"spectator",initialState:{username:"--------"},reducers:{setUsername:function(t,e){var r=e.payload;t.username=r},setSpectatorServerId:function(t,e){var r=e.payload;t.serverId=r}}}),o=n.actions,i=o.setUsername,a=o.setSpectatorServerId;const u=n.reducer},87331:(t,e,r)=>{r.d(e,{C:()=>o,Z:()=>i});var n=(0,r(52438).oM)({name:"timeTrial",initialState:{results:void 0},reducers:{setTimeTrialResults:function(t,e){var r=e.payload;t.results=r}}}),o=n.actions.setTimeTrialResults;const i=n.reducer},61201:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function i(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(e,{BD:()=>y,Ek:()=>f,W2:()=>p,ZP:()=>d,__:()=>h,fS:()=>s,xA:()=>l});var a={setTutorialStepData:function(t,e){var r=e.payload;t.data=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},r)},setGasPedalPressed:function(t,e){var r=e.payload;t.gasPedalPressed=r},setMobileSteeringPressed:function(t,e){var r=e.payload;t.mobileSteeringPressed=r},setGameResultsReceived:function(t,e){var r=e.payload;t.gameResultsReceived=r},setCrateOpenButtonPressed:function(t,e){var r=e.payload;t.crateOpenButtonPressed=r},setDisplayItemTutorial:function(t,e){var r=e.payload;t.displayItemTutorial=r}},u=(0,r(52438).oM)({name:"tutorial",initialState:{data:{step:"none"},gasPedalPressed:!1,mobileSteeringPressed:!1,gameResultsReceived:!1,crateOpenButtonPressed:!1,displayItemTutorial:!1},reducers:a}),c=u.actions,s=c.setTutorialStepData,l=c.setGasPedalPressed,f=c.setMobileSteeringPressed,h=c.setGameResultsReceived,p=c.setCrateOpenButtonPressed,y=c.setDisplayItemTutorial;const d=u.reducer},17902:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function a(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(e,{$T:()=>y,B8:()=>h,Cq:()=>g,P7:()=>f,Qu:()=>S,Vk:()=>l,ZP:()=>x,bP:()=>p,f6:()=>b,fP:()=>d,m1:()=>v,nd:()=>w,rZ:()=>m});var u={updateAllUISettings:function(t,e){var r=e.payload;return i(i({},t),{},{uiScaleSetting:r.uiScale,fpsStatEnabled:r.stats.fpsEnabled,pingStatEnabled:r.stats.pingEnabled,speedStatEnabled:r.stats.speedEnabled,frameComputeTimeEnabled:r.stats.frameComputeTimeEnabled,physicsComputeTimeEnabled:r.stats.physicsComputeTimeEnabled,gpuComputeTimeEnabled:r.stats.gpuComputeTimeEnabled})},updateWindowSize:function(t,e){var r=e.payload;t.height=r.height,t.scale=r.scale,t.width=r.width,t.isPortrait=r.isPortrait},updateFPSStatEnabled:function(t,e){var r=e.payload;t.fpsStatEnabled=r},updateUIScale:function(t,e){var r=e.payload;t.uiScaleSetting=r},updatePingStatEnabled:function(t,e){var r=e.payload;t.pingStatEnabled=r},updateSpeedStatEnabled:function(t,e){var r=e.payload;t.speedStatEnabled=r},updateFrameComputeTimeStatEnabled:function(t,e){var r=e.payload;t.frameComputeTimeEnabled=r},updatePhysicsComputeTimeStatEnabled:function(t,e){var r=e.payload;t.physicsComputeTimeEnabled=r},updateGpuComputeTimeStatEnabled:function(t,e){var r=e.payload;t.gpuComputeTimeEnabled=r},updateStatsGraphEnabled:function(t,e){var r=e.payload;t.statsGraphEnabled=r},updateRendererStatsEnabled:function(t,e){var r=e.payload;t.rendererStatsEnabled=r},updateSpeedLinesEnabled:function(t,e){var r=e.payload;t.speedLinesEnabled=r}},c=(0,r(52438).oM)({name:"ui",initialState:{width:window.innerWidth,height:window.innerHeight,scale:window.innerHeight>window.innerWidth?window.innerHeight/1920:window.innerWidth/1920,isPortrait:window.innerHeight>window.innerWidth,uiScaleSetting:1,fpsStatEnabled:!1,pingStatEnabled:!1,speedStatEnabled:!1,frameComputeTimeEnabled:!1,physicsComputeTimeEnabled:!1,gpuComputeTimeEnabled:!1,statsGraphEnabled:!1,rendererStatsEnabled:!1,speedLinesEnabled:!1},reducers:u}),s=c.actions,l=s.updateAllUISettings,f=s.updateWindowSize,h=s.updateUIScale,p=s.updateFPSStatEnabled,y=s.updatePingStatEnabled,d=s.updateSpeedStatEnabled,v=s.updateFrameComputeTimeStatEnabled,m=s.updatePhysicsComputeTimeStatEnabled,b=s.updateGpuComputeTimeStatEnabled,g=s.updateStatsGraphEnabled,w=s.updateRendererStatsEnabled,S=s.updateSpeedLinesEnabled;const x=c.reducer},28854:(t,e,r)=>{r.d(e,{p:()=>k});var n,o=r(68531),i=r(48418),a=r(32514),u=r(69628);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function s(){s=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new C(n||[]);return o(a,"_invoke",{value:T(t,r,u)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var y="suspendedStart",d="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function S(){}var x={};f(x,a,(function(){return this}));var O=Object.getPrototypeOf,P=O&&O(O(A([])));P&&P!==r&&n.call(P,a)&&(x=P);var E=S.prototype=g.prototype=Object.create(x);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=p(t[o],t,i);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==c(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function T(e,r,n){var o=y;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=_(u,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===y)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var s=p(e,r,n);if("normal"===s.type){if(o=n.done?m:d,s.arg===b)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=m,n.method="throw",n.arg=s.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(c(e)+" is not iterable")}return w.prototype=S,o(E,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=f(S,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,S):(t.__proto__=S,f(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(k.prototype),f(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(h(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),f(E,l,"Generator"),f(E,a,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function l(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,v(n.key),n)}}function h(t,e,r){return e=y(e),function(t,e){if(e&&("object"==c(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,p()?Reflect.construct(e,r||[],y(t).constructor):e.apply(t,r))}function p(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(p=function(){return!!t})()}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}function d(t,e){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},d(t,e)}function v(t){var e=function(t,e){if("object"!=c(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==c(e)?e:e+""}var m,b=(0,a.b)()(n=function(t){function e(){var t,r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,a=new Array(i),u=0;u<i;u++)a[u]=arguments[u];return t=h(this,e,[].concat(a)),r=t,o=void 0,(n=v(n="authStateCallback"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(e,t),r=e,n=[{key:"init",value:function(t){var e=this;if(this.authStateCallback=t,!i.vs.is("crazygames"))throw new Error("CrazyGamesAuthDirector can only be used on CrazyGames");var r=i.vs,n=function(){var t,n=(t=s().mark((function t(){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.getUserToken();case 2:if(!(n=t.sent)){t.next=8;break}return t.next=6,e.linkProvider({type:u.AuthenticationTypes.crazygames,token:n});case 6:t.next=10;break;case 8:return t.next=10,e.coreLogin();case 10:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){l(i,n,o,a,u,"next",t)}function u(t){l(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(){return n.apply(this,arguments)}}();r.listenForAuth(n),n()}}],n&&f(r.prototype,n),o&&f(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(o.dC))||n;function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function w(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,E(n.key),n)}}function S(t,e,r){return e=O(e),function(t,e){if(e&&("object"==g(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,x()?Reflect.construct(e,r||[],O(t).constructor):e.apply(t,r))}function x(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(x=function(){return!!t})()}function O(t){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},O(t)}function P(t,e){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},P(t,e)}function E(t){var e=function(t,e){if("object"!=g(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==g(e)?e:e+""}var j=(0,a.b)()(m=function(t){function e(){var t,r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,a=new Array(i),u=0;u<i;u++)a[u]=arguments[u];return t=S(this,e,[].concat(a)),r=t,o=void 0,(n=E(n="authStateCallback"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&P(t,e)}(e,t),r=e,(n=[{key:"init",value:function(t){if(this.authStateCallback=t,!i.vs.is("discord"))throw new Error("CrazyGamesAuthDirector can only be used on CrazyGames");var e=i.vs.getAccessToken();console.log("DiscordAuthDirector token:",e),this.linkProvider({type:u.AuthenticationTypes.discord,token:"Bearer ".concat(e)}).then((function(){t(!0)}))}}])&&w(r.prototype,n),o&&w(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(o.dC))||m;function k(){return i.Jv.is("crazygames")?b:i.Jv.is("discord")?j:o.DZ}},92012:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a(n.key),n)}}function i(t,e,r){return e&&o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function a(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}r.d(e,{q:()=>u});var u=i((function t(){var e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,n=!0,(r=a(r="enabled"))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n}))},47368:(t,e,r)=>{r.d(e,{V:()=>P,x:()=>O});var n=r(48418),o=r(5071),i=r(94407),a=r(37274),u=r(63463),c=r(47472),s=r(5164),l=r(83492),f=r(47473),h=r(10745);function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function y(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return d(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function v(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,x(n.key),n)}}function m(t,e,r){return e=g(e),function(t,e){if(e&&("object"==p(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,b()?Reflect.construct(e,r||[],g(t).constructor):e.apply(t,r))}function b(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(b=function(){return!!t})()}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}function w(t,e){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},w(t,e)}function S(t,e,r){return(e=x(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x(t){var e=function(t,e){if("object"!=p(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==p(e)?e:e+""}var O=function(t){return t[t.NUETRAL=0]="NUETRAL",t[t.CHILLED=1]="CHILLED",t[t.FROZEN=2]="FROZEN",t[t.HEATED=3]="HEATED",t[t.BURNING=4]="BURNING",t[t.EXPLODED=5]="EXPLODED",t[t.MELTED=6]="MELTED",t[t.SHATTERED=7]="SHATTERED",t}({}),P=function(t){function e(t,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=m(this,e)).eid=t,n.entity=r,S(n,"networked",!0),S(n,"killed",!1),S(n,"pause",!1),S(n,"enabled",!1),S(n,"updateCount",0),S(n,"mixer",void 0),S(n,"animationActions",[]),S(n,"animationQueue",[]),S(n,"positionalAudio",[]),S(n,"worldPosition",new o.P),S(n,"worldQuaternion",new i._),S(n,"worldScale",new o.P),n.enableWasm(),n.entity.setObject(n._object3D),n.mixer=new a.X(n),n.mixer.addEventListener("finished",(function(t){var e,r,o=n.animationQueue.shift();(null==o||o.resolve(),n.animationQueue.length>0)&&(null===(e=n.mixer)||void 0===e||e.stopAllAction(),null===(r=n.animationQueue[0])||void 0===r||r.action.play())})),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&w(t,e)}(e,t),r=e,(s=[{key:"update",value:function(t,e){var r=this;this.mixer.update(t),this.updateEntityMatrix(),this.positionalAudio.forEach((function(t){(0,h.D)(t,r.worldPosition,r.worldQuaternion)}))}},{key:"updateEntityMatrix",value:function(){this.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this.worldScale)}},{key:"fixedUpdate",value:function(){this.entity.updateLerpTransform()}},{key:"getType",value:function(){return this.entity.getType()}},{key:"onEnable",value:function(){this.enabled=!0}},{key:"onDisable",value:function(){this.enabled=!1}},{key:"registerAnimationClips",value:function(t){var e,r=y(t);try{for(r.s();!(e=r.n()).done;){var n=e.value;this.animationActions.push(this.mixer.clipAction(n))}}catch(t){r.e(t)}finally{r.f()}}},{key:"removeAnimations",value:function(){this.mixer.uncacheRoot(this),this.animationActions=[],this.cancelAnimationQueue(),this.clearAnimations()}},{key:"addAudio",value:function(t){var e=this;this.pause||(t.onEnded=function(){e.remove(t),e.positionalAudio=e.positionalAudio.filter((function(e){return e!==t}))},this.add(t),this.positionalAudio.push(t),t.play())}},{key:"removeAudio",value:function(t){t.stop(),this.remove(t),this.positionalAudio=this.positionalAudio.filter((function(e){return e!==t}))}},{key:"runAnimationAction",value:function(t){var e=this;return new Promise((function(r){var n=e.animationActions.find((function(e){return e.getClip().name===t})),o=Math.random();console.time("".concat(o)),n?(n.clampWhenFinished=!0,n.loop=u.jAl,e.animationQueue.push({action:n,resolve:r,id:o}),1===e.animationQueue.length&&(e.mixer.stopAllAction(),n.play())):r()}))}},{key:"cancelAnimationQueue",value:function(){this.mixer.stopAllAction(),this.animationQueue=[]}},{key:"pauseAudio",value:function(t){this.pause=t,this.positionalAudio.forEach((function(e){t?e.pause():e.play()}))}},{key:"muteAudio",value:function(t){this.positionalAudio.forEach((function(e){e.setVolume(t?0:1)}))}},{key:"setVisibility",value:function(t){this.traverse((function(e){e instanceof c.K&&(e.userData.visible=t)}))}},{key:"destroy",value:function(){var t;(0,f.X)(this,(function(t){(0,l.w)(t)})),null===(t=n.Xx.map)||void 0===t||t.shadowHandler.removeDynamicObject(this),n.Ts.scene.remove(this),this.positionalAudio.forEach((function(t){return t.stop()})),this.entity.destroy(),this.killed=!0}},{key:"isKilled",value:function(){return this.killed}}])&&v(r.prototype,s),p&&v(r,p),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,s,p}(s.T)},94644:(t,e,r)=>{r.d(e,{N:()=>C});var n=r(47368),o=r(74996),i=r(47472),a=r(48418),u=r(6871),c=r(5071),s=r(63463),l=r(38993),f=r(13268),h="\n  precision highp float;\n  \n  varying vec2 vUv;\n  varying vec3 vNormal;\n  \n  uniform sampler2D uMap;\n  uniform float uTime;\n  uniform vec3 uColor1;\n  \n  ".concat(l.c,"\n\n  void main() {\n    vec3 noiseInput = vec3(vUv * 0.5, uTime);\n    vec3 distInput = vec3(vUv * 2.0 + FBM(noiseInput), uTime);\n    float noise = FBM(distInput) * 0.5 + 0.5;\n\n\n    vec3 normalColor = (vNormal + 1.0) * 0.5; // Normalize to [0, 1]\n    vec3 color = mix(uColor1, normalColor, noise);\n    color.r = 0.0;\n    float alpha = FBM(vec3(vUv * 1.0, uTime));\n    gl_FragColor = vec4(color, 0.4);\n  }\n");function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,g(n.key),n)}}function d(t,e,r){return e=m(e),function(t,e){if(e&&("object"==p(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,v()?Reflect.construct(e,r||[],m(t).constructor):e.apply(t,r))}function v(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(v=function(){return!!t})()}function m(t){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},m(t)}function b(t,e){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},b(t,e)}function g(t){var e=function(t,e){if("object"!=p(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==p(e)?e:e+""}var w=function(t){function e(t){var r,n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=d(this,e,[t.count])).config=t,n=r,i=void 0,(o=g(o="spawnPosition"))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,r.emitSpeed=3,r.spawnPosition=new c.P(0,0,0),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e)}(e,t),r=e,(n=[{key:"addParticle",value:function(){var t,e,r,n=null!==(t=this.config.velocity)&&void 0!==t?t:new c.P(20*Math.random()-10,20*Math.random()+5,20*Math.random()-10);return{position:this.spawnPosition.clone(),velocity:n,acceleration:new c.P(0,-(null!==(e=this.config.gravity)&&void 0!==e?e:60),0),life:.1*Math.random()+.2,alpha:[.5,0],size:this.config.size,angle:2*Math.random()*Math.PI,color:this.config.colors[Math.floor(Math.random()*this.config.colors.length)],uvTile:null!==(r=this.config.uvTile)&&void 0!==r?r:Math.floor(4*Math.random())+24}}}])&&y(r.prototype,n),o&&y(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(r(1674).uq),S=r(97939);function x(t){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x(t)}function O(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,I(n.key),n)}}function P(t,e,r){return e=T(e),function(t,e){if(e&&("object"==x(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,E()?Reflect.construct(e,r||[],T(t).constructor):e.apply(t,r))}function E(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(E=function(){return!!t})()}function j(t,e,r,n){var o=k(T(1&n?t.prototype:t),e,r);return 2&n?function(t){return o.apply(r,t)}:o}function k(){return k="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=T(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},k.apply(null,arguments)}function T(t){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},T(t)}function _(t,e){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_(t,e)}function L(t,e,r){return(e=I(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I(t){var e=function(t,e){if("object"!=x(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=x(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==x(e)?e:e+""}var C=function(t){function e(t){var r,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),L(n=P(this,e,[t,a.CO.proxyItemBox(t)]),"boxMaterial",void 0),L(n,"isSpawned",void 0),L(n,"debris",void 0),L(n,"carCollided",void 0),L(n,"banner",void 0),L(n,"icosahedron",void 0),n.buildBox(),n.visible=!1,n.addAnimation(new a.Iq.SpinAnimation(new a.Iq.Vector3(.1,1,.1),.3)),n.addAnimation(new a.Iq.FloatAnimation(.2,1)),n.isSpawned=n.entity.isSpawned(),n.carCollided=!1,n.debris=new w({colors:[new o.I(1485813),new o.I(7655420),new o.I(3131092)],size:15,count:8}),n.debris.parent=n,null===(r=a.Xx.map)||void 0===r||r.registerAdditiveParticleHandler(n.debris),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_(t,e)}(e,t),r=e,(n=[{key:"buildBox",value:function(){var t=this;this.boxMaterial=new u.j({uniforms:{uColor:{value:new c.P(1,0,0)},uTime:{value:0},uColor1:{value:new o.I(8578792)}},defines:{USE_INSTANCING:""},vertexShader:"\n  precision highp float;\n\n  varying vec2 vUv;\n  varying vec3 vNormal;\n\n  void main() {\n    vUv = uv;\n    vNormal = normalize(normal);\n    \n    #include <begin_vertex>\n    #include <project_vertex>\n  }\n",fragmentShader:h,transparent:!f.tq,depthWrite:f.tq,side:s.ehD,forceSinglePass:!0}),a.Jb.models.itemBox.then((function(e){e.scene.clone().traverse((function(e){var r,n;e instanceof i.K&&(e.castShadow=!0,e.receiveShadow=!0,"Banner"===e.name&&(t.banner=e.clone(),t.banner.material=new S.db(a.Ts).copy(t.banner.material),t.add(t.banner),null===(r=a.Xx.map)||void 0===r||r.batchedMeshHandler.addMesh("itembox-banner",t.banner),t.banner.addAnimation(new a.Iq.SpinAnimation(new a.Iq.Vector3(.1,1,.1),-1))),"Icosahedron"===e.name&&(t.icosahedron=e.clone(),t.icosahedron.material=t.boxMaterial,t.icosahedron.material.needsUpdate=!0,null===(n=a.Xx.map)||void 0===n||n.instancedMeshHandler.addMesh("itembox-icosahedron",t.icosahedron),t.add(t.icosahedron),t.icosahedron.addAnimation(new a.Iq.SpinAnimation(new a.Iq.Vector3(.1,1,.1),.3))))}))}))}},{key:"update",value:function(t,r){j(e,"update",this,3)([t,r]),this.boxMaterial.uniforms.uTime.value+=.1*t}},{key:"fixedUpdate",value:function(){j(e,"fixedUpdate",this,3)([]),this.isSpawned!==this.entity.isSpawned()&&(this.isSpawned=this.entity.isSpawned(),this.setVisibility(this.enabled&&this.entity.isSpawned()),this.isSpawned?(this.addAnimation(new a.Iq.AppearAnimation(5,new a.Iq.Vector3(1,1,1))),this.carCollided=!1):this.debris.play())}},{key:"onEnable",value:function(){j(e,"onEnable",this,3)([]),this.setVisibility(this.entity.isSpawned()),this.muteAudio(!1)}},{key:"onDisable",value:function(){j(e,"onDisable",this,3)([]),this.setVisibility(!1),this.muteAudio(!0)}},{key:"destroy",value:function(){var t,r;j(e,"destroy",this,3)([]),this.icosahedron&&(null===(t=a.Xx.map)||void 0===t||t.instancedMeshHandler.removeMesh("itembox-icosahedron",this.icosahedron)),this.banner&&(null===(r=a.Xx.map)||void 0===r||r.batchedMeshHandler.removeMesh("itembox-banner",this.banner))}}])&&O(r.prototype,n),l&&O(r,l),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,l}(n.V)},21198:(t,e,r)=>{r.d(e,{l:()=>W});var n=r(48418),o=r(94407),i=r(5071),a=r(12918),u=r(47368),c=r(68604),s=r(57761),l=r(97939),f=r(69628),h=r(69300),p=r(33108),y=r(4003),d=r(86930),v=r(83692);function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,g(n.key),n)}}function g(t){var e=function(t,e){if("object"!=m(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==m(e)?e:e+""}function w(t,e,r){return e=O(e),function(t,e){if(e&&("object"==m(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,S()?Reflect.construct(e,r||[],O(t).constructor):e.apply(t,r))}function S(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(S=function(){return!!t})()}function x(){return x="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=O(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},x.apply(null,arguments)}function O(t){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},O(t)}function P(t,e){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},P(t,e)}var E=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),w(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&P(t,e)}(e,t),r=e,n=[{key:"init",value:function(){var t,r,n,o,i;(t=e,r="init",n=this,i=x(O(1&(o=3)?t.prototype:t),r,n),2&o?function(t){return i.apply(n,t)}:i)([]),this.usernameSprite.position.set(0,2,0),this.usernameSprite.material.depthTest=!1,this.usernameSprite.material.sizeAttenuation=!1,this.usernameSprite.material.needsUpdate=!0,this.nameCanvas.color="#080808",this.usernameSprite.setScale(.15),this.usernameSprite.rasterize()}}],n&&b(r.prototype,n),o&&b(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(r(7479).M),j={type:"menu",services:{audio:p.Z,drift:y.wC,nitro:v.k,fireNitro:d.k,nametag:E}};var k=r(66640);function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function _(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return L(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function I(){I=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new C(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(A([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==T(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(T(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function C(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function A(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){C(i,n,o,a,u,"next",t)}function u(t){C(i,n,o,a,u,"throw",t)}a(void 0)}))}}function M(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,z(n.key),n)}}function R(t,e,r){return e=F(e),function(t,e){if(e&&("object"==T(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,N()?Reflect.construct(e,r||[],F(t).constructor):e.apply(t,r))}function N(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(N=function(){return!!t})()}function D(t,e,r,n){var o=B(F(1&n?t.prototype:t),e,r);return 2&n?function(t){return o.apply(r,t)}:o}function B(){return B="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=F(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},B.apply(null,arguments)}function F(t){return F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},F(t)}function G(t,e){return G=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},G(t,e)}function U(t,e,r){return(e=z(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function z(t){var e=function(t,e){if("object"!=T(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==T(e)?e:e+""}var W=function(t){function e(t,r){var i,a;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),U(a=R(this,e,[t,n.CO.proxyCar(t)]),"type",void 0),U(a,"initialized",!1),U(a,"blueprint",void 0),U(a,"cosmetic",void 0),U(a,"vehicleMesh",void 0),U(a,"vehicle",void 0),U(a,"wheels",void 0),U(a,"spareTires",void 0),U(a,"ticksConnected",void 0),U(a,"boostStarted",void 0),U(a,"previousSteeringValue",void 0),U(a,"batchedMeshHandler",void 0),U(a,"iframeCounter",void 0),U(a,"visibilityToggle",void 0),U(a,"inventory",[]),U(a,"loadSkinWait",void 0),U(a,"tilt",void 0),U(a,"previousElementalState",void 0),U(a,"loadedFromConfig",void 0),U(a,"entityQuaternion",new o._),U(a,"services",{}),a.type=null!==(i=null==r?void 0:r.type)&&void 0!==i?i:"puppet",a.blueprint=r,a.previousElementalState=u.x.NUETRAL,a.ticksConnected=0,a.loadedFromConfig=!1,a.previousSteeringValue=0,a.boostStarted=!1,a.wheels=[],a.spareTires=[],!n.Xx.map)throw new Error("Cant create car before map is loaded");return a.batchedMeshHandler=n.Xx.map.batchedMeshHandler,a.iframeCounter=0,a.visibilityToggle=!0,a.position.set(0,-.26,0),a.updateMatrix(),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&G(t,e)}(e,t),r=e,p=[{key:"loadSkinFromConfig",value:(b=A(I().mark((function t(){var e;return I().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.loadedFromConfig){t.next=2;break}return t.abrupt("return");case 2:if(null==(e=n.uk.getConfigForPlayer(this.eid))||!e.car){t.next=9;break}return t.next=6,this.loadSkinFromInventoryItem(e.car);case 6:this.loadedFromConfig=!0,t.next=11;break;case 9:return t.next=11,this.loadSkin(k.k);case 11:case"end":return t.stop()}}),t,this)}))),function(){return b.apply(this,arguments)})},{key:"registerCarBlueprint",value:function(t){this.blueprint=t;for(var e=0,r=Object.entries(this.services);e<r.length;e++){var n,o=_(r[e],2),i=o[0],a=o[1];if(a){var u=t.services[i];u&&a.constructor===u||(null===(n=a.destroy)||void 0===n||n.call(a),delete this.services[i])}}for(var c=0,s=Object.entries(t.services);c<s.length;c++){var l,f=_(s[c],2),h=f[0],p=f[1];if(p&&!this.services[h]){var y=new p(this);this.services[h]=y,null===(l=y.init)||void 0===l||l.call(y,this.vehicle)}}this.type=t.type}},{key:"destroyServices",value:function(){Object.values(this.services).forEach((function(t){var e;return null==t||null===(e=t.destroy)||void 0===e?void 0:e.call(t)})),this.services={}}},{key:"createVehicle",value:function(t){var e,r=this;this.add(t.mesh),this.registerAnimationClips(t.animations),this.registerCarBlueprint(null!==(e=this.blueprint)&&void 0!==e?e:c.b),this.vehicle.licensePlate&&this.addToBatchedMesh(this.getLicensePlateInstanceId(),this.vehicle.licensePlate),this.addToBatchedMesh(this.getGlassInstanceId(),this.vehicle.glass),this.addToBatchedMesh(this.getModelInstanceId(),this.vehicle.body);var n=this.createWheelMesh(t.tireMesh,!0),o=this.createWheelMesh(t.tireMesh,!1),i=this.createWheelMesh(t.tireMesh,!1),a=this.createWheelMesh(t.tireMesh,!0);t.vehicle.spareTires.forEach((function(e){r.createSpareTire(t.tireMesh,e)})),this.entity.addWheelObjects(n,o,i,a)}},{key:"deleteVehicle",value:function(){var t=this;this.vehicleMesh&&this.remove(this.vehicleMesh),this.removeAnimations(),this.vehicle&&(this.vehicle.licensePlate&&this.removeFromBatchedMesh(this.getLicensePlateInstanceId(),this.vehicle.licensePlate),this.removeFromBatchedMesh(this.getGlassInstanceId(),this.vehicle.glass),this.removeFromBatchedMesh(this.getModelInstanceId(),this.vehicle.body)),this.wheels.forEach((function(e){return t.remove(e)})),this.removeFromBatchedMesh(this.getTireInstanceId(),this.wheels),this.spareTires.forEach((function(e){var r;null===(r=t.vehicleMesh)||void 0===r||r.remove(e),t.removeFromBatchedMesh(t.getTireInstanceId(),e)})),this.wheels=[],this.spareTires=[]}},{key:"createWheelMesh",value:function(t,e){var r=t.clone();return r.name="wheel",r.visible=!1,r.userData.visible=!0,this.add(r),this.wheels.push(r),this.addToBatchedMesh(this.getTireInstanceId(),r),r.addAnimation(new n.Iq.WheelRotationAnimation(this.entity,e)),r._object3D}},{key:"createSpareTire",value:function(t,e){var r,n=t.clone();n.name="spareTire",n.visible=!1,n.userData.visible=!0,null===(r=this.vehicleMesh)||void 0===r||r.add(n),this.addToBatchedMesh(this.getTireInstanceId(),n),n.position.copy(e.position),n.rotateOnAxis(new i.P(0,0,1),3*Math.PI/2),n.updateMatrix(),this.spareTires.push(n)}},{key:"loadSkin",value:(m=A(I().mark((function t(e){return I().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.loadSkinWait){t.next=3;break}return t.next=3,this.loadSkinWait;case 3:return this.loadSkinWait=this.loadSkinHandler(e),t.next=6,this.loadSkinWait;case 6:case"end":return t.stop()}}),t,this)}))),function(t){return m.apply(this,arguments)})},{key:"loadSkinFromInventoryItem",value:(v=A(I().mark((function t(e){return I().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadSkin((0,h.h)(e));case 2:case"end":return t.stop()}}),t,this)}))),function(t){return v.apply(this,arguments)})},{key:"loadSkinHandler",value:(d=A(I().mark((function t(e){var r,o;return I().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((null===(r=this.cosmetic)||void 0===r?void 0:r.instanceId)!==e.instanceId){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,n.kz.car.getCosmeticCar(e);case 4:if(o=t.sent,!this.isKilled()){t.next=7;break}return t.abrupt("return");case 7:this.deleteVehicle(),this.destroyServices(),this.entity.updateConfig(JSON.stringify(o.vehicle.configuration)),this.vehicle=o.vehicle,this.vehicleMesh=o.mesh,this.cosmetic=e,this.createVehicle(o),this.tilt=new n.Iq.TiltAnimation,o.mesh.addAnimation(this.tilt),this.initialized=!0;case 17:case"end":return t.stop()}}),t,this)}))),function(t){return d.apply(this,arguments)})},{key:"isLargeVehicle",value:function(){var t;return(null===(t=this.cosmetic)||void 0===t?void 0:t.modelId)===f.Model.FOOD_TRUCK}},{key:"addToBatchedMesh",value:function(t,e){var r=this;(0,l.X4)(e,(function(e){return r.batchedMeshHandler.addMesh(t,e)}))}},{key:"removeFromBatchedMesh",value:function(t,e){var r=this;(0,l.X4)(e,(function(e){return r.batchedMeshHandler.removeMesh(t,e)}))}},{key:"getModelInstanceId",value:function(){return this.cosmetic?"car-body-".concat(this.cosmetic.modelId,"-").concat(this.cosmetic.wrap.pattern,"-").concat(this.cosmetic.wrap.float):"car-body-0-0-0"}},{key:"getTireInstanceId",value:function(){return this.cosmetic?"car-tire-".concat(this.cosmetic.tire.id,"-").concat(this.cosmetic.tire.pattern,"-").concat(this.cosmetic.tire.float):"car-tire-0-0-0"}},{key:"getGlassInstanceId",value:function(){return this.cosmetic?"car-glass-".concat(this.cosmetic.modelId):"car-glass-0-0-0"}},{key:"getLicensePlateInstanceId",value:function(){return this.cosmetic?"car-license-plate-".concat(this.cosmetic.modelId):"car-license-plate-0-0-0"}},{key:"update",value:function(t,r){D(e,"update",this,3)([t,r]),Object.values(this.services).forEach((function(e){var n;return null==e||null===(n=e.update)||void 0===n?void 0:n.call(e,t,r)})),this.traverse((function(t){t instanceof a.N&&t.updateMatrix()}))}},{key:"fixedUpdate",value:function(){var t;D(e,"fixedUpdate",this,3)([]);var r=this.entity.getTransform().getRotation();this.entityQuaternion.set(r.x(),r.y(),r.z(),r.w()),this.checkPuppetState(),this.ticksConnected<5&&(this.entity.clearSmoothing(),this.ticksConnected++),this.updateInventory(),Object.values(this.services).forEach((function(t){var e;return null==t||null===(e=t.fixedUpdate)||void 0===e?void 0:e.call(t)})),this.updateIframe(),this.updateElementalState(),null===(t=this.tilt)||void 0===t||t.setTiltFactor(this.entity.isGrounded()?this.entity.getSpeed()*this.entity.getSteering():0)}},{key:"updateInventory",value:function(){var t=this.entity.getInventorySize();this.inventory=[];for(var e=0;e<t;e++){var r=this.entity.getInventoryItemType(e);if(0!==r){var n=this.entity.getInventoryItemId(e),o=this.entity.getTimeUntilInventoryItemUsage(e);this.inventory.push({id:n,type:r,timeTillUse:o})}}}},{key:"checkPuppetState",value:function(){this.initialized&&("puppet"!==this.type||this.entity.getIsPuppet()?"controller"===this.type&&this.entity.getIsPuppet()&&this.registerCarBlueprint(c.b):this.registerCarBlueprint(s.k))}},{key:"makeMenuCar",value:function(){this.registerCarBlueprint(j)}},{key:"onEnable",value:function(){D(e,"onEnable",this,3)([]),this.setVisibility(!0),this.muteAudio(!1)}},{key:"onDisable",value:function(){D(e,"onDisable",this,3)([]),this.setVisibility(!1),this.muteAudio(!0)}},{key:"turnOnBrakeLights",value:function(t){}},{key:"collisionStarted",value:function(t,e){Object.values(this.services).forEach((function(r){var n;return null==r||null===(n=r.collisionStarted)||void 0===n?void 0:n.call(r,t,e)}))}},{key:"collisionStopped",value:function(t){Object.values(this.services).forEach((function(e){var r;return null==e||null===(r=e.collisionStopped)||void 0===r?void 0:r.call(e,t)}))}},{key:"updateElementalState",value:function(){var t=this.entity.getElementType();this.previousElementalState!==t&&(t===u.x.EXPLODED&&this.spinOut(),this.previousElementalState=t)}},{key:"spinOut",value:function(){this.addAnimation(new n.Iq.SpinOutAnimation)}},{key:"updateIframe",value:function(){this.entity.getElementType()===u.x.EXPLODED?this.iframeCounter++>10&&(this.toggleIframes(),this.iframeCounter=0):(this.makeCarVisible(),this.iframeCounter=0)}},{key:"toggleIframes",value:function(){this.visibilityToggle?this.makeCarInvisible():this.makeCarVisible()}},{key:"makeCarInvisible",value:function(){this.visibilityToggle&&(this.visibilityToggle=!1,this.setVisibility(!1))}},{key:"makeCarVisible",value:function(){this.visibilityToggle||(this.visibilityToggle=!0,this.setVisibility(!0))}},{key:"destroy",value:function(){D(e,"destroy",this,3)([]),this.deleteVehicle(),this.destroyServices()}}],p&&M(r.prototype,p),y&&M(r,y),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,p,y,d,v,m,b}(u.V)},57761:(t,e,r)=>{r.d(e,{k:()=>Ee,L:()=>je});var n=r(82140),o=r(48418);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,c(n.key),n)}}function u(t,e,r){return(e=c(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}var s=function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,"notPlayingFlag",!0),u(this,"cancelPauseHandler",n.h.subscribe((function(){var t=n.h.getState(),r=t.game.paused,o=-1!==t.game.loading,i=t.game.waitingToStart,a=!t.global.firstInteraction||r||o||i;e.notPlaying(a)})))},(e=[{key:"notPlaying",value:function(t){this.notPlayingFlag!==t&&(this.notPlayingFlag=t,t?o.vs.gameplayStop():o.vs.gameplayStart())}},{key:"destroy",value:function(){this.cancelPauseHandler(),o.vs.gameplayStop()}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),l=r(86930),f=r(83692),h=r(59676),p=r(21198);function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,v(n.key),n)}}function v(t){var e=function(t,e){if("object"!=y(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==y(e)?e:e+""}function m(t,e,r){return e=g(e),function(t,e){if(e&&("object"==y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,b()?Reflect.construct(e,r||[],g(t).constructor):e.apply(t,r))}function b(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(b=function(){return!!t})()}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}function w(t,e){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},w(t,e)}var S=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),m(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&w(t,e)}(e,t),r=e,(n=[{key:"collisionStarted",value:function(t,e){var r=t.getType();if(t instanceof p.l)return this.playCarCollisionSound();r!==h.Pn.CAR&&r!==h.Pn.SLOW_SURFACE&&r!==h.Pn.WORLD_OBJ||e>1200&&this.playCrashSound()}},{key:"playCrashSound",value:function(){var t=this;o.Jb.positionalAudio.carCollision.then((function(e){var r=e();r.setVolume(5),t.car.addAudio(r)}))}},{key:"playCarCollisionSound",value:function(){var t=this;o.Jb.positionalAudio.carCollision.then((function(e){var r=e();r.setVolume(10),t.car.addAudio(r)}))}}])&&d(r.prototype,n),i&&d(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(r(33108).Z),x=r(1674),O=r(5071);function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function E(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,L(n.key),n)}}function j(t,e,r){return e=T(e),function(t,e){if(e&&("object"==P(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,k()?Reflect.construct(e,r||[],T(t).constructor):e.apply(t,r))}function k(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(k=function(){return!!t})()}function T(t){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},T(t)}function _(t,e){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_(t,e)}function L(t){var e=function(t,e){if("object"!=P(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==P(e)?e:e+""}var I=function(t){function e(t){var r,n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=j(this,e,[12])).colors=t,n=r,i=void 0,(o=L(o="spawnPosition"))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,r.emitSpeed=.8,r.spawnPosition=new O.P(0,0,0),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_(t,e)}(e,t),r=e,(n=[{key:"addParticle",value:function(){var t=new O.P(0,.1*Math.random()+.5,0),e=this.spawnPosition.clone();return e.x+=3*Math.random()-1.5,e.y+=1.5*Math.random()+.75,e.z+=3*Math.random()-2,{position:e,velocity:t,life:.1*Math.random()+.5,alpha:[.5,0],size:7,angle:Math.PI,color:this.colors[Math.floor(Math.random()*this.colors.length)],uvTile:3}}}])&&E(r.prototype,n),o&&E(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(x.uq),C=r(74996);function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function M(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,F(n.key),n)}}function R(t,e,r){return e=D(e),function(t,e){if(e&&("object"==A(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,N()?Reflect.construct(e,r||[],D(t).constructor):e.apply(t,r))}function N(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(N=function(){return!!t})()}function D(t){return D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},D(t)}function B(t,e){return B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},B(t,e)}function F(t){var e=function(t,e){if("object"!=A(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=A(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==A(e)?e:e+""}var G=function(t){function e(t){var r,n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=R(this,e,[1])).colors=t,n=r,i=void 0,(o=F(o="spawnPosition"))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,r.emitSpeed=1,r.spawnPosition=new O.P(0,0,0),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&B(t,e)}(e,t),r=e,(n=[{key:"addParticle",value:function(){var t=new O.P(0,.15*Math.random()+.8,0),e=this.spawnPosition.clone();return e.y+=.75,e.z-=.5,{position:e,velocity:t,life:.1*Math.random()+.7,alpha:[.5,0],size:20,angle:Math.PI,color:this.colors[Math.floor(Math.random()*this.colors.length)],uvTile:1}}}])&&M(r.prototype,n),o&&M(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(x.uq);function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}function z(){z=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==U(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(U(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function W(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function V(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,H(n.key),n)}}function H(t){var e=function(t,e){if("object"!=U(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=U(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==U(e)?e:e+""}var q=function(){return t=function t(e){var r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.car=e,r=this,o=void 0,(n=H(n="bounceParticles"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o},e=[{key:"init",value:(n=z().mark((function t(){var e;return z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.bounceParticles=new x.pc([new I([new C.I(5893062),new C.I(11069524),new C.I(2878776)]),new G([new C.I(5761082)])]),this.bounceParticles.parent=this.car,null===(e=o.Xx.map)||void 0===e||e.registerAdditiveParticleHandler(this.bounceParticles);case 3:case"end":return t.stop()}}),t,this)})),i=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){W(i,r,o,a,u,"next",t)}function u(t){W(i,r,o,a,u,"throw",t)}a(void 0)}))},function(){return i.apply(this,arguments)})},{key:"collisionStarted",value:function(t){var e;t.getType()==h.Pn.BOUNCE_SURFACE&&(null===(e=this.bounceParticles)||void 0===e||e.play(),o.n0.playId("bounce",{playbackRate:.5*Math.random()+.75}))}},{key:"destroy",value:function(){var t;null===(t=this.bounceParticles)||void 0===t||t.destroy()}}],e&&V(t.prototype,e),r&&V(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i}(),X=r(4805);function K(t){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(t)}function Y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tt(n.key),n)}}function J(t,e,r){return e=Q(e),function(t,e){if(e&&("object"==K(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Z()?Reflect.construct(e,r||[],Q(t).constructor):e.apply(t,r))}function Z(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Z=function(){return!!t})()}function Q(t){return Q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Q(t)}function $(t,e){return $=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},$(t,e)}function tt(t){var e=function(t,e){if("object"!=K(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=K(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==K(e)?e:e+""}var et=function(t){function e(t){var r,n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=J(this,e,[1])).colors=t,n=r,i=void 0,(o=tt(o="spawnPosition"))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,r.emitSpeed=1,r.spawnPosition=new O.P(0,0,0),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$(t,e)}(e,t),r=e,(n=[{key:"addParticle",value:function(){var t=this.spawnPosition.clone();return t.x+=1*Math.random()-.5,t.y+=1.5,t.z+=1*Math.random()-.5,{position:t,life:.1*Math.random()+.5,alpha:[.5,0],size:7,angle:Math.PI,color:this.colors[Math.floor(Math.random()*this.colors.length)],velocity:new O.P(0,.01*Math.random()+.1,0).multiplyScalar(10),uvTile:[28,31],count:0}}}])&&Y(r.prototype,n),o&&Y(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(x.uq),rt=r(71881),nt=r(84611);function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function it(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,at(n.key),n)}}function at(t){var e=function(t,e){if("object"!=ot(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ot(e)?e:e+""}var ut=function(){return t=function t(e){var r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.car=e,r=this,o=void 0,(n=at(n="coinParticles"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o},(e=[{key:"init",value:function(){var t;this.coinParticles=new x.pc([new et([new C.I(15449123),new C.I(15585131),new C.I(16114995)]),new G([new C.I(15449123)])]),this.coinParticles.parent=this.car,null===(t=o.Xx.map)||void 0===t||t.registerAdditiveParticleHandler(this.coinParticles)}},{key:"collisionStarted",value:function(t){var e;t instanceof nt.s&&t.isSpawned&&(null===(e=this.coinParticles)||void 0===e||e.play(),o.n0.playId("coinPickup"))}},{key:"fixedUpdate",value:function(){var t;this.updateCoinCounter(),this.car.entity.getItemUsedThisFrame()===rt.$.COIN_ITEM&&(null===(t=this.coinParticles)||void 0===t||t.play(),o.n0.playId("coinPickup"))}},{key:"updateCoinCounter",value:function(){X.U.setCoins(this.car.entity.getCoinCount())}},{key:"destroy",value:function(){var t;null===(t=this.coinParticles)||void 0===t||t.destroy()}}])&&it(t.prototype,e),r&&it(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),ct=r(47056),st=r(4003);function lt(t){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lt(t)}function ft(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gt(n.key),n)}}function ht(t,e,r){return e=vt(e),function(t,e){if(e&&("object"==lt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,pt()?Reflect.construct(e,r||[],vt(t).constructor):e.apply(t,r))}function pt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(pt=function(){return!!t})()}function yt(t,e,r,n){var o=dt(vt(1&n?t.prototype:t),e,r);return 2&n?function(t){return o.apply(r,t)}:o}function dt(){return dt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=vt(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},dt.apply(null,arguments)}function vt(t){return vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vt(t)}function mt(t,e){return mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},mt(t,e)}function bt(t,e,r){return(e=gt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gt(t){var e=function(t,e){if("object"!=lt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=lt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==lt(e)?e:e+""}var wt=["charge1","charge2","charge3"],St=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return bt(t=ht(this,e,[].concat(n)),"sparkSoundPromise",void 0),bt(t,"sparkSound",void 0),bt(t,"sparkVolume",0),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mt(t,e)}(e,t),r=e,(i=[{key:"init",value:function(t){yt(e,"init",this,3)([t]),this.createSparkSound()}},{key:"createSparkSound",value:function(){var t=this;this.sparkSoundPromise=new Promise((function(e){o.Jb.positionalAudio.sparks.then((function(r){var n=r();n.loop=!0,t.car.addAudio(n),n.setVolume(.5),n.setRolloffFactor(.1),t.sparkSound=n,e(n)}))}))}},{key:"fixedUpdate",value:function(){yt(e,"fixedUpdate",this,3)([]),this.updateSpeedLines(),this.updateSparkSound()}},{key:"updateSpeedLines",value:function(){this.car.entity.isBoosting()&&!n.h.getState().game.boosting?n.h.dispatch((0,ct.gi)(!0)):!this.car.entity.isBoosting()&&n.h.getState().game.boosting&&n.h.dispatch((0,ct.gi)(!1))}},{key:"updateSparkSound",value:function(){this.sparkSound&&(this.sparkVolume+=.03,this.sparkVolume<.5&&this.sparkSound.setVolume(this.sparkVolume))}},{key:"boostSizeChanged",value:function(t){yt(e,"boostSizeChanged",this,3)([t]),this.sparkSound&&(this.sparkSound.setVolume(0),this.sparkVolume=0,t!==st.pd.NONE&&o.n0.playId(wt[t]))}},{key:"toggleDriftSfx",value:function(t){yt(e,"toggleDriftSfx",this,3)([t]),this.sparkSound&&(t&&!this.sparkSound.isPlaying?this.sparkSound.play():this.sparkSound.isPlaying&&this.sparkSound.stop())}},{key:"destroy",value:function(){var t,r=this;yt(e,"destroy",this,3)([]),null===(t=this.sparkSoundPromise)||void 0===t||t.then((function(t){return r.car.removeAudio(t)}))}}])&&ft(r.prototype,i),a&&ft(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,a}(st.wC),xt=r(94644);function Ot(t){return Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ot(t)}function Pt(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Et(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Et(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function Et(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function jt(){jt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==Ot(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Ot(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function kt(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Tt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Lt(n.key),n)}}function _t(t,e,r){return(e=Lt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lt(t){var e=function(t,e){if("object"!=Ot(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ot(e)?e:e+""}var It=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.car=e,_t(this,"itemBoxParticles",void 0),_t(this,"itemBoxSpinSfx",void 0),_t(this,"lastTimeTillUse",0)},e=[{key:"init",value:(n=jt().mark((function t(){var e;return jt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.itemBoxParticles=new x.pc([new I([new C.I(12905983),new C.I(12900863),new C.I(14664959)]),new G([new C.I(10375167)])]),this.itemBoxParticles.parent=this.car,null===(e=o.Xx.map)||void 0===e||e.registerAdditiveParticleHandler(this.itemBoxParticles),t.next=5,o.Jb.audio.itemBoxSpin;case 5:this.itemBoxSpinSfx=t.sent;case 6:case"end":return t.stop()}}),t,this)})),i=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){kt(i,r,o,a,u,"next",t)}function u(t){kt(i,r,o,a,u,"throw",t)}a(void 0)}))},function(){return i.apply(this,arguments)})},{key:"fixedUpdate",value:function(){if(this.itemBoxSpinSfx){var t,e,r=Pt(this.car.inventory);try{for(r.s();!(e=r.n()).done;){var n=e.value;(!t||n.timeTillUse>t)&&(t=n.timeTillUse)}}catch(t){r.e(t)}finally{r.f()}t&&(this.itemBoxSpinSfx.isPlaying?t>this.lastTimeTillUse&&(this.itemBoxSpinSfx.stop(),this.itemBoxSpinSfx.play()):this.itemBoxSpinSfx.play(),this.lastTimeTillUse=t)}}},{key:"collisionStarted",value:function(t){var e;t instanceof xt.N&&t.isSpawned&&(null===(e=this.itemBoxParticles)||void 0===e||e.play(),o.n0.playId("itemBoxCollision"))}},{key:"destroy",value:function(){var t;null===(t=this.itemBoxParticles)||void 0===t||t.destroy()}}],e&&Tt(t.prototype,e),r&&Tt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i}(),Ct=r(57103),At=r(26068);function Mt(t){return Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mt(t)}function Rt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Nt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Rt(Object(r),!0).forEach((function(e){zt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Rt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Dt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wt(n.key),n)}}function Bt(t,e,r){return e=Gt(e),function(t,e){if(e&&("object"==Mt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ft()?Reflect.construct(e,r||[],Gt(t).constructor):e.apply(t,r))}function Ft(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ft=function(){return!!t})()}function Gt(t){return Gt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Gt(t)}function Ut(t,e){return Ut=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ut(t,e)}function zt(t,e,r){return(e=Wt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wt(t){var e=function(t,e){if("object"!=Mt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Mt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Mt(e)?e:e+""}var Vt={width:64,height:64,iconWidth:64,iconHeight:64,iconOffsetX:0,iconOffsetY:0},Ht=function(t){function e(t,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),zt(n=Bt(this,e),"canvas",void 0),zt(n,"img",void 0),zt(n,"config",void 0),n.config=Nt(Nt({},Vt),r),n.img=t,n.canvas=document.createElement("canvas"),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ut(t,e)}(e,t),r=e,(n=[{key:"rasterize",value:function(){this.canvas.width=this.config.width,this.canvas.height=this.config.height;var t=this.canvas.getContext("2d");t&&t.drawImage(this.img,this.config.iconOffsetX,this.config.iconOffsetY,this.config.iconWidth,this.config.iconHeight)}}])&&Dt(r.prototype,n),o&&Dt(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(Ct.J),qt=r(5164);function Xt(t){return Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xt(t)}function Kt(){Kt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==Xt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Xt(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Yt(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Jt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,oe(n.key),n)}}function Zt(t,e,r){return e=ee(e),function(t,e){if(e&&("object"==Xt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Qt()?Reflect.construct(e,r||[],ee(t).constructor):e.apply(t,r))}function Qt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Qt=function(){return!!t})()}function $t(t,e,r,n){var o=te(ee(1&n?t.prototype:t),e,r);return 2&n?function(t){return o.apply(r,t)}:o}function te(){return te="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=ee(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},te.apply(null,arguments)}function ee(t){return ee=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ee(t)}function re(t,e){return re=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},re(t,e)}function ne(t,e,r){return(e=oe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oe(t){var e=function(t,e){if("object"!=Xt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Xt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Xt(e)?e:e+""}var ie=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return ne(t=Zt(this,e,[].concat(n)),"obj",void 0),ne(t,"hoverSprite",void 0),ne(t,"blinkTimer",0),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&re(t,e)}(e,t),r=e,n=[{key:"init",value:function(t){$t(e,"init",this,3)([t]),this.createExclamationSprite()}},{key:"createExclamationSprite",value:(a=Kt().mark((function t(){var e,r;return Kt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.hoverSprite=new Ct.j({content:[],height:500}),this.obj=new qt.T,this.obj.position.set(0,1.6,0),this.obj.scale.set(1.5,1.5,1.5),this.obj.updateMatrix(),this.car.add(this.obj),this.hoverSprite.matrixWorld.elements=this.obj.matrixWorld.elements,o.Ts.scene.add(this.hoverSprite),this.hoverSprite.visible=!1,t.next=11,o.Jb.textures.exclamation;case 11:e=t.sent,r={id:"exclamation-icon",content:new Ht(e.image,{width:300,height:300,iconWidth:200,iconHeight:200,iconOffsetY:0,iconOffsetX:50})},this.hoverSprite&&(this.hoverSprite.content=[r]);case 14:case"end":return t.stop()}}),t,this)})),u=function(){var t=this,e=arguments;return new Promise((function(r,n){var o=a.apply(t,e);function i(t){Yt(o,r,n,i,u,"next",t)}function u(t){Yt(o,r,n,i,u,"throw",t)}i(void 0)}))},function(){return u.apply(this,arguments)})},{key:"fixedUpdate",value:function(){$t(e,"fixedUpdate",this,3)([]),this.updateTargetedIndicator()}},{key:"updateTargetedIndicator",value:function(){var t=this.car.entity.getTargetDistance(),e=this.targetedIndicatorIsOn();-1===t||t>150?e&&this.turnOffTargetedIndicator():this.blinkTimer++>this.getBlinkRateFromDistance(t)&&(this.blinkTimer=0,e?this.turnOffTargetedIndicator():this.turnOnTargetedIndicator())}},{key:"getBlinkRateFromDistance",value:function(t){return 2+t/5}},{key:"targetedIndicatorIsOn",value:function(){return!!this.hoverSprite&&this.hoverSprite.visible}},{key:"turnOnTargetedIndicator",value:function(){this.hoverSprite&&(this.hoverSprite.visible=!0,o.n0.playId("missileTarget"))}},{key:"turnOffTargetedIndicator",value:function(){this.hoverSprite&&(this.hoverSprite.visible=!1)}},{key:"startMissileBoost",value:function(){$t(e,"startMissileBoost",this,3)([])}},{key:"openLauncher",value:function(t){$t(e,"openLauncher",this,3)([t]),o.n0.playId("missileLauncherOpen")}},{key:"closeLauncher",value:function(){$t(e,"closeLauncher",this,3)([]),o.n0.playId("missileLauncherClose")}},{key:"destroy",value:function(){$t(e,"destroy",this,3)([]),this.hoverSprite&&o.Ts.scene.remove(this.hoverSprite),this.car.remove(this.obj)}}],n&&Jt(r.prototype,n),i&&Jt(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i,a,u}(At.t),ae=r(85285);function ue(t){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ue(t)}function ce(){ce=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==ue(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(ue(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function se(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function le(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fe(n.key),n)}}function fe(t){var e=function(t,e){if("object"!=ue(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ue(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ue(e)?e:e+""}var he=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.car=e},e=[{key:"init",value:(n=ce().mark((function t(){return ce().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o.aG.length=0;case 1:case"end":return t.stop()}}),t)})),i=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){se(i,r,o,a,u,"next",t)}function u(t){se(i,r,o,a,u,"throw",t)}a(void 0)}))},function(){return i.apply(this,arguments)})},{key:"update",value:function(t,e){var r,n;ae.vd&&o.aG.push([t.toString(),e.toString(),o.aD.toString(),null!==(r=null===o.PL||void 0===o.PL?void 0:o.PL.dTicks.toString())&&void 0!==r?r:"0",null!==(n=null===o.PL||void 0===o.PL?void 0:o.PL.frame.toString())&&void 0!==n?n:"0",this.car.worldPosition.x.toString(),this.car.worldPosition.y.toString(),this.car.worldPosition.z.toString()])}}],e&&le(t.prototype,e),r&&le(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i}(),pe=r(79594),ye=r(7142);function de(t){return de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},de(t)}function ve(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,be(n.key),n)}}function me(t,e,r){return(e=be(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function be(t){var e=function(t,e){if("object"!=de(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=de(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==de(e)?e:e+""}var ge=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.car=e,me(this,"speedBuffer",void 0),me(this,"speedometerElement",void 0)},(e=[{key:"init",value:function(){this.speedBuffer=new Float32Array(8),this.speedometerElement=document.getElementById("speedometer")}},{key:"fixedUpdate",value:function(){this.updateSpeedometer(),pe.n.setInventory(this.car.inventory)}},{key:"updateSpeedometer",value:function(){this.speedometerElement&&(this.speedBuffer[o.DM%8]=this.car.entity.getSpeed(),o.DM%8==0&&(this.speedometerElement.textContent="".concat(Math.floor((0,ye.Y)(this.speedBuffer)))))}},{key:"destroy",value:function(){pe.n.setInventory([])}}])&&ve(t.prototype,e),r&&ve(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),we={type:"observable",services:{audio:S,drift:St,nitro:f.k,fireNitro:l.k,missile:ie,coin:ut,itemBox:It,ui:ge,bounce:q,positionDebug:he}};function Se(t){return Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Se(t)}function xe(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Oe(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?xe(Object(r),!0).forEach((function(e){Pe(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xe(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Pe(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=Se(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Se(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Se(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Ee={type:"controller",services:Oe(Oe({},we.services),{},{controller:s})};function je(t){return t.type===Ee.type}},68604:(t,e,r)=>{r.d(e,{b:()=>c});var n=r(33108),o=r(4003),i=r(86930),a=r(26068),u=r(83692),c={type:"puppet",services:{audio:n.Z,drift:o.wC,nitro:u.k,fireNitro:i.k,missile:a.t}}},66640:(t,e,r)=>{r.d(e,{k:()=>o});var n=r(69628),o={instanceId:"default",modelId:n.Model.CAVALLINO_288_GTO,wrap:{id:n.Wrap.VORTEX_BLUE,float:0,pattern:5},tire:{id:n.Tire.CLASSIC,pattern:1,float:0}}},33108:(t,e,r)=>{r.d(e,{Z:()=>c});var n=r(48418);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,u(n.key),n)}}function a(t,e,r){return(e=u(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function u(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var c=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.car=e,a(this,"engineSound",void 0),a(this,"engineSoundPromise",void 0),a(this,"idleTimer",0),a(this,"destroyed",!1)},(e=[{key:"init",value:function(){this.createEngineSound()}},{key:"createEngineSound",value:function(){var t=this;this.engineSoundPromise=new Promise((function(e){n.Jb.positionalAudio.carEngine.then((function(r){if(t.destroyed)return e(void 0);var n=r();n.loop=!0,t.car.addAudio(n),n.setRolloffFactor(.1),n.setVolume(.5),t.engineSound=n,e(n)}))}))}},{key:"fixedUpdate",value:function(){var t=this.car.entity.getSpeed();this.updateEngineSound(t)}},{key:"updateEngineSound",value:function(t){if(this.engineSound&&this.engineSound.isPlaying)if(t<10)this.idleTimer++,this.engineSound.setVolume(Math.max(.5-this.idleTimer/100,0));else{this.idleTimer=0,this.engineSound.setVolume(.5);var e=1e3*(Math.abs(t/200)+Math.random()/6+.4)-1e3;isNaN(e)&&(e=0),this.engineSound.setDetune(Math.min(e,500))}}},{key:"destroy",value:function(){var t,e=this;this.destroyed=!0,null===(t=this.engineSoundPromise)||void 0===t||t.then((function(t){t&&e.car.removeAudio(t)}))}}])&&i(t.prototype,e),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()},4003:(t,e,r)=>{r.d(e,{wC:()=>$,pd:()=>Q,XA:()=>Z});var n=r(5071),o=r(1674),i=r(74996);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,h(n.key),n)}}function c(t,e,r){return e=l(e),function(t,e){if(e&&("object"==a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,s()?Reflect.construct(e,r||[],l(t).constructor):e.apply(t,r))}function s(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(s=function(){return!!t})()}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function f(t,e){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},f(t,e)}function h(t){var e=function(t,e){if("object"!=a(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==a(e)?e:e+""}var p=function(t){function e(t){var r,n,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=c(this,e)).spawnPosition=t,n=r,a=void 0,(o=h(o="color"))in n?Object.defineProperty(n,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[o]=a,r.color=new i.I(16777215),r.emitSpeed=.2,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(e,t),r=e,(n=[{key:"addParticle",value:function(){if(this.spawnPosition)return{position:this.spawnPosition.clone(),angle:2*Math.random()*Math.PI,life:.1*Math.random()+.25,alpha:.3,size:4*Math.random()+4,color:this.color,uvTile:[8,12]}}},{key:"setColor",value:function(t){this.color=t}}])&&u(r.prototype,n),o&&u(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(o.Vo);function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,S(n.key),n)}}function v(t,e,r){return e=b(e),function(t,e){if(e&&("object"==y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,m()?Reflect.construct(e,r||[],b(t).constructor):e.apply(t,r))}function m(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(m=function(){return!!t})()}function b(t){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},b(t)}function g(t,e){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},g(t,e)}function w(t,e,r){return(e=S(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function S(t){var e=function(t,e){if("object"!=y(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==y(e)?e:e+""}var x=function(t){function e(t,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=v(this,e)).spawnPosition=t,n.isLeft=r,w(n,"color",void 0),w(n,"explosion",void 0),n.emitSpeed=2,n.explosion=!1,n.color=new i.I(16777215),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e)}(e,t),r=e,(o=[{key:"addParticle",value:function(){var t=new n.P(10*Math.random()+1.5,25*Math.random()+1.5,5*Math.random()-2.5);return Math.random()<.1||this.explosion?t.multiplyScalar(.6):t.multiplyScalar(.4),this.isLeft&&(t.x*=-1),{position:this.spawnPosition.clone(),velocity:t,acceleration:new n.P(0,-80,0),life:Math.random()/5+.05,alpha:[1,0],size:.4,angle:2*Math.random()*Math.PI,color:this.color,uvTile:0}}},{key:"setColor",value:function(t){this.color=t}},{key:"startExplosion",value:function(){var t=this;setTimeout((function(){t.explosion=!1,t.emitSpeed=2}),200),this.emitSpeed=5,this.explosion=!0}}])&&d(r.prototype,o),a&&d(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,a}(o.Vo);function O(t){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(t)}function P(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,L(n.key),n)}}function E(t,e,r){return e=k(e),function(t,e){if(e&&("object"==O(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,j()?Reflect.construct(e,r||[],k(t).constructor):e.apply(t,r))}function j(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(j=function(){return!!t})()}function k(t){return k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},k(t)}function T(t,e){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},T(t,e)}function _(t,e,r){return(e=L(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function L(t){var e=function(t,e){if("object"!=O(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=O(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==O(e)?e:e+""}var I=[new i.I(11053224),new i.I(13421772),new i.I(14408667),new i.I(16119285)],C=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),_(t=E(this,e),"spawnPosition",void 0),_(t,"duration",void 0),t.duration=.2,t.emitSpeed=8,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&T(t,e)}(e,t),r=e,(o=[{key:"addParticle",value:function(){if(this.spawnPosition)return{position:this.spawnPosition.clone().add(new n.P(3.5*Math.random()-1.75,0,3.5*Math.random()-1.75)),velocity:new n.P(2*-Math.random()-1,.5*Math.random(),4*-Math.random()-1),angle:2*Math.random()*Math.PI,life:.2*Math.random()+.3,alpha:[.05,0],size:[6,0],color:I[Math.floor(Math.random()*I.length)],uvTile:Math.round(4+3*Math.random())}}},{key:"setSpawnPosition",value:function(t){this.spawnPosition=t}}])&&P(r.prototype,o),i&&P(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,i}(o.Vo);function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function M(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,F(n.key),n)}}function R(t,e,r){return e=D(e),function(t,e){if(e&&("object"==A(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,N()?Reflect.construct(e,r||[],D(t).constructor):e.apply(t,r))}function N(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(N=function(){return!!t})()}function D(t){return D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},D(t)}function B(t,e){return B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},B(t,e)}function F(t){var e=function(t,e){if("object"!=A(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=A(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==A(e)?e:e+""}var G=[new i.I(16747520),new i.I(16711680),new i.I(13906659),new i.I(16777215)],U=function(t){function e(t,r){var n,o,i,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=R(this,e,[t,r]),o=n,a=void 0,(i=F(i="sparks"))in o?Object.defineProperty(o,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[i]=a,n.sparks=t[0],n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&B(t,e)}(e,t),r=e,(n=[{key:"boostSizeChanged",value:function(t){this.handlers.forEach((function(e){return e.setColor(G[t])})),this.sparks.startExplosion()}}])&&M(r.prototype,n),o&&M(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(o.pc),z=r(48418);var W=r(97939);function V(t){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V(t)}function H(t){return function(t){if(Array.isArray(t))return q(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return q(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?q(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function X(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Y(n.key),n)}}function K(t,e,r){return(e=Y(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Y(t){var e=function(t,e){if("object"!=V(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=V(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==V(e)?e:e+""}var J=function(t){return t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT",t}(J||{}),Z=function(t){return t[t.NO_DRIFT=0]="NO_DRIFT",t[t.NO_DIRECTION=1]="NO_DIRECTION",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT",t}({}),Q=function(t){return t[t.SMALL=0]="SMALL",t[t.MEDIUM=1]="MEDIUM",t[t.LARGE=2]="LARGE",t[t.NONE=3]="NONE",t}({}),$=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.car=e,K(this,"tireSmoke",void 0),K(this,"tireSparks",[]),K(this,"driftLean",void 0),K(this,"driftHop",void 0),K(this,"tireSkidSoundPromise",void 0),K(this,"tireSkidSound",void 0),K(this,"previousSteeringValue",0),K(this,"previousDriftState",Z.NO_DRIFT),K(this,"leanDirection",void 0),K(this,"boostStarted",!1),K(this,"lastBoostSize",Q.NONE)},(e=[{key:"init",value:function(t){this.initParticles(t),this.createTireSkidSound()}},{key:"initParticles",value:function(t){var e,r=this;this.tireSmoke=new C;var o=t.configuration.backWheels,i=o.wheelHalfTrack+.12,a=o.wheelAxisPosition;this.tireSparks=[new U([new x(new n.P(i,-.45,a),!1),new W.r7(new n.P(i,-.25,a)),new p(new n.P(i,-.25,a))]),new U([new x(new n.P(-i,-.45,a),!0),new W.r7(new n.P(-i,-.25,a)),new p(new n.P(-i,-.25,a))])],this.tireSparks.forEach((function(t){return t.parent=r.car})),null===(e=z.Xx.map)||void 0===e||e.registerAdditiveParticleHandler([].concat(H(this.tireSparks),[this.tireSmoke]))}},{key:"createTireSkidSound",value:function(){var t=this;this.tireSkidSoundPromise=new Promise((function(e){z.Jb.positionalAudio.tireSkid.then((function(r){var n=r();n.loop=!0,t.car.addAudio(n),n.setVolume(0),n.setRolloffFactor(.1),t.tireSkidSound=n,e(n)}))}))}},{key:"update",value:function(){var t;null===(t=this.tireSmoke)||void 0===t||t.setSpawnPosition(this.car.worldPosition)}},{key:"fixedUpdate",value:function(){var t=this.car.entity.isDrifting(),e=t===Z.LEFT||t===Z.RIGHT;if(t!==this.previousDriftState&&e&&this.driftHopStart(t),this.previousDriftState=t,this.driftLean&&this.driftLean.getDir()!==this.leanDirection&&(this.driftLean.stop(),this.driftLean=void 0,this.leanDirection=void 0),e){var r=parseFloat(this.car.entity.getSteering().toFixed(6));this.updateTireSmoke(r),this.updateTireSkidSound(r),this.previousSteeringValue=r}else this.notDrifting();this.updateDriftEffects(),this.updateBoostSfx()}},{key:"updateTireSmoke",value:function(t){this.tireSmoke&&t-this.previousSteeringValue!=0&&(this.tireSmoke.duration=.2,this.tireSmoke.play())}},{key:"updateTireSkidSound",value:function(t){if(this.tireSkidSound){var e=this.tireSkidSound.getVolume();t-this.previousSteeringValue!=0&&e<2?this.tireSkidSound.setVolume(e+.2):e>.25&&this.tireSkidSound.setVolume(e-.05)}}},{key:"driftHopStart",value:function(t){var e,r,n;this.leanDirection=t===Z.LEFT?J.LEFT:J.RIGHT,this.driftLean&&this.driftLean.stop(),this.driftLean=new z.Iq.DriftLeanAnimation(this.leanDirection),this.driftHop=new z.Iq.DriftHopAnimation,e=this.driftHop,r=this.startDrift.bind(this),(n=new z.Iq.CallbackHandler).callbackFn=r,e.setOnDone(n),this.car.addAnimation(this.driftLean),this.car.addAnimation(this.driftHop)}},{key:"updateDriftEffects",value:function(){var t=this.car.entity.getBoostSize();this.lastBoostSize!==t&&(t!==Q.NONE&&(this.boostStarted=!1),this.lastBoostSize=t,this.boostSizeChanged(t))}},{key:"boostSizeChanged",value:function(t){this.tireSparks.forEach((function(e){return e.boostSizeChanged(t)}))}},{key:"updateBoostSfx",value:function(){this.car.entity.isBoosting()&&this.car.entity.isDrifting()===Z.NO_DRIFT&&!this.boostStarted&&(this.boostStarted=!0,this.playBoostSound())}},{key:"startDrift",value:function(){this.toggleDriftSfx(!0),this.tireSparks.forEach((function(t){return t.play()})),this.tireSmoke&&(this.tireSmoke.duration=.8,this.tireSmoke.play())}},{key:"notDrifting",value:function(){var t,e;this.toggleDriftSfx(!1),this.tireSparks.forEach((function(t){return t.pause()})),null===(t=this.tireSmoke)||void 0===t||t.pause(),null===(e=this.driftLean)||void 0===e||e.stop(),this.driftHop=void 0,this.driftLean=void 0}},{key:"toggleDriftSfx",value:function(t){this.tireSkidSound&&(this.tireSkidSound.setVolume(0),t&&!this.tireSkidSound.isPlaying?this.tireSkidSound.play():this.tireSkidSound.isPlaying&&this.tireSkidSound.stop())}},{key:"playBoostSound",value:function(){var t=this;z.Jb.positionalAudio.boost.then((function(e){var r=e();r.setVolume(3),t.car.addAudio(r),r.setDetune(500*Math.random()-250)}))}},{key:"destroy",value:function(){var t,e,r,n=this;null===(t=this.driftLean)||void 0===t||t.stop(),this.tireSparks.forEach((function(t){return t.destroy()})),null===(e=this.tireSmoke)||void 0===e||e.destroy(),null===(r=this.tireSkidSoundPromise)||void 0===r||r.then((function(t){return n.car.removeAudio(t)}))}}])&&X(t.prototype,e),r&&X(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()},86930:(t,e,r)=>{r.d(e,{k:()=>p});var n=r(71881),o=r(1674),i=r(74996),a=r(48418),u=r(97939);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f(n.key),n)}}function l(t,e,r){return(e=f(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f(t){var e=function(t,e){if("object"!=c(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==c(e)?e:e+""}var h=new Map;h.set(n.$.FIRE_NITRO_ITEM,!0);var p=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.car=e,l(this,"nitroEnabled",!1),l(this,"exhaust",[])},(e=[{key:"init",value:function(t){var e,r=this,n=[new i.I(15414549),new i.I(15101717),new i.I(16109329)];this.exhaust=t.exhaustPoints.map((function(t){var e=new o.pc([new u.b6(t,n),new u.r7(t.position,new i.I(15414549))]);return e.parent=r.car,e})),null===(e=a.Xx.map)||void 0===e||e.registerAdditiveParticleHandler(this.exhaust)}},{key:"fixedUpdate",value:function(){h.has(this.car.entity.getItemUsedThisFrame())&&this.nitroUsed(),this.nitroEnabled&&!this.car.entity.isBoosting()&&this.nitroEnded()}},{key:"nitroUsed",value:function(){this.nitroEnabled=!0,this.playBoostSound(),this.exhaust.forEach((function(t){return t.play()}))}},{key:"nitroEnded",value:function(){this.nitroEnabled=!1,this.exhaust.forEach((function(t){return t.pause()}))}},{key:"playBoostSound",value:function(){var t=this;a.Jb.positionalAudio.boost.then((function(e){var r=e();r.setVolume(4),t.car.addAudio(r),r.setDetune(500)}))}},{key:"destroy",value:function(){this.exhaust.forEach((function(t){return t.destroy()}))}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()},26068:(t,e,r)=>{r.d(e,{t:()=>T});var n=r(5071),o=r(94407),i=r(97526),a=r(90972),u=r(71881),c=r(1674),s=r(74996);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function f(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function h(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?f(Object(r),!0).forEach((function(e){b(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,g(n.key),n)}}function y(t,e,r){return e=v(e),function(t,e){if(e&&("object"==l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,d()?Reflect.construct(e,r||[],v(t).constructor):e.apply(t,r))}function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}function v(t){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},v(t)}function m(t,e){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},m(t,e)}function b(t,e,r){return(e=g(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g(t){var e=function(t,e){if("object"!=l(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==l(e)?e:e+""}var w={offset:new n.P(0,0,0),size:20},S=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),b(r=y(this,e,[40]),"spawnPosition",void 0),b(r,"config",void 0),r.emitSpeed=10,r.spawnPosition=new n.P(0,0,0),r.config=h(h({},w),t),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m(t,e)}(e,t),r=e,(o=[{key:"addParticle",value:function(){var t=function(){return 12*Math.random()-6},e=new n.P(t(),t(),t());return{position:this.spawnPosition.clone().add(this.config.offset),velocity:e,acceleration:e.clone().multiplyScalar(-2),life:.1*Math.random()+.5,alpha:[.1,0],size:[this.config.size,0],angle:2*Math.random()*Math.PI,color:new s.I(9211020),uvTile:Math.floor(4*Math.random())+4}}}])&&p(r.prototype,o),i&&p(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,i}(c.uq),x=r(48418);function O(t){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(t)}function P(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,j(n.key),n)}}function E(t,e,r){return(e=j(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function j(t){var e=function(t,e){if("object"!=O(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=O(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==O(e)?e:e+""}var k=new Map;k.set(u.$.MISSILE_ITEM,!0),k.set(u.$.DOUBLE_HOMING_MISSILE_ITEM,!0),k.set(u.$.MEGA_MISSILE_ITEM,!0),k.set(u.$.HOMING_MISSILE_ITEM,!0);var T=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.car=e,E(this,"missileRef",void 0),E(this,"missileMesh",void 0),E(this,"smokeBurst",void 0),E(this,"missileFlySfx",void 0),E(this,"launcherOpen",!1),E(this,"missileBoosting",!1),E(this,"_position",new n.P),E(this,"_quaternion",new o._),E(this,"_scale",new n.P),E(this,"_parentInverse",new i.y),E(this,"_localBoneMatrix",new i.y),E(this,"_inventory",[])},(e=[{key:"init",value:function(t){var e=t.missile;e&&(e.visible=!1,this.missileRef=e,this.initParticles())}},{key:"initParticles",value:function(){var t;this.smokeBurst=new S({offset:new n.P(0,.4,-2),size:12}),this.smokeBurst.parent=this.car,null===(t=x.Xx.map)||void 0===t||t.registerAdditiveParticleHandler(this.smokeBurst)}},{key:"update",value:function(){var t;null===(t=this.missileMesh)||void 0===t||t.update()}},{key:"fixedUpdate",value:function(){var t,e,r,n=k.has(null===(t=this._inventory[0])||void 0===t?void 0:t.type)&&(null===(e=this.car.inventory[0])||void 0===e?void 0:e.id)!==(null===(r=this._inventory[0])||void 0===r?void 0:r.id);this._inventory=this.car.inventory,n&&!this.missileBoosting&&(this.launch(),this.closeLauncherIfOpen());var o=this.car.entity.getItemHeldThisFrame(),i=k.has(o);o===u.$.MEGA_MISSILE_ITEM||(this.missileBoosting&&!this.car.entity.isBoosting()?this.endMissileBoost():i&&!this.missileBoosting&&this.startMissileBoost());var a,c=this.car.inventory[0];c&&(k.has(c.type)&&c.timeTillUse<20&&!this.launcherOpen&&(this.openLauncher(c.type),null===(a=this.missileMesh)||void 0===a||a.meshPromise.then(this.updateMissileInstanceMatrix.bind(this))),this.updateMissileInstanceMatrix())}},{key:"launch",value:function(){var t,e=this;null===(t=this.smokeBurst)||void 0===t||t.play(),x.Jb.positionalAudio.missileLaunch.then((function(t){var r=t();r.setVolume(6),e.car.addAudio(r)}))}},{key:"startMissileBoost",value:function(){var t,e,r=this;this.missileBoosting=!0,null===(t=this.missileMesh)||void 0===t||t.play(),this.car.runAnimationAction("LauncherBoost"),null===(e=this.missileFlySfx)||void 0===e||e.stop(),x.Jb.positionalAudio.missileFly.then((function(t){var e=t();e.setLoop(!0),e.setVolume(4),r.car.addAudio(e),r.missileFlySfx=e}))}},{key:"endMissileBoost",value:function(){var t;this.missileBoosting=!1,null===(t=this.missileFlySfx)||void 0===t||t.stop(),this.closeLauncherIfOpen()}},{key:"openLauncher",value:function(t){var e=this,r=t===u.$.MEGA_MISSILE_ITEM;this.missileMesh=new a.y(r?"megaMissile":"missile",.5),this.missileMesh.meshPromise.then((function(t){var r;e.car.add(t),null===(r=e.missileMesh)||void 0===r||r.setParent(t)})),this.car.runAnimationAction("LauncherOpen"),this.launcherOpen=!0}},{key:"closeLauncherIfOpen",value:function(){this.missileMesh&&this.closeLauncher()}},{key:"closeLauncher",value:function(){var t,e,r=this;null===(t=this.missileMesh)||void 0===t||t.meshPromise.then((function(t){return r.car.remove(t)})),null===(e=this.missileMesh)||void 0===e||e.destroy(),this.missileMesh=void 0,this.car.runAnimationAction("LauncherClose").then((function(){return r.launcherOpen=!1}))}},{key:"updateMissileInstanceMatrix",value:function(){var t,e,r=null===(t=this.missileRef)||void 0===t?void 0:t.skeleton.bones.find((function(t){return"Bonemissile"===t.name}));if(r){var n=null===(e=this.missileMesh)||void 0===e?void 0:e.mesh;n&&n.parent&&(this._parentInverse.copy(n.parent.matrixWorld).invert(),this._localBoneMatrix.copy(r.matrixWorld).premultiply(this._parentInverse),this._localBoneMatrix.decompose(this._position,this._quaternion,this._scale),n.position.copy(this._position),n.quaternion.copy(this._quaternion),n.scale.copy(this._scale))}}},{key:"destroy",value:function(){var t,e;null===(t=this.missileMesh)||void 0===t||t.destroy(),null===(e=this.smokeBurst)||void 0===e||e.destroy()}}])&&P(t.prototype,e),r&&P(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()},7479:(t,e,r)=>{r.d(e,{M:()=>S});var n=r(48418),o=r(57103);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||c(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"==typeof t)return s(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function f(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,y(n.key),n)}}function p(t,e,r){return(e=y(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}var d={text:"",textHeight:.1,color:"black",padding:.1,borderWidth:0,borderRadius:0,borderColor:"",strokeWidth:1,strokeColor:"white",fontFace:"Monsterrat-bold, Arial",fontSize:100,fontWeight:"normal"},v=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),p(this,"_text",void 0),p(this,"_textHeight",void 0),p(this,"_color",void 0),p(this,"_backgroundColor",void 0),p(this,"_padding",void 0),p(this,"_borderWidth",void 0),p(this,"_borderRadius",void 0),p(this,"_borderColor",void 0),p(this,"_strokeWidth",void 0),p(this,"_strokeColor",void 0),p(this,"_fontFace",void 0),p(this,"_fontSize",void 0),p(this,"_fontWeight",void 0),p(this,"_canvas",void 0),p(this,"canvas",void 0);var r=f(f({},d),e);this._text="".concat(r.text),this._textHeight=r.textHeight,this._color=r.color,this._padding=r.padding,this._borderWidth=r.borderWidth,this._borderRadius=r.borderRadius,this._borderColor=r.borderColor,this._strokeWidth=r.strokeWidth,this._strokeColor=r.strokeColor,this._fontFace=r.fontFace,this._fontSize=r.fontSize,this._fontWeight=r.fontWeight,this._canvas=document.createElement("canvas"),this.canvas=this._canvas,this.rasterize()},(e=[{key:"text",get:function(){return this._text},set:function(t){this._text=t,this.rasterize()}},{key:"textHeight",get:function(){return this._textHeight},set:function(t){this._textHeight=t,this.rasterize()}},{key:"color",get:function(){return this._color},set:function(t){this._color=t,this.rasterize()}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this.rasterize()}},{key:"padding",get:function(){return this._padding},set:function(t){this._padding=t,this.rasterize()}},{key:"borderWidth",get:function(){return this._borderWidth},set:function(t){this._borderWidth=t,this.rasterize()}},{key:"borderRadius",get:function(){return this._borderRadius},set:function(t){this._borderRadius=t,this.rasterize()}},{key:"borderColor",get:function(){return this._borderColor},set:function(t){this._borderColor=t,this.rasterize()}},{key:"fontFace",get:function(){return this._fontFace},set:function(t){this._fontFace=t,this.rasterize()}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize=t,this.rasterize()}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(t){this._fontWeight=t,this.rasterize()}},{key:"strokeWidth",get:function(){return this._strokeWidth},set:function(t){this._strokeWidth=t,this.rasterize()}},{key:"strokeColor",get:function(){return this._strokeColor},set:function(t){this._strokeColor=t,this.rasterize()}},{key:"rasterize",value:function(){var t=this,e=this._canvas,r=e.getContext("2d");if(!r)throw new Error("Canvas context is undefined");var n=(Array.isArray(this.borderWidth)?this.borderWidth:[this.borderWidth,this.borderWidth]).map((function(e){return e*t.fontSize*.1})),o=(Array.isArray(this.borderRadius)?this.borderRadius:[this.borderRadius,this.borderRadius,this.borderRadius,this.borderRadius]).map((function(e){return e*t.fontSize*.1})),i=(Array.isArray(this.padding)?this.padding:[this.padding,this.padding]).map((function(e){return e*t.fontSize*.1})),c=this.text.split("\n"),s="".concat(this.fontWeight," ").concat(this.fontSize,"px ").concat(this.fontFace);r.font=s;var l=Math.max.apply(Math,u(c.map((function(t){return r.measureText(t).width})))),f=this.fontSize*c.length;if(e.width=l+2*n[0]+2*i[0]+10,e.height=f+2*n[1]+2*i[1]+10,this.borderWidth){if(r.strokeStyle=this.borderColor,n[0]){var h=n[0]/2;r.lineWidth=n[0],r.beginPath(),r.moveTo(h,o[0]),r.lineTo(h,e.height-o[3]),r.moveTo(e.width-h,o[1]),r.lineTo(e.width-h,e.height-o[2]),r.stroke()}if(n[1]){var p=n[1]/2;r.lineWidth=n[1],r.beginPath(),r.moveTo(Math.max(n[0],o[0]),p),r.lineTo(e.width-Math.max(n[0],o[1]),p),r.moveTo(Math.max(n[0],o[3]),e.height-p),r.lineTo(e.width-Math.max(n[0],o[2]),e.height-p),r.stroke()}if(this.borderRadius){var y=Math.max.apply(Math,u(n)),d=y/2;r.lineWidth=y,r.beginPath(),[!!o[0]&&[o[0],d,d,o[0]],!!o[1]&&[e.width-o[1],e.width-d,d,o[1]],!!o[2]&&[e.width-o[2],e.width-d,e.height-d,e.height-o[2]],!!o[3]&&[o[3],d,e.height-d,e.height-o[3]]].filter((function(t){return t})).forEach((function(t){if(t){var e=a(t,4),n=e[0],o=e[1],i=e[2],u=e[3];r.moveTo(n,i),r.quadraticCurveTo(o,i,o,u)}})),r.stroke()}}this.backgroundColor&&(r.fillStyle=this.backgroundColor,this.borderRadius?(r.beginPath(),r.moveTo(n[0],o[0]),[[n[0],o[0],e.width-o[1],n[1],n[1],n[1]],[e.width-n[0],e.width-n[0],e.width-n[0],n[1],o[1],e.height-o[2]],[e.width-n[0],e.width-o[2],o[3],e.height-n[1],e.height-n[1],e.height-n[1]],[n[0],n[0],n[0],e.height-n[1],e.height-o[3],o[0]]].forEach((function(t){var e=a(t,6),n=e[0],o=e[1],i=e[2],u=e[3],c=e[4],s=e[5];r.quadraticCurveTo(n,u,o,c),r.lineTo(i,s)})),r.closePath(),r.fill()):r.fillRect(n[0],n[1],e.width-2*n[0],e.height-2*n[1])),r.translate(n[0],n[1]),r.translate(i[0],i[1]),r.font=s,r.fillStyle=this.color,r.textBaseline="bottom";var v=this.strokeWidth>0;v&&(r.lineWidth=this.strokeWidth*this.fontSize/10,r.strokeStyle=this.strokeColor),c.forEach((function(e,n){var o=(l-r.measureText(e).width)/2,i=(n+1)*t.fontSize;v&&r.strokeText(e,o,i),r.fillText(e,o,i)}))}}])&&h(t.prototype,e),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,w(n.key),n)}}function g(t,e,r){return(e=w(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function w(t){var e=function(t,e){if("object"!=m(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==m(e)?e:e+""}var S=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.car=e,g(this,"nameCanvas",void 0),g(this,"usernameSprite",void 0),g(this,"cancelResolutionListener",void 0)},e=[{key:"init",value:function(){var t=this;this.nameCanvas=new v,this.usernameSprite=new o.j({content:[{id:"name",content:this.nameCanvas}],height:64}),this.usernameSprite.position.set(0,1.6,0),this.car.add(this.usernameSprite),this.cancelResolutionListener=n.Ts.resolutionUpdateFlow.addListener((function(){t.usernameSprite.rasterize()}));var e=n.uk.getConfigForPlayer(this.car.eid);e&&this.setUsername(e.name,e.authenticated?"black":"gray")}},{key:"setUsername",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"black";this.nameCanvas.text="".concat(t),this.nameCanvas.color=e,this.usernameSprite.rasterize()}},{key:"destroy",value:function(){this.cancelResolutionListener(),this.car.remove(this.usernameSprite)}}],e&&b(t.prototype,e),r&&b(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()},83692:(t,e,r)=>{r.d(e,{k:()=>p});var n=r(71881),o=r(1674),i=r(74996),a=r(48418),u=r(97939);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f(n.key),n)}}function l(t,e,r){return(e=f(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f(t){var e=function(t,e){if("object"!=c(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==c(e)?e:e+""}var h=new Map;h.set(n.$.TRIPLE_NITRO_ITEM,!0),h.set(n.$.DOUBLE_NITRO_ITEM,!0),h.set(n.$.NITRO_ITEM,!0);var p=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.car=e,l(this,"nitroEnabled",!1),l(this,"exhaust",[])},(e=[{key:"init",value:function(t){var e,r=this;this.exhaust=t.exhaustPoints.map((function(t){var e=new o.pc([new u.b6(t),new u.r7(t.position,new i.I(1485813))]);return e.parent=r.car,e})),null===(e=a.Xx.map)||void 0===e||e.registerAdditiveParticleHandler(this.exhaust)}},{key:"fixedUpdate",value:function(){h.has(this.car.entity.getItemUsedThisFrame())&&this.nitroUsed(),this.nitroEnabled&&!this.car.entity.isBoosting()&&this.nitroEnded()}},{key:"nitroUsed",value:function(){this.nitroEnabled=!0,this.playBoostSound(),this.exhaust.forEach((function(t){return t.play()}))}},{key:"nitroEnded",value:function(){this.nitroEnabled=!1,this.exhaust.forEach((function(t){return t.pause()}))}},{key:"playBoostSound",value:function(){var t=this;a.Jb.positionalAudio.boost.then((function(e){var r=e();r.setVolume(4),t.car.addAudio(r),r.setDetune(500)}))}},{key:"destroy",value:function(){this.exhaust.forEach((function(t){return t.destroy()}))}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()},84076:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i(n.key),n)}}function i(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}r.d(e,{F:()=>a});var a=function(){return t=function t(e){var r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.car=e,r=this,o=300,(n=i(n="deactivationTimeout"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o},(e=[{key:"fixedUpdate",value:function(){0===this.deactivationTimeout?(this.car.entity.makeStatic(!0),this.deactivationTimeout--):this.deactivationTimeout>0&&this.deactivationTimeout--}},{key:"resetStaticTimer",value:function(){this.deactivationTimeout=300,this.car.entity.makeStatic(!1)}}])&&o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()},84611:(t,e,r)=>{r.d(e,{s:()=>b});var n=r(47368),o=r(47472),i=r(48418),a=r(59676),u=r(97939);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,m(n.key),n)}}function l(t,e,r){return e=y(e),function(t,e){if(e&&("object"==c(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,f()?Reflect.construct(e,r||[],y(t).constructor):e.apply(t,r))}function f(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(f=function(){return!!t})()}function h(t,e,r,n){var o=p(y(1&n?t.prototype:t),e,r);return 2&n?function(t){return o.apply(r,t)}:o}function p(){return p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=y(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},p.apply(null,arguments)}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}function d(t,e){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},d(t,e)}function v(t,e,r){return(e=m(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m(t){var e=function(t,e){if("object"!=c(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==c(e)?e:e+""}var b=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),v(r=l(this,e,[t,i.CO.proxyCoin(t)]),"coin",void 0),v(r,"isSpawned",void 0),v(r,"carCollided",void 0),v(r,"isStatic",void 0),r.buildCoin(),r.visible=!1,r.isSpawned=r.entity.getIsSpawned(),r.isStatic=r.entity.getIsStatic(),r.carCollided=!1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(e,t),r=e,(n=[{key:"buildCoin",value:function(){var t=this;i.Jb.models.coin.then((function(e){e.scene.clone().traverse((function(e){if(e instanceof o.K){var r;e.castShadow=!0,e.receiveShadow=!0;var n=e.clone();(0,u.hj)(n.material,(function(t){n.material=new u.db(i.Ts).copy(t)})),t.add(n),null===(r=i.Xx.map)||void 0===r||r.batchedMeshHandler.addMesh("coin",n),t.coin=n,t.addAnimations()}}))}))}},{key:"fixedUpdate",value:function(){h(e,"fixedUpdate",this,3)([]),this.checkCoinStaticness(),this.isSpawned!==this.entity.getIsSpawned()&&(this.isSpawned=this.entity.getIsSpawned(),this.setVisibility(this.enabled&&this.entity.getIsSpawned()),this.isSpawned&&(this.addAnimation(new i.Iq.AppearAnimation(5,new i.Iq.Vector3(1,1,1))),this.carCollided=!1))}},{key:"onEnable",value:function(){h(e,"onEnable",this,3)([]),this.setVisibility(this.entity.getIsSpawned()),this.muteAudio(!1)}},{key:"onDisable",value:function(){h(e,"onDisable",this,3)([]),this.setVisibility(!1),this.muteAudio(!0)}},{key:"checkCoinStaticness",value:function(){var t;this.isStatic!==this.entity.getIsStatic()&&(this.isStatic=this.entity.getIsStatic(),null===(t=this.coin)||void 0===t||t.clearAnimations(),this.addAnimations())}},{key:"addAnimations",value:function(){this.isStatic?this.addStaticAnimations():this.addDynamicAnimations()}},{key:"addStaticAnimations",value:function(){this.addAnimation(new i.Iq.SpinAnimation(new i.Iq.Vector3(.1,1,.1),.3)),this.addAnimation(new i.Iq.FloatAnimation(.2,1))}},{key:"addDynamicAnimations",value:function(){this.addAnimation(new i.Iq.SpinAnimation(new i.Iq.Vector3(.1,1,.1),1))}},{key:"collisionStarted",value:function(t,e){var r=this,n=t.getType();n!==a.Pn.SLOW_SURFACE&&n!==a.Pn.WORLD_OBJ||e>100&&i.Jb.positionalAudio.coinCollision.then((function(t){var e=t();e.setVolume(5),r.addAudio(e)}))}},{key:"destroy",value:function(){var t;h(e,"destroy",this,3)([]),this.coin&&(null===(t=i.Xx.map)||void 0===t||t.batchedMeshHandler.removeMesh("coin",this.coin))}}])&&s(r.prototype,n),c&&s(r,c),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,c}(n.V)},70368:(t,e,r)=>{r.d(e,{p:()=>te,H:()=>ee});var n=r(47368),o=r(74996),i=r(47472),a=r(5071),u=r(48418),c=r(1674);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f(n.key),n)}}function f(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:e+""}function h(t,e,r){return e=y(e),function(t,e){if(e&&("object"==s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,p()?Reflect.construct(e,r||[],y(t).constructor):e.apply(t,r))}function p(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(p=function(){return!!t})()}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}function d(t,e){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},d(t,e)}var v=function(t){function e(t,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),h(this,e,[t,r])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(e,t),r=e,(n=[{key:"setSpawnPosition",value:function(t){this.handlers.forEach((function(e){return e.setSpawnPosition(t)}))}}])&&l(r.prototype,n),o&&l(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(c.pc);function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function b(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function g(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?b(Object(r),!0).forEach((function(e){E(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function w(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,j(n.key),n)}}function S(t,e,r){return e=O(e),function(t,e){if(e&&("object"==m(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,x()?Reflect.construct(e,r||[],O(t).constructor):e.apply(t,r))}function x(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(x=function(){return!!t})()}function O(t){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},O(t)}function P(t,e){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},P(t,e)}function E(t,e,r){return(e=j(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function j(t){var e=function(t,e){if("object"!=m(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==m(e)?e:e+""}var k={size:20,maxVelocity:35},T=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),E(r=S(this,e,[40]),"spawnPosition",void 0),E(r,"config",void 0),r.emitSpeed=10,r.spawnPosition=new a.P(0,0,0),r.config=g(g({},k),t),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&P(t,e)}(e,t),r=e,(n=[{key:"addParticle",value:function(){var t=this,e=function(){return Math.random()*t.config.maxVelocity-t.config.maxVelocity/2},r=new a.P(e(),e(),e());return{position:this.spawnPosition.clone(),velocity:r,acceleration:r.clone().multiplyScalar(-1.5),life:.3*Math.random()+.6,alpha:[.6,0],size:[0,Math.random()*this.config.size+this.config.size/2],angle:2*Math.random()*Math.PI,color:new o.I(2171169),uvTile:Math.floor(4*Math.random())+4}}},{key:"smokeOpacity",value:function(t){return Math.max((1-Math.pow(1.9-2.9*t,2))/1.4,0)}},{key:"setSpawnPosition",value:function(t){this.spawnPosition.copy(t)}}])&&w(r.prototype,n),i&&w(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(c.uq);function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function L(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function I(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?L(Object(r),!0).forEach((function(e){D(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function C(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,B(n.key),n)}}function A(t,e,r){return e=R(e),function(t,e){if(e&&("object"==_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,M()?Reflect.construct(e,r||[],R(t).constructor):e.apply(t,r))}function M(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(M=function(){return!!t})()}function R(t){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},R(t)}function N(t,e){return N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},N(t,e)}function D(t,e,r){return(e=B(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function B(t){var e=function(t,e){if("object"!=_(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_(e)?e:e+""}var F={numParticles:80,maxVelocity:30,size:20,color:new o.I(14891309)},G=function(t){function e(t){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=I(I({},F),t);return D(r=A(this,e,[n.numParticles]),"spawnPosition",void 0),D(r,"config",void 0),r.emitSpeed=20,r.spawnPosition=new a.P(0,0,0),r.config=n,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&N(t,e)}(e,t),r=e,(n=[{key:"addParticle",value:function(){var t=this,e=function(){return Math.random()*t.config.maxVelocity-t.config.maxVelocity/2},r=new a.P(e(),e(),e());return{position:this.spawnPosition.clone(),velocity:r,acceleration:r.clone().multiplyScalar(-2),life:.1*Math.random()+.5,alpha:[.4,0],size:[this.config.size,0],angle:2*Math.random()*Math.PI,color:this.config.color.clone(),uvTile:Math.floor(4*Math.random())+24}}},{key:"setSpawnPosition",value:function(t){this.spawnPosition.copy(t)}}])&&C(r.prototype,n),o&&C(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(c.uq);function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}function z(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function W(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?z(Object(r),!0).forEach((function(e){Y(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function V(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,J(n.key),n)}}function H(t,e,r){return e=X(e),function(t,e){if(e&&("object"==U(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,q()?Reflect.construct(e,r||[],X(t).constructor):e.apply(t,r))}function q(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(q=function(){return!!t})()}function X(t){return X=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},X(t)}function K(t,e){return K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},K(t,e)}function Y(t,e,r){return(e=J(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function J(t){var e=function(t,e){if("object"!=U(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=U(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==U(e)?e:e+""}var Z={colors:[new o.I(16757504),new o.I(16775936),new o.I(16741120)],maxVelocity:50},Q=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Y(r=H(this,e,[50]),"spawnPosition",void 0),Y(r,"config",void 0),Y(r,"acceleration",void 0),r.emitSpeed=25,r.spawnPosition=new a.P(0,0,0),r.config=W(W({},Z),t),r.acceleration=new a.P(30,0,0),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&K(t,e)}(e,t),r=e,(n=[{key:"addParticle",value:function(){var t=this,e=function(){return Math.random()*t.config.maxVelocity-t.config.maxVelocity/2},r=new a.P(e(),e(),e()),n=this.config.colors[Math.floor(Math.random()*this.config.colors.length)].clone();return{position:this.spawnPosition.clone(),velocity:r,acceleration:this.acceleration,life:.1*Math.random()+.5,alpha:[1,0],size:4*Math.random()+2,angle:2*Math.random()*Math.PI,color:n,uvTile:1}}},{key:"setSpawnPosition",value:function(t){this.spawnPosition.copy(t)}}])&&V(r.prototype,n),o&&V(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(c.uq),$=r(97939);function tt(t){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tt(t)}function et(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,st(n.key),n)}}function rt(t,e,r){return e=at(e),function(t,e){if(e&&("object"==tt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,nt()?Reflect.construct(e,r||[],at(t).constructor):e.apply(t,r))}function nt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(nt=function(){return!!t})()}function ot(t,e,r,n){var o=it(at(1&n?t.prototype:t),e,r);return 2&n?function(t){return o.apply(r,t)}:o}function it(){return it="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=at(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},it.apply(null,arguments)}function at(t){return at=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},at(t)}function ut(t,e){return ut=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ut(t,e)}function ct(t,e,r){return(e=st(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function st(t){var e=function(t,e){if("object"!=tt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=tt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==tt(e)?e:e+""}var lt=function(t){function e(t){var r,n,c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ct(c=rt(this,e,[t,u.CO.proxyCrate(t)]),"crate",void 0),ct(c,"explosion",void 0),ct(c,"explosionSmoke",void 0),ct(c,"size",void 0),c.explosion=new v([new G({size:20,color:new o.I(14891309)}),new Q({colors:[new o.I(16757504),new o.I(16775936),new o.I(16741120)]})]),c.explosionSmoke=new T({size:25}),null===(r=u.Xx.map)||void 0===r||r.registerAdditiveParticleHandler(c.explosion),null===(n=u.Xx.map)||void 0===n||n.registerNormalParticleHandler(c.explosionSmoke),u.Jb.models.crate.then((function(t){var e=t.scene.clone();e.traverse((function(t){var r;t instanceof i.K&&(t.castShadow=!0,t.receiveShadow=!0,(0,$.hj)(t.material,(function(e){t.material=new $.db(u.Ts).copy(e)})),c.crate=t,e.scale.multiplyScalar(2.3),e.rotateOnAxis(new a.P(0,1,0),Math.PI),c.add(e),null===(r=u.Xx.map)||void 0===r||r.batchedMeshHandler.addMesh("crate",c.crate))}))})),c.visible=!1,c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ut(t,e)}(e,t),r=e,(n=[{key:"fixedUpdate",value:function(){if(ot(e,"fixedUpdate",this,3)([]),this.crate){var t=this.entity.getSize();t!==this.size&&(this.size=t,this.crate.scale.set(t,t,t),this.crate.updateMatrix())}}},{key:"onEnable",value:function(){ot(e,"onEnable",this,3)([]),this.setVisibility(!0),this.muteAudio(!1)}},{key:"onDisable",value:function(){ot(e,"onDisable",this,3)([]),this.setVisibility(!1),this.muteAudio(!0)}},{key:"playExplosion",value:function(){this.enabled&&(this.explosion.setSpawnPosition(this.worldPosition),this.explosionSmoke.setSpawnPosition(this.worldPosition),this.explosion.play(),this.explosionSmoke.play(),this.playExplosionSfx())}},{key:"playExplosionSfx",value:function(){var t=this;u.Jb.positionalAudio.missileExplosion.then((function(e){var r=e();r.setRefDistance(2),r.setRolloffFactor(.95),r.setMaxDistance(100),u.n0.positional.playAtPosition(r,t.worldPosition,t.worldQuaternion)}))}},{key:"destroy",value:function(){var t;this.playExplosion(),this.explosion.destroy(),this.explosionSmoke.destroy(),this.crate&&(null===(t=u.Xx.map)||void 0===t||t.batchedMeshHandler.removeMesh("crate",this.crate))}}])&&et(r.prototype,n),c&&et(r,c),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,c}(n.V),ft=r(90972);function ht(t){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(t)}function pt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,St(n.key),n)}}function yt(t,e,r){return e=bt(e),function(t,e){if(e&&("object"==ht(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,dt()?Reflect.construct(e,r||[],bt(t).constructor):e.apply(t,r))}function dt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(dt=function(){return!!t})()}function vt(t,e,r,n){var o=mt(bt(1&n?t.prototype:t),e,r);return 2&n?function(t){return o.apply(r,t)}:o}function mt(){return mt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=bt(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},mt.apply(null,arguments)}function bt(t){return bt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bt(t)}function gt(t,e){return gt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},gt(t,e)}function wt(t,e,r){return(e=St(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function St(t){var e=function(t,e){if("object"!=ht(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ht(e)?e:e+""}var xt=function(t){function e(t){var r,n,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),wt(i=yt(this,e,[t,u.CO.proxyMissile(t)]),"missile",void 0),wt(i,"missileType","missile"),wt(i,"explosion",void 0),wt(i,"explosionSmoke",void 0),wt(i,"megaExplosion",void 0),wt(i,"megaExplosionSmoke",void 0),i.explosion=new v([new G({size:25,color:new o.I(14891309)}),new Q({colors:[new o.I(16757504),new o.I(16775936),new o.I(16741120)]})]),i.explosionSmoke=new T({size:35}),i.megaExplosion=new v([new G({size:30,maxVelocity:40,numParticles:140,color:new o.I(204031)}),new Q({maxVelocity:60,colors:[new o.I(204031),new o.I(2218751),new o.I(2187519)]})]),i.megaExplosionSmoke=new T({size:40,maxVelocity:40}),null===(r=u.Xx.map)||void 0===r||r.registerAdditiveParticleHandler([i.explosion,i.megaExplosion]),null===(n=u.Xx.map)||void 0===n||n.registerNormalParticleHandler([i.explosionSmoke,i.megaExplosionSmoke]),i.createMissileMesh(),u.Jb.positionalAudio.missileFly.then((function(t){var e=t();e.setLoop(!0),e.setVolume(6),i.addAudio(e)})),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gt(t,e)}(e,t),r=e,(n=[{key:"createMissileMesh",value:function(){var t=this;this.missile=new ft.y(this.missileType),this.missile.play(),this.missile.meshPromise.then((function(e){t.add(e),t.missile.setParent(e)}))}},{key:"update",value:function(t,r){vt(e,"update",this,3)([t,r]),this.missile.update()}},{key:"fixedUpdate",value:function(){vt(e,"fixedUpdate",this,3)([]),"missile"===this.missileType&&this.entity.isMegaMissile()&&(this.missile.destroy(),this.missileType="megaMissile",this.createMissileMesh())}},{key:"onEnable",value:function(){vt(e,"onEnable",this,3)([]),this.setVisibility(!0),this.muteAudio(!1)}},{key:"onDisable",value:function(){vt(e,"onDisable",this,3)([]),this.setVisibility(!1),this.muteAudio(!0)}},{key:"playExplosion",value:function(){this.enabled&&(this.explosion.setSpawnPosition(this.worldPosition),this.explosionSmoke.setSpawnPosition(this.worldPosition),this.megaExplosion.setSpawnPosition(this.worldPosition),this.megaExplosionSmoke.setSpawnPosition(this.worldPosition),"missile"===this.missileType?(this.explosion.play(),this.explosionSmoke.play()):(this.megaExplosion.play(),this.megaExplosionSmoke.play()),this.playExplosionSfx())}},{key:"playExplosionSfx",value:function(){var t=this;u.Jb.positionalAudio.missileExplosion.then((function(e){var r=e();r.setRefDistance(2),r.setRolloffFactor(.95),r.setMaxDistance(100),u.n0.positional.playAtPosition(r,t.worldPosition,t.worldQuaternion)}))}},{key:"destroy",value:function(){this.playExplosion(),this.explosion.destroy(),this.explosionSmoke.destroy(),this.megaExplosion.destroy(),this.megaExplosionSmoke.destroy(),this.missile.destroy(),vt(e,"destroy",this,3)([])}}])&&pt(r.prototype,n),i&&pt(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(n.V),Ot=r(84611),Pt=r(9332);function Et(t){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Et(t)}function jt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ct(n.key),n)}}function kt(t,e,r){return e=_t(e),function(t,e){if(e&&("object"==Et(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Tt()?Reflect.construct(e,r||[],_t(t).constructor):e.apply(t,r))}function Tt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Tt=function(){return!!t})()}function _t(t){return _t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_t(t)}function Lt(t,e){return Lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Lt(t,e)}function It(t,e,r){return(e=Ct(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ct(t){var e=function(t,e){if("object"!=Et(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Et(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Et(e)?e:e+""}var At=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),It(r=kt(this,e,[t,u.CO.proxyAoeSensor(t)]),"update",Pt.Z),It(r,"destroy",Pt.Z),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Lt(t,e)}(e,t),r=e,n&&jt(r.prototype,n),o&&jt(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(n.V),Mt=r(94644),Rt=r(21198),Nt=r(63463),Dt=r(99908),Bt=r(9284),Ft=r(5421),Gt=r(59676);function Ut(t){return Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ut(t)}function zt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Jt(n.key),n)}}function Wt(t,e,r){return e=Xt(e),function(t,e){if(e&&("object"==Ut(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Vt()?Reflect.construct(e,r||[],Xt(t).constructor):e.apply(t,r))}function Vt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Vt=function(){return!!t})()}function Ht(t,e,r,n){var o=qt(Xt(1&n?t.prototype:t),e,r);return 2&n?function(t){return o.apply(r,t)}:o}function qt(){return qt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Xt(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},qt.apply(null,arguments)}function Xt(t){return Xt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Xt(t)}function Kt(t,e){return Kt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Kt(t,e)}function Yt(t,e,r){return(e=Jt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Jt(t){var e=function(t,e){if("object"!=Ut(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ut(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ut(e)?e:e+""}var Zt=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Yt(r=Wt(this,e,[t,u.CO.proxySphere(t)]),"ball",void 0),Yt(r,"size",void 0),u.Jb.models.soccerBall.then((function(t){t.scene.clone().traverse((function(t){var e;t instanceof i.K&&(t.castShadow=!0,t.receiveShadow=!0,(e=t.material,new Promise((function(t){u.Jb.textures.fiveTone.then((function(r){r.minFilter=Nt.TyD,r.magFilter=Nt.TyD;var n=[];(0,Ft.h)(e,(function(t){if(t instanceof Dt.W){var e=(new Bt.I).copy(t);e.gradientMap=r,e.mods=t.mods,n.push(e)}})),t(1===n.length?n[0]:n)}))}))).then((function(e){t.material=e,r.ball=t,r.add(r.ball),u.Ts.scene.add(r)})))}))})),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Kt(t,e)}(e,t),r=e,(n=[{key:"fixedUpdate",value:function(){if(Ht(e,"fixedUpdate",this,3)([]),this.ball){var t=this.entity.getSize();t!==this.size&&(this.size=t,this.ball.scale.set(t,t,t),this.ball.updateMatrix())}}},{key:"onEnable",value:function(){Ht(e,"onEnable",this,3)([]),this.muteAudio(!1),this.visible=!0}},{key:"onDisable",value:function(){Ht(e,"onDisable",this,3)([]),this.muteAudio(!0),this.visible=!1}},{key:"collisionStarted",value:function(t,e){var r=this;t.getType()!=Gt.Pn.SOCCER_SENSOR&&e>100&&u.Jb.positionalAudio.ballCollision.then((function(t){var e=t();e.setVolume(5),e.setPlaybackRate(.5*Math.random()+.75),r.addAudio(e)}))}}])&&zt(r.prototype,n),o&&zt(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(n.V);function Qt(t){return Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qt(t)}function $t(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=Qt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Qt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Qt(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var te=function(t){return t[t.Car=0]="Car",t[t.ItemBox=4]="ItemBox",t[t.Crate=5]="Crate",t[t.Missile=6]="Missile",t[t.Coin=8]="Coin",t[t.AoeEffect=9]="AoeEffect",t[t.Sphere=10]="Sphere",t}({}),ee=$t($t($t($t($t($t($t({},te.Car,Rt.l),te.ItemBox,Mt.N),te.Crate,lt),te.Missile,xt),te.Coin,Ot.s),te.AoeEffect,At),te.Sphere,Zt)},44018:(t,e,r)=>{r.d(e,{Gf:()=>f,JP:()=>s,Sx:()=>h,T5:()=>l});var n=r(48418),o=r(21198),i=r(70368),a=1e6,u=0,c=function(){return a+u++%9e6},s=function(t,e){var r=new i.H[t](e);return n.Ah.addEntity(r),r},l=function(t){return s(t,c())},f=function(t){var e=c(),r=new o.l(e,t);return n.Ah.addEntity(r),r},h=function(t){n.Ah.removeEntity(t)}},90972:(t,e,r)=>{r.d(e,{y:()=>R});var n=r(74996),o=r(47472),i=r(5164),a=r(5071),u=r(48418),c=r(1674);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f(n.key),n)}}function f(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:e+""}function h(t,e,r){return e=y(e),function(t,e){if(e&&("object"==s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,p()?Reflect.construct(e,r||[],y(t).constructor):e.apply(t,r))}function p(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(p=function(){return!!t})()}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}function d(t,e){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},d(t,e)}var v=function(t){function e(t,r){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=h(this,e)).spawnPosition=t,n.colors=r,n.scale=o,n.emitSpeed=2,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(e,t),r=e,(n=[{key:"addParticle",value:function(){return{position:this.spawnPosition.clone(),velocity:new a.P(1*Math.random()-.5,-15*Math.random()-22.5,1*Math.random()-.5),life:.1*Math.random()+.05,alpha:[.5,0],size:5*this.scale,angle:2*Math.random()*Math.PI,color:this.colors[Math.floor(Math.random()*this.colors.length)],uvTile:[16,21]}}}])&&l(r.prototype,n),o&&l(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(c.Vo);function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,P(n.key),n)}}function g(t,e,r){return e=S(e),function(t,e){if(e&&("object"==m(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,w()?Reflect.construct(e,r||[],S(t).constructor):e.apply(t,r))}function w(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(w=function(){return!!t})()}function S(t){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},S(t)}function x(t,e){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},x(t,e)}function O(t,e,r){return(e=P(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function P(t){var e=function(t,e){if("object"!=m(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==m(e)?e:e+""}var E=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=g(this,e)).colors=t,r.scale=n,O(r,"spawnPosition",new a.P(0,-100,0)),O(r,"duration",void 0),r.duration=.2,r.emitSpeed=1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&x(t,e)}(e,t),r=e,(n=[{key:"addParticle",value:function(){return{position:this.spawnPosition.clone(),angle:2*Math.random()*Math.PI,life:.2*Math.random()+.3,alpha:[.4,0],size:6*this.scale,color:this.colors[Math.floor(Math.random()*this.colors.length)],uvTile:Math.round(4+3*Math.random())}}}])&&b(r.prototype,n),o&&b(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(c.Vo),j=r(97939);function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function T(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,L(n.key),n)}}function _(t,e,r){return(e=L(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function L(t){var e=function(t,e){if("object"!=k(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=k(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==k(e)?e:e+""}var I=[new n.I(16068630),new n.I(16553588),new n.I(13906479)],C=[new n.I(1485813),new n.I(7655420),new n.I(3131092)],A=[new n.I(15118769),new n.I(13421772),new n.I(16769248),new n.I(16119285)],M=[new n.I(1485813),new n.I(7655420),new n.I(3131092)],R=function(){return t=function t(e){var r=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e,_(this,"meshPromise",void 0),_(this,"mesh",void 0),_(this,"smokeSpawnPosition",void 0),_(this,"exhaustSmoke",void 0),_(this,"exhaust",void 0),this.meshPromise=new Promise((function(t){u.Jb.models[e].then((function(e){e.scene.clone().traverse((function(e){var n;e instanceof o.K&&(e.castShadow=!0,e.receiveShadow=!0,(0,j.hj)(e.material,(function(t){e.material=new j.db(u.Ts).copy(t)})),r.mesh=e,r.mesh.visible=!1,r.mesh.userData.visible=!0,r.smokeSpawnPosition=new i.T,r.smokeSpawnPosition.position.set(0,-2.5,0),r.mesh.add(r.smokeSpawnPosition),null===(n=u.Xx.map)||void 0===n||n.batchedMeshHandler.addMesh(r.type,r.mesh),t(r.mesh))}))}))}));var l="missile"===e?A:M,f="missile"===e?I:C,h="missile"===e?new n.I(16711680):new n.I(18687);this.exhaustSmoke=new E(l,s),this.exhaust=new c.pc([new v(new a.P(0,-2.5,0),f,s),new j.r7(new a.P(0,-2.3,0),h,28*s)]),this.meshPromise.then((function(){var t;null===(t=u.Xx.map)||void 0===t||t.registerAdditiveParticleHandler([r.exhaust,r.exhaustSmoke])}))},(e=[{key:"update",value:function(){var t;this.smokeSpawnPosition&&(null===(t=this.mesh)||void 0===t||t.updateWorldMatrix(!1,!0),this.exhaustSmoke.spawnPosition.set(this.smokeSpawnPosition.matrixWorld.elements[12],this.smokeSpawnPosition.matrixWorld.elements[13],this.smokeSpawnPosition.matrixWorld.elements[14]))}},{key:"setParent",value:function(t){this.exhaust.parent=t}},{key:"play",value:function(){this.exhaust.play(),this.exhaustSmoke.play()}},{key:"pause",value:function(){this.exhaust.pause(),this.exhaustSmoke.pause()}},{key:"destroy",value:function(){var t=this;this.exhaust.destroy(),this.exhaustSmoke.destroy(),this.meshPromise.then((function(e){var r;null===(r=u.Xx.map)||void 0===r||r.batchedMeshHandler.removeMesh(t.type,e)}))}}])&&T(t.prototype,e),r&&T(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()},82491:(t,e,r)=>{r.d(e,{G:()=>g,M:()=>w});var n=r(47472),o=r(92012),i=r(86795);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return c(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,b(n.key),n)}}function l(t,e,r){return e&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e,r){return e=y(e),function(t,e){if(e&&("object"==a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,p()?Reflect.construct(e,r||[],y(t).constructor):e.apply(t,r))}function p(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(p=function(){return!!t})()}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v(t,e)}function v(t,e){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},v(t,e)}function m(t,e,r){return(e=b(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b(t){var e=function(t,e){if("object"!=a(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==a(e)?e:e+""}var g=function(t){function e(){var t;f(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return m(t=h(this,e,[].concat(n)),"staticEntityId",void 0),t}return d(e,t),l(e)}(o.q),w=function(t){function e(t,r){var n;return f(this,e),m(n=h(this,e,[(0,i.K)(t),r]),"enabled",!0),m(n,"staticEntityId",void 0),n}return d(e,t),l(e,[{key:"addMeshes",value:function(t){this.geometry=(0,i.K)([this].concat(u(t)))}},{key:"update",value:function(t,e){}},{key:"collisionStarted",value:function(t,e){}},{key:"collisionStopped",value:function(t){}},{key:"fixedUpdate",value:function(){}},{key:"destroy",value:function(){}}])}(n.K)},42890:(t,e,r)=>{r.d(e,{I:()=>p});var n=r(6871);var o=r(82491),i=r(59676);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,h(n.key),n)}}function c(t,e,r){return e=l(e),function(t,e){if(e&&("object"==a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,s()?Reflect.construct(e,r||[],l(t).constructor):e.apply(t,r))}function s(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(s=function(){return!!t})()}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function f(t,e){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},f(t,e)}function h(t){var e=function(t,e){if("object"!=a(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==a(e)?e:e+""}var p=function(t){function e(t){var r,o,i,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=c(this,e,[t,new n.j({uniforms:{time:{value:0},smallWaveSpeed:{value:.125},smallWaveAmplitude:{value:.035},smallWaveFrequency:{value:16},smallWaveFoamPercent:{value:.05},smallWaveFoamNoisePercent:{value:.1},smallWaveIterations:{value:1},bigWaveAmplitude:{value:.06},bigWaveFrequencyX:{value:130},bigWaveFrequencyZ:{value:0},bigWaveSpeed:{value:.0035},lowerFoamPercent:{value:-5},upperFoamPercent:{value:-.73},waveDistanceX:{value:0},waveDistanceY:{value:1},modelDim:{value:1},waveMap:{value:null}},vertexShader:"\n\nuniform float time;\nuniform float modelDim;\n\nuniform float smallWaveSpeed;\nuniform float smallWaveAmplitude;\nuniform float smallWaveFrequency;\nuniform int smallWaveIterations;\n\nuniform float bigWaveAmplitude;\nuniform float bigWaveFrequencyX;\nuniform float bigWaveFrequencyZ;\nuniform float bigWaveSpeed;\nuniform float waveDistanceX;\nuniform float waveDistanceY;\n\nuniform sampler2D waveMap;\n\nvarying vec2 vUv;\n\nvec3 mod289(vec3 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x)\n{\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec2 fade(vec2 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\nvec3 fade(vec3 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\nfloat cnoise3(vec3 P)\n{\n  vec3 Pi0 = floor(P); // Integer part for indexing\n  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1\n  Pi0 = mod289(Pi0);\n  Pi1 = mod289(Pi1);\n  vec3 Pf0 = fract(P); // Fractional part for interpolation\n  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n  vec4 iz0 = Pi0.zzzz;\n  vec4 iz1 = Pi1.zzzz;\n\n  vec4 ixy = permute(permute(ix) + iy);\n  vec4 ixy0 = permute(ixy + iz0);\n  vec4 ixy1 = permute(ixy + iz1);\n\n  vec4 gx0 = ixy0 * (1.0 / 7.0);\n  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n  gx0 = fract(gx0);\n  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n  vec4 sz0 = step(gz0, vec4(0.0));\n  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n  vec4 gx1 = ixy1 * (1.0 / 7.0);\n  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n  gx1 = fract(gx1);\n  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n  vec4 sz1 = step(gz1, vec4(0.0));\n  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\n  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n  g000 *= norm0.x;\n  g010 *= norm0.y;\n  g100 *= norm0.z;\n  g110 *= norm0.w;\n  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n  g001 *= norm1.x;\n  g011 *= norm1.y;\n  g101 *= norm1.z;\n  g111 *= norm1.w;\n\n  float n000 = dot(g000, Pf0);\n  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n  float n111 = dot(g111, Pf1);\n\n  vec3 fade_xyz = fade(Pf0);\n  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n  return 2.2 * n_xyz;\n}\n\nfloat rangeConvert(float oldMin, float oldMax, float val, float newMin, float newMax){\n    float oldRange = oldMax - oldMin;\n    float newRange = newMax - newMin;\n    return (((val - oldMin) * newRange) / oldRange) + newMin;\n}\n\nfloat distanceSquared(vec2 a, vec2 b) {\n    vec2 c = a - b;\n    return dot(c, c);\n}\n\nvoid main(){\n    vUv = uv;\n    float waveMapR = texture2D(waveMap, vUv).r + 1.0;\n    float waveMapR2 = texture2D(waveMap, vUv).r * 15.0 + 1.0;\n    float waveMapR3 = texture2D(waveMap, vUv).r;\n    float waveMapG = texture2D(waveMap, vUv).g;\n\n    float maxBigWaveValue = 2.0 * bigWaveAmplitude;\n    float minBigWaveValue = -2.0 * bigWaveAmplitude;\n\n    //SMALL WAVES:\n    float smallWaveValue = 0.0;\n    for(int i = 0; i < smallWaveIterations; i++){\n        float smallWaveValueI = cnoise3(vec3((vUv.xy + float(i)) * 4.0 * smallWaveFrequency, time * smallWaveSpeed / 10.0));\n        smallWaveValueI = 1.0 - abs(smallWaveValueI);\n        //Clip:\n        smallWaveValueI -= 0.2;\n        if(smallWaveValueI < 0.0) smallWaveValueI = 0.0;\n        //Exponentiate:\n        smallWaveValueI = pow(smallWaveValueI, 0.85);\n        //Normalize:\n        smallWaveValueI = rangeConvert(0.0, pow(0.8, 0.85), smallWaveValueI, 0.0, 1.0);\n        if(smallWaveValueI < 0.0) smallWaveValueI = 0.0;\n\n        smallWaveValue += smallWaveValueI;\n    }\n    //smallWaveValue /= float(smallWaveIterations);\n    //smallWaveValue = rangeConvert(0.0, float(smallWaveIterations), smallWaveValue, 0.0, 1.0);\n    \n\n    vec3 pos = vec3(position.x, position.y + smallWaveValue * 250.0 * smallWaveAmplitude * (1.0 - waveMapG), position.z);\n\n    //LARGE WAVES:\n    float dist = distanceSquared(vUv.xy, vec2(waveDistanceX, waveDistanceY)) / ((waveDistanceX + waveDistanceY) * 1.5);\n    float bigWaveValue = sin((dist - time * bigWaveSpeed) * bigWaveFrequencyX) * bigWaveAmplitude +\n        //sin((vUv.y + time * bigWaveSpeed) * bigWaveFrequencyZ) * bigWaveAmplitude +\n        (cnoise3(vec3(vUv.xy / 0.25, (time / 5.0))) * 3.5) * bigWaveAmplitude / (5.29) * (1.0 - waveMapG);\n\n    float xShift = 0.0;\n    float yShift = 0.0;\n    vec2 waveDir = normalize(vec2(waveDistanceX - vUv.x, waveDistanceY - vUv.y));\n    if(bigWaveValue > 0.0) xShift = pow(bigWaveValue, 2.0) * waveDir.x * bigWaveSpeed / 1.0;\n    if(bigWaveValue > 0.0) yShift = pow(bigWaveValue, 2.0) * waveDir.y * bigWaveSpeed / 1.0;\n\n    //Bound edges\n    // xShift *= sqrt(rangeConvert(0.0, modelDim / 2.0, abs(abs(pos.x) - modelDim / 2.0), 0.0, 1.0));\n    // yShift *= sqrt(rangeConvert(0.0, modelDim / 2.0, abs(abs(pos.z) - modelDim / 2.0), 0.0, 1.0));\n\n    // if(pos.x - xShift * 1.0 > modelDim / 2.0) xShift = -1.0 * (modelDim / 2.0 - abs(pos.x));\n    // if(pos.x - xShift * 1.0 < -modelDim / 2.0) xShift = modelDim / 2.0 - abs(pos.x);\n    // if(pos.z + yShift * 1.0 > modelDim / 2.0) yShift = modelDim / 2.0 - abs(pos.z);\n    // if(pos.z + yShift * 1.0 < -modelDim / 2.0) yShift = -1.0 * (modelDim / 2.0 - abs(pos.z));\n    \n    //+ waveMapR3 / 100.0\n    //+ waveMapG / 2.0\n    pos = vec3(pos.x + xShift * 20000.0 * waveMapR2 * (1.0 - waveMapG / 1.15), ((pos.y + bigWaveValue * waveMapR) - 0.0) * (1.0 - waveMapG / 1.1) + 0.019, pos.z + yShift * 20000.0 * waveMapR2 * (1.0 - waveMapG / 1.15));\n    pos = vec3(pos.x + xShift * 5000.0 * waveMapR2 * (1.0 - waveMapG / 1.15), ((pos.y + bigWaveValue * 22.0 * waveMapR) - 3.5) * (1.0 - waveMapG / 1.1) - 3.5, pos.z + yShift * 5000.0 * waveMapR2 * (1.0 - waveMapG / 1.15));\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n    \n}\n\n",fragmentShader:"\n\n//uniform sampler2D image;\nuniform float time;\n\nuniform float smallWaveSpeed;\nuniform float smallWaveAmplitude;\nuniform float smallWaveFrequency;\nuniform float smallWaveFoamPercent;\nuniform float smallWaveFoamNoisePercent;\nuniform int smallWaveIterations;\n\nuniform float bigWaveAmplitude;\nuniform float bigWaveFrequencyX;\nuniform float bigWaveFrequencyZ;\nuniform float bigWaveSpeed;\nuniform float lowerFoamPercent;\nuniform float upperFoamPercent;\nuniform float waveDistanceX;\nuniform float waveDistanceY;\n\nuniform sampler2D waveMap;\n\nvarying vec2 vUv;\n\n//Pardon large noise functions\n//Skip to 150 for main\n\nvec3 mod289(vec3 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x)\n{\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec2 fade(vec2 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\nvec3 fade(vec3 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\nfloat cnoise3(vec3 P)\n{\n  vec3 Pi0 = floor(P); // Integer part for indexing\n  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1\n  Pi0 = mod289(Pi0);\n  Pi1 = mod289(Pi1);\n  vec3 Pf0 = fract(P); // Fractional part for interpolation\n  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n  vec4 iz0 = Pi0.zzzz;\n  vec4 iz1 = Pi1.zzzz;\n\n  vec4 ixy = permute(permute(ix) + iy);\n  vec4 ixy0 = permute(ixy + iz0);\n  vec4 ixy1 = permute(ixy + iz1);\n\n  vec4 gx0 = ixy0 * (1.0 / 7.0);\n  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n  gx0 = fract(gx0);\n  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n  vec4 sz0 = step(gz0, vec4(0.0));\n  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n  vec4 gx1 = ixy1 * (1.0 / 7.0);\n  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n  gx1 = fract(gx1);\n  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n  vec4 sz1 = step(gz1, vec4(0.0));\n  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\n  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n  g000 *= norm0.x;\n  g010 *= norm0.y;\n  g100 *= norm0.z;\n  g110 *= norm0.w;\n  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n  g001 *= norm1.x;\n  g011 *= norm1.y;\n  g101 *= norm1.z;\n  g111 *= norm1.w;\n\n  float n000 = dot(g000, Pf0);\n  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n  float n111 = dot(g111, Pf1);\n\n  vec3 fade_xyz = fade(Pf0);\n  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n  return 2.2 * n_xyz;\n}\n\nfloat rangeConvert(float oldMin, float oldMax, float val, float newMin, float newMax){\n    float oldRange = oldMax - oldMin;\n    float newRange = newMax - newMin;\n    return (((val - oldMin) * newRange) / oldRange) + newMin;\n}\n\nfloat distanceSquared(vec2 a, vec2 b) {\n    vec2 c = a - b;\n    return dot(c, c);\n}\n\nvoid main(){\n    vec2 coord = vUv;\n    float waveMapR = texture2D(waveMap, vUv).r + 1.0;\n    float waveMapR2 = texture2D(waveMap, vUv).r * 15.0 + 1.0;\n    float waveMapR3 = texture2D(waveMap, vUv).r;\n    float waveMapG = texture2D(waveMap, vUv).g;\n    float waveMapB = texture2D(waveMap, vUv).b;\n\n    //SMALL WAVES:\n    float smallWaveValue = 0.0;\n    for(int i = 0; i < smallWaveIterations; i++){\n        float smallWaveValueI = cnoise3(vec3((vUv.xy + float(i)) * 4.0 * smallWaveFrequency, time * smallWaveSpeed / 10.0));\n        smallWaveValueI = 1.0 - abs(smallWaveValueI);\n        //Clip:\n        smallWaveValueI -= 0.25;\n        if(smallWaveValueI < 0.0) smallWaveValueI = 0.0;\n        //Exponentiate:\n        smallWaveValueI = pow(smallWaveValueI, 3.0 / float(smallWaveIterations));\n        //Normalize:\n        smallWaveValueI = rangeConvert(0.0, pow(0.75, 3.0 / float(smallWaveIterations)), smallWaveValueI, 0.0, 1.0);\n        if(smallWaveValueI < 0.0) smallWaveValueI = 0.0;\n        smallWaveValueI = smallWaveValueI / 2.0;\n\n        smallWaveValue = max(smallWaveValue, smallWaveValueI);\n    }\n    //if (smallWaveValue > 1.0) smallWaveValue = 1.0;\n\n    //smallWaveValue = smallWaveValue / float(smallWaveIterations);\n    //smallWaveValue = rangeConvert(0.0, float(smallWaveIterations), smallWaveValue, 0.0, 1.0);\n    \n    //Foam texture:\n    float foamValue = cnoise3(vec3(vUv.xy * 4.0 * 150.0, 1.0));\n    foamValue += 1.0;\n    foamValue /= 2.0;\n    \n    //LARGE WAVES:\n    float dist = distanceSquared(vUv.xy, vec2(waveDistanceX, waveDistanceY)) / ((waveDistanceX + waveDistanceY) * 1.5);\n    float bigWaveValue = sin((dist - time * bigWaveSpeed) * bigWaveFrequencyX) * bigWaveAmplitude +\n        //sin((vUv.y + time * bigWaveSpeed) * bigWaveFrequencyZ) * bigWaveAmplitude\n        + (cnoise3(vec3(vUv.xy / 0.25, (time / 5.0))) * 3.5) * bigWaveAmplitude / (5.29);\n\n    float maxBigWaveValue = 2.0 * bigWaveAmplitude;\n    float minBigWaveValue = -2.0 * bigWaveAmplitude;\n    if(bigWaveFrequencyZ == 0.0 || bigWaveFrequencyX == 0.0){\n      maxBigWaveValue = 1.0 * bigWaveAmplitude;\n      minBigWaveValue = -1.0 * bigWaveAmplitude;\n    }\n    bigWaveValue *= (1.0 - waveMapG);\n    float bigWaveValueNormalized = clamp(rangeConvert(minBigWaveValue, maxBigWaveValue, bigWaveValue, 0.0, 1.0), 0.0, 1.0);\n\n    //float smallWaveSuperPos = (smallWaveValue * (3.0 + float(smallWaveIterations) * 0.75) - bigWaveValue) / (4.0 + float(smallWaveIterations) / 3.0);\n    float smallWaveSuperPos = 0.0;\n    //SuperPos\n    //if(bigWaveValue <= 0.0) smallWaveSuperPos = smallWaveValue - rangeConvert(0.0, 1.0, (1.0 - abs(bigWaveValue)), 0.0, 0.25);\n    //if(bigWaveValue > bigWaveAmplitude * 0.75) smallWaveSuperPos = smallWaveValue - rangeConvert(0.0, 1.0, (1.0 - abs(bigWaveValue)), 0.0, 0.3);\n    //Toon / color:\n    float smallWaveItersFloat = float(smallWaveIterations);\n    //float bigWaveModifier = bigWaveValueNormalized * 1.0;\n    float bigWaveModifier = 0.2 + bigWaveValueNormalized * 1.5;\n    float colorHeight = rangeConvert(0.0, smallWaveAmplitude * (0.2 + 1.5) / smallWaveItersFloat + 0.5 + 0.25, smallWaveValue * bigWaveModifier / smallWaveItersFloat + bigWaveValueNormalized * 0.25, 0.0, 1.0);\n    vec4 color = mix(vec4(0.1, 0.35, 0.5, 1.0), vec4(0.25, 0.57, 0.45, 1.0), clamp(colorHeight, 0.0, 1.0)); //TODO: Normalize\n    vec4 foamColor = vec4(0.5, 0.60, 0.55, 1.0);\n    vec4 foamNoiseColor = vec4(0.5, 0.60, 0.55, 1.0);\n    //if(smallWaveSuperPos > smallWaveFoamPercent / 2.25 ) color = vec4(0.92, 1.0, 0.98, 1.0);\n    //else if((smallWaveSuperPos * 3.0 + foamValue) / 4.0 > smallWaveFoamNoisePercent / 2.1) color = vec4(0.88, 1.0, 0.92, 1.0);\n\n    float bottomDist = pow(rangeConvert(0.0, lowerFoamPercent, bigWaveValueNormalized, 0.0, 1.0), 2.0);\n    float topDist = pow(rangeConvert(0.0, 1.0 - upperFoamPercent, bigWaveValueNormalized - upperFoamPercent, 0.0, 1.0), 2.0);\n\n    //Foam Lines\n    \n    if(bigWaveValueNormalized < lowerFoamPercent) {\n      if(smallWaveValue / smallWaveAmplitude > (1.0 - smallWaveFoamPercent) / (bottomDist * 1.15)){\n        color = mix(foamColor, color, bottomDist);\n      }\n      if((smallWaveValue * 3.0 + foamValue) / 4.0 > (1.0 - smallWaveFoamNoisePercent) / 2.1 / (bottomDist * 1.0)){\n        color = mix(color, foamColor, bottomDist);\n      }\n    }\n\n    if(bigWaveValueNormalized > upperFoamPercent) {\n      if(smallWaveValue / smallWaveAmplitude > (1.0 - smallWaveFoamPercent) * 11.5 && smallWaveValue / smallWaveAmplitude > (5.4 / (topDist + 0.0000001))){\n        color = mix(color, foamColor, clamp(topDist * 1.5, 0.0, 0.75));\n      }\n      if(smallWaveValue + foamValue > (1.0 - smallWaveFoamNoisePercent) && smallWaveValue / smallWaveAmplitude > (1.5 / (topDist + 0.0000001))){\n        color = mix(color, foamColor, topDist * topDist);\n      }\n    }\n\n    //Foam Specks:\n    //if(foamValue > (1.0 - smallWaveFoamNoisePercent) * 1.05){\n      //color = foamColor;\n    //}\n\n    //Foam Noise\n    //if((smallWaveValue * 3.0 + foamValue) / 4.0 > (1.0 - smallWaveFoamNoisePercent) / 2.1){\n    //  if(bigWaveValueNormalized < lowerFoamPercent) color = mix(foamColor, color, pow(rangeConvert(0.0, lowerFoamPercent, bigWaveValueNormalized, 0.0, 1.0), 2.0));\n    //  if(bigWaveValueNormalized > upperFoamPercent) color = mix(color, foamColor, pow(rangeConvert(0.0, 1.0 - upperFoamPercent, bigWaveValueNormalized - upperFoamPercent, 0.0, 1.0), 2.0));\n    //}\n\n    //Extra foam:\n    if(bigWaveValueNormalized * waveMapR3 > 0.5){\n      if(foamValue * bigWaveValueNormalized * waveMapR3 * (1.0 - waveMapG / 1.15) > (1.0 - smallWaveFoamNoisePercent) * 0.5){\n        color = mix(color, foamColor, foamValue * bigWaveValueNormalized * waveMapR3 * 1.85);\n      }\n    }\n    if(waveMapG * foamValue * smallWaveValue > 0.05){\n      color = mix(color, foamColor, waveMapG);\n    }\n    if(waveMapG * foamValue > 0.30){\n      color = mix(color, foamColor, waveMapG);\n    }\n    if(waveMapB * foamValue > 0.30){\n      color = mix(color, foamColor, waveMapB);\n    }\n\n    float opacityCheck = clamp((1.0 - waveMapG) * 1.5 + foamValue / 2.0, 0.0, 1.0);\n    float opacity = 1.0;\n    if(opacityCheck < 0.8) opacity = 0.7;\n    if(opacityCheck < 0.6) opacity = 0.5;\n\n    gl_FragColor = vec4(color.xyz * vec3(1.0, 1.4, 1.4), opacity);\n    //gl_FragColor = texture2D(waveMap, vUv);\n    // = vec4(vUv.x, vUv.y, 0.0, 1.0);\n\n    //gl_FragColor = vec4(vUv.x, vUv.y, 0.0, 1.0);\n}\n\n",transparent:!0})]),o=r,a="ocean",(i=h(i="staticEntityId"))in o?Object.defineProperty(o,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[i]=a,r.renderOrder=0,r.frustumCulled=!1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(e,t),r=e,(o=[{key:"setWaveMap",value:function(t){this.material.uniforms.waveMap.value=t,this.material.needsUpdate=!0}},{key:"update",value:function(t){this.material.uniforms.time.value+=t}},{key:"getType",value:function(){return i.Pn.WORLD_OBJ}}])&&u(r.prototype,o),a&&u(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,a}(o.M)},74653:(t,e,r)=>{r.d(e,{T:()=>h});var n=r(82491),o=r(59676);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f(n.key),n)}}function u(t,e,r){return e=s(e),function(t,e){if(e&&("object"==i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,c()?Reflect.construct(e,r||[],s(t).constructor):e.apply(t,r))}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function s(t){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},s(t)}function l(t,e){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},l(t,e)}function f(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}var h=function(t){function e(t){var r,n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=u(this,e,[t,t[0].material]),n=r,i="podiumobj",(o=f(o="staticEntityId"))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(e,t),r=e,(n=[{key:"getType",value:function(){return o.Pn.WORLD_OBJ}}])&&a(r.prototype,n),i&&a(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(n.M)},48418:(t,e,r)=>{r.d(e,{Iq:()=>Uf,N2:()=>bh,n0:()=>Kf,x8:()=>nh,js:()=>Vf,kz:()=>ch,he:()=>_h,sQ:()=>Ah,DM:()=>kh,J:()=>Th,FL:()=>uh,PL:()=>Bh,uk:()=>Ph,WE:()=>Eh,CO:()=>zf,Tc:()=>ih,f6:()=>dh,qH:()=>Yf,Sx:()=>th,yu:()=>gh,UI:()=>Wf,Xx:()=>eh,g2:()=>Xf,dB:()=>Zf,Yg:()=>Lh,Jv:()=>yh,aG:()=>Ih,Jb:()=>Hf,Ah:()=>Jf,iZ:()=>jh,Xd:()=>qf,xs:()=>rh,tO:()=>vh,Ts:()=>Qf,aD:()=>Gh,UO:()=>Oh,gp:()=>ah,ui:()=>oh,ZW:()=>mh,vs:()=>$f});r(70192);var n=r(99530),o=r(30489),i=r(19038),a=r(63463),u=r(29817),c=r(26603),s=r(50438),l=r(70042);var f=r(97939);function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function p(){p=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new C(n||[]);return o(a,"_invoke",{value:T(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var y="suspendedStart",d="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function S(){}var x={};s(x,a,(function(){return this}));var O=Object.getPrototypeOf,P=O&&O(O(A([])));P&&P!==r&&n.call(P,a)&&(x=P);var E=S.prototype=g.prototype=Object.create(x);function j(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==h(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function T(e,r,n){var o=y;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=_(u,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===y)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?m:d,s.arg===b)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=m,n.method="throw",n.arg=s.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(h(e)+" is not iterable")}return w.prototype=S,o(E,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=s(S,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,S):(t.__proto__=S,s(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(k.prototype),s(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),s(E,c,"Generator"),s(E,a,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function y(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function d(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){y(i,n,o,a,u,"next",t)}function u(t){y(i,n,o,a,u,"throw",t)}a(void 0)}))}}function v(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,b(n.key),n)}}function m(t,e,r){return(e=b(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b(t){var e=function(t,e){if("object"!=h(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==h(e)?e:e+""}var g=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),m(this,"loaders",void 0),m(this,"toLoad",void 0),m(this,"loaded",void 0),m(this,"models",void 0),m(this,"textures",void 0),m(this,"collision",void 0),m(this,"audio",void 0),m(this,"positionalAudio",void 0),m(this,"gltfLoader",void 0),m(this,"loadingRequired",!0),this.loaders=[],this.toLoad=0,this.loaded=0,this.models={},this.textures={},this.collision={},this.audio={},this.positionalAudio={},this.gltfLoader=new f.R6,this.setLoaders()},e=[{key:"setLoaders",value:function(){var t,e=this,r=new i.d;this.loaders.push({extensions:["texture"],action:(t=d(p().mark((function t(n){var o;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("texture"===n.type){t.next=2;break}return t.abrupt("return");case 2:return o=new Promise((function(t,o){r.load(n.src,(function(r){e.fileLoaded(),r.colorSpace=a.GUF,t(r)}),void 0,(function(t){o(t)}))})),e.textures[n.name]=o,t.abrupt("return",o);case 5:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})});var n,o,f,h=new u.c;this.loaders.push({extensions:["cube-map"],action:(n=d(p().mark((function t(r){var n;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("cube-map"===r.type){t.next=2;break}return t.abrupt("return");case 2:return n=new Promise((function(t,n){h.load(r.src,(function(r){e.fileLoaded(),r.colorSpace=a.GUF,t(r)}),void 0,(function(t){n(t)}))})),e.textures[r.name]=n,t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)}))),function(t){return n.apply(this,arguments)})}),this.loaders.push({extensions:["model"],action:(o=d(p().mark((function t(r){var n;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("model"===r.type){t.next=2;break}return t.abrupt("return");case 2:return n=e.gltfLoader.load(r.src),e.models[r.name]=n,t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)}))),function(t){return o.apply(this,arguments)})}),this.loaders.push({extensions:["collision"],action:(f=d(p().mark((function t(r){var n,o;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("collision"===r.type){t.next=2;break}return t.abrupt("return");case 2:return(n=new XMLHttpRequest).open("GET",r.src,!0),n.send(null),n.responseType="arraybuffer",o=new Promise((function(t,r){n.onload=function(){var r=n.response;r&&(e.fileLoaded(),t(new Float32Array(r)))},n.onerror=function(t){r(t)},n.ontimeout=function(t){r(t)}})),e.collision[r.name]=o,t.abrupt("return",o);case 9:case"end":return t.stop()}}),t)}))),function(t){return f.apply(this,arguments)})});var y,v,m=new c.m;this.loaders.push({extensions:["audio"],action:(y=d(p().mark((function t(r){var n;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("audio"===r.type){t.next=2;break}return t.abrupt("return");case 2:return n=new Promise((function(t,n){m.load(r.src,(function(r){e.fileLoaded();var n=new s.B(Qf.audioListener);n.setBuffer(r),t(n)}),void 0,(function(t){n(t)}))})),e.audio[r.name]=n,t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)}))),function(t){return y.apply(this,arguments)})}),this.loaders.push({extensions:["positionalAudio"],action:(v=d(p().mark((function t(r){var n;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("positionalAudio"===r.type){t.next=2;break}return t.abrupt("return");case 2:return n=new Promise((function(t,n){m.load(r.src,(function(r){var n;e.fileLoaded(),t((n=r,function(){var t=new l.V(Qf.audioListener);return t.setBuffer(n),t}))}),void 0,(function(t){n(t)}))})),e.positionalAudio[r.name]=n,t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)}))),function(t){return v.apply(this,arguments)})})}},{key:"load",value:(n=d(p().mark((function t(e){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadingRequired=!0,this.loaded=0,this.toLoad=e.required.length,t.t0=this,t.next=6,this.loadResources(e.required);case 6:t.t1=t.sent,t.t0.handleResults.call(t.t0,t.t1),this.loadingRequired=!1,this.loadResources(e.optional).then(this.handleResults);case 10:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"loadResources",value:function(t){var e=this;return Promise.allSettled(t.map((function(t){var r=e.loaders.find((function(e){return e.extensions.find((function(e){return e===t.type}))}));return r?r.action(t):(console.warn("No loader found for ".concat(JSON.stringify(t))),Promise.resolve())})))}},{key:"handleResults",value:function(t){t.forEach((function(t){"rejected"===t.status&&console.error(t.reason)}))}},{key:"fileLoaded",value:function(){this.loaded+=1,this.loadingRequired&&gh.completeWork(1)}}],e&&v(t.prototype,e),r&&v(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}(),w=r(82140),S=r(17902),x=r(4626),O=r(13268),P=r(27255),E=r(56051),j=r(84290),k=[j.L.LOW,j.L.LOW,j.L.MEDIUM,j.L.HIGH],T=[j.L.LOW,j.L.LOW,j.L.MEDIUM,j.L.MEDIUM];function _(t){var e=this,r={glContext:t,failIfMajorPerformanceCaveat:!1};(0,x.M)(r).then((function(t){var r;C(t),void 0===e.hardware?O.tq?(0,E.o)(T[t.tier]):(0,E.o)(k[t.tier]):(null===(r=e.hardware)||void 0===r||null===(r=r.gpu)||void 0===r?void 0:r.tier)!==t.tier&&(t.tier<2?((0,E.o)(j.L.LOW),I(t)):L(t)),e.hardware={mobile:O.tq,recommended:O.tq?T[t.tier]:k[t.tier],gpu:t}}))}var L=function(t){w.h.dispatch((0,P.Cr)({content:"hardware-change",props:{recommended:k[t.tier]},modalColors:{backgroundColor:"#00000080",color:"#e4fbe9",stroke:"#5db179"}}))},I=function(t){w.h.dispatch((0,P.Cr)({content:"hardware-invalid",props:{gpu:t.gpu}}))},C=function(t){var e;null!==(e=t.gpu)&&void 0!==e&&e.includes("apple gpu")&&(t.tier=2)},A=r(71274);function M(t){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(t)}function R(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,N(n.key),n)}}function N(t){var e=function(t,e){if("object"!=M(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=M(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==M(e)?e:e+""}var D=function(){return t=function t(){var e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,r="detectHardware",n=_.bind(this),(r=N(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,w.h.dispatch((0,S.Vk)(this.ui)),w.h.dispatch((0,A.k$)(this.audio)),w.h.dispatch((0,S.Qu)(this.video.speedLinesEnabled))},(e=[{key:"settings",get:function(){return new Proxy(mh.data.settings,{set:function(t,e,r,n){var o=Reflect.set(t,e,r,n);return mh.data.settings=t,mh.save(),o}})}},{key:"hardware",get:function(){var t=this;return this.settings.hardware?new Proxy(this.settings.hardware,{set:function(e,r,n,o){var i=Reflect.set(e,r,n,o);return t.settings.hardware=e,i}}):this.settings.hardware},set:function(t){this.settings.hardware=t}},{key:"audio",get:function(){var t=this;return new Proxy(this.settings.audio,{set:function(e,r,n,o){var i=Reflect.set(e,r,n,o);return t.settings.audio=e,i}})}},{key:"controls",get:function(){var t=this;return new Proxy(this.settings.controls,{set:function(e,r,n,o){var i=Reflect.set(e,r,n,o);return t.settings.controls=e,i}})}},{key:"video",get:function(){var t=this;return new Proxy(this.settings.video,{set:function(e,r,n,o){var i=Reflect.set(e,r,n,o);return t.settings.video=e,i}})}},{key:"ui",get:function(){var t=this;return new Proxy(this.settings.ui,{set:function(e,r,n,o){var i=Reflect.set(e,r,n,o);return t.settings.ui=e,i}})}},{key:"network",get:function(){var t=this;return new Proxy(this.settings.network,{set:function(e,r,n,o){var i=Reflect.set(e,r,n,o);return t.settings.network=e,i}})}},{key:"gameplay",get:function(){var t=this;return new Proxy(this.settings.gameplay,{set:function(e,r,n,o){var i=Reflect.set(e,r,n,o);return t.settings.gameplay=e,i}})}}])&&R(t.prototype,e),r&&R(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),B=r(71355),F=r(9332),G=r(47473),U=r(83492),z=r(11590);function W(t){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W(t)}function V(){V=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==W(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(W(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function H(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function q(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){H(i,n,o,a,u,"next",t)}function u(t){H(i,n,o,a,u,"throw",t)}a(void 0)}))}}function X(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,K(n.key),n)}}function K(t){var e=function(t,e){if("object"!=W(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=W(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==W(e)?e:e+""}var Y=function(){return t=function t(){var e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,n=void 0,(r=K(r="map"))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,(0,F.Z)()},e=[{key:"setMap",value:(o=q(V().mark((function t(e,r){var n;return V().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.map||this.map.name!=e.name){t.next=2;break}return t.abrupt("return");case 2:return null!==(n=this.map)&&void 0!==n&&n.dispose&&this.map.dispose(),(0,G.X)(Qf.scene,(function(t){(0,U.w)(t)})),Qf.scene.clear(),Qf.renderer.renderLists.dispose(),Qf.scene.add(Qf.camera),(0,z.Gx)(),this.map=void 0,t.next=11,e.init(r);case 11:this.map=e,this.map.ready(),Qf.render(0);case 14:case"end":return t.stop()}}),t,this)}))),function(t,e){return o.apply(this,arguments)})},{key:"clearMap",value:(n=q(V().mark((function t(){var e;return V().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null!==(e=this.map)&&void 0!==e&&e.dispose&&this.map.dispose(),(0,G.X)(Qf.scene,(function(t){(0,U.w)(t)})),Qf.scene.clear(),Qf.renderer.renderLists.dispose(),Qf.scene.add(Qf.camera);case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"update",value:function(t,e){var r;null===(r=this.map)||void 0===r||r.update(t,e),null===z.xo||void 0===z.xo||z.xo.update()}},{key:"fixedUpdate",value:function(t){var e;null===(e=this.map)||void 0===e||e.fixedUpdate(t),null===z.xo||void 0===z.xo||z.xo.destroy()}}],e&&X(t.prototype,e),r&&X(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}(),J=r(69628),Z=r(54516),Q=r(97774),$=r(85285);function tt(t){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tt(t)}function et(){et=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==tt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(tt(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function rt(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function nt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ot(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return it(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?it(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function it(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function at(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ct(n.key),n)}}function ut(t,e,r){return(e=ct(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ct(t){var e=function(t,e){if("object"!=tt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=tt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==tt(e)?e:e+""}var st=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ut(this,"serverToClientIds",{}),ut(this,"clientToServerIds",{}),ut(this,"playerData",{}),ut(this,"map",J.MapIds.DELTA_DISTRICT)},e=[{key:"setIds",value:function(t){var e,r=ot(t);try{for(r.s();!(e=r.n()).done;){var n=e.value;this.serverToClientIds[n.server]=n.client,this.clientToServerIds[n.client]=n.server}}catch(t){r.e(t)}finally{r.f()}}},{key:"updatePlayerUserId",value:function(t){var e=this.getPlayerServerId();if(void 0!==e){var r=this.getConfigForPlayer(e);r&&this.setPlayerConfig(t,r),this.serverToClientIds[e]=t,this.clientToServerIds[t]=e}}},{key:"getPlayerServerId",value:function(){var t=Q.u.getSessionHash();if(!t){if(!(0,$.GV)())throw new Error("Couldn't get session id");t=Q.u.getUserId()}return this.getServerId(t)}},{key:"getDbId",value:function(t){var e,r;return null!==(e=null===(r=this.getConfigForPlayer(t))||void 0===r?void 0:r.dbId)&&void 0!==e?e:""}},{key:"getClientId",value:function(t){return this.serverToClientIds[t]}},{key:"getServerId",value:function(t){return this.clientToServerIds[t]}},{key:"setPlayerConfig",value:function(t,e){this.playerData[t]=e}},{key:"setGameConfigurations",value:function(t){this.playerData=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?nt(Object(r),!0).forEach((function(e){ut(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t.playerConfig),this.map=t.mapId}},{key:"getConfigForPlayer",value:function(t){return this.playerData[this.getClientId(t)]}},{key:"getConfigForPlayerClient",value:function(t){return this.playerData[t]}},{key:"initNetworkDeterminedMap",value:(n=et().mark((function t(){return et().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=eh,t.next=3,(0,Z.h)(this.map);case 3:return t.t1=t.sent,t.next=6,t.t0.setMap.call(t.t0,t.t1);case 6:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){rt(i,r,o,a,u,"next",t)}function u(t){rt(i,r,o,a,u,"throw",t)}a(void 0)}))},function(){return o.apply(this,arguments)})}],e&&at(t.prototype,e),r&&at(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}(),lt=r(74009),ft=r(41475);function ht(t){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(t)}function pt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dt(n.key),n)}}function yt(t,e,r){return(e=dt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dt(t){var e=function(t,e){if("object"!=ht(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ht(e)?e:e+""}var vt=.15,mt=function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),yt(this,"serverInputs",void 0),yt(this,"clientInputs",void 0),yt(this,"networked",void 0),yt(this,"inputType",void 0),yt(this,"deferInput",void 0),yt(this,"focused",void 0),yt(this,"controllerButtons",{}),yt(this,"controllerAxes",{}),this.resetInputs(),this.networked={reset:!1},this.focused=!1,this.deferInput=!1,this.inputType="keyboard",this.initKeyboard(),this.update(),this.initController(),window.addEventListener("focusin",(function(t){t.target instanceof Element&&t.target.matches('input[type="text"], input[type="email"], input[type="password"], textarea')&&(e.focused=!0)})),window.addEventListener("focusout",(function(t){t.target instanceof Element&&t.target.matches('input[type="text"], input[type="email"], input[type="password"], textarea')&&(e.focused=!1)}))},e=[{key:"setInputType",value:function(t,e){this.inputType=t,w.h.dispatch((0,ft.h)(null!=e?e:null))}},{key:"isFocused",value:function(){return this.focused}},{key:"cloneInput",value:function(){return[this.serverInputs.gas,this.serverInputs.brake,this.serverInputs.left,this.serverInputs.right,this.serverInputs.drift?1:0,this.serverInputs.useItem]}},{key:"emptyInput",value:function(){return[0,0,0,0,0,0]}},{key:"update",value:function(){var t=this;Object.values(navigator.getGamepads()).forEach((function(e){if(e){if("controller"!==t.inputType){if(!e.buttons.some((function(t){return t.pressed}))&&!e.axes.some((function(e){return!t.isStickDrifting(e)})))return;t.setInputType("controller",{id:e.id,index:e.index})}for(var r=0;r<e.buttons.length;r++){var n,o,i,a,u=e.buttons[r].pressed,c=e.buttons[r].value,s=null!==(n=null===(o=t.controllerButtons[r])||void 0===o?void 0:o.pressed)&&void 0!==n&&n,l=null!==(i=null===(a=t.controllerButtons[r])||void 0===a?void 0:a.value)&&void 0!==i?i:0;u&&!s&&window.dispatchEvent(new CustomEvent("gamepad_keydown",{detail:{button:r,pressed:u,value:c,gamepad:e}})),!u&&s&&window.dispatchEvent(new CustomEvent("gamepad_keyup",{detail:{button:r,pressed:u,value:c,gamepad:e}})),u&&c!==l&&window.dispatchEvent(new CustomEvent("gamepad_keychange",{detail:{button:r,pressed:u,value:e.buttons[r].value,gamepad:e}})),t.controllerButtons[r]={pressed:u,value:e.buttons[r].value}}for(var f=Math.floor(e.axes.length/2),h=0;h<f;h++){var p,y,d,v,m=e.axes[2*h],b=e.axes[2*h+1],g=null!==(p=null===(y=t.controllerAxes[h])||void 0===y?void 0:y.x)&&void 0!==p?p:0,w=null!==(d=null===(v=t.controllerAxes[h])||void 0===v?void 0:v.y)&&void 0!==d?d:0;m===g&&b===w||window.dispatchEvent(new CustomEvent("gamepad_axeschange",{detail:{axe:h,x:m,y:b,gamepad:e}})),t.controllerAxes[h]={x:m,y:b}}}}))}},{key:"isStickDrifting",value:function(t){return Math.abs(t)<vt}},{key:"resetInputs",value:function(){this.serverInputs={gas:0,brake:0,drift:!1,left:0,right:0,useItem:0},this.clientInputs={camX:0,camY:0}}},{key:"isPaused",value:function(){return w.h.getState().game.paused}},{key:"initKeyboard",value:function(){var t=this;window.addEventListener("mousedown",(function(e){qf&&(t.deferInput||t.setInputType("keyboard"))})),window.addEventListener("keydown",(function(e){if(qf&&!t.deferInput&&("keyboard"!==t.inputType&&t.setInputType("keyboard"),!e.repeat&&!t.isPaused()))switch(e.code){case qf.controls.keyBinds[lt.JL.GAS][0]:case qf.controls.keyBinds[lt.JL.GAS][1]:t.serverInputs.gas=1;break;case qf.controls.keyBinds[lt.JL.BRAKE][0]:case qf.controls.keyBinds[lt.JL.BRAKE][1]:t.serverInputs.brake=1;break;case qf.controls.keyBinds[lt.JL.LEFT][0]:case qf.controls.keyBinds[lt.JL.LEFT][1]:t.serverInputs.left=1;break;case qf.controls.keyBinds[lt.JL.RIGHT][0]:case qf.controls.keyBinds[lt.JL.RIGHT][1]:t.serverInputs.right=1;break;case qf.controls.keyBinds[lt.JL.DRIFT][0]:case qf.controls.keyBinds[lt.JL.DRIFT][1]:t.serverInputs.drift=!0;break;case qf.controls.keyBinds[lt.JL.CAM_FORWARDS][0]:case qf.controls.keyBinds[lt.JL.CAM_FORWARDS][1]:t.clientInputs.camY<=0&&(t.clientInputs.camY+=1);break;case qf.controls.keyBinds[lt.JL.CAM_BACKWARDS][0]:case qf.controls.keyBinds[lt.JL.CAM_BACKWARDS][1]:t.clientInputs.camY>=0&&(t.clientInputs.camY-=1);break;case qf.controls.keyBinds[lt.JL.CAM_LEFT][0]:case qf.controls.keyBinds[lt.JL.CAM_LEFT][1]:t.clientInputs.camX>=0&&(t.clientInputs.camX-=1);break;case qf.controls.keyBinds[lt.JL.CAM_RIGHT][0]:case qf.controls.keyBinds[lt.JL.CAM_RIGHT][1]:t.clientInputs.camX<=0&&(t.clientInputs.camX+=1);break;case qf.controls.keyBinds[lt.JL.USE_ITEM][0]:case qf.controls.keyBinds[lt.JL.USE_ITEM][1]:t.serverInputs.useItem=1;break;case qf.controls.keyBinds[lt.JL.RESET][0]:case qf.controls.keyBinds[lt.JL.RESET][1]:t.networked.reset=!0}})),window.addEventListener("keyup",(function(e){if(qf&&!e.repeat&&!t.deferInput&&("Escape"!=e.code&&"KeyP"!=e.code||(t.isPaused()?th.resume():th.pause()),!t.isPaused()))switch(e.code){case qf.controls.keyBinds[lt.JL.GAS][0]:case qf.controls.keyBinds[lt.JL.GAS][1]:t.serverInputs.gas=0;break;case qf.controls.keyBinds[lt.JL.BRAKE][0]:case qf.controls.keyBinds[lt.JL.BRAKE][1]:t.serverInputs.brake=0;break;case qf.controls.keyBinds[lt.JL.LEFT][0]:case qf.controls.keyBinds[lt.JL.LEFT][1]:t.serverInputs.left=0;break;case qf.controls.keyBinds[lt.JL.RIGHT][0]:case qf.controls.keyBinds[lt.JL.RIGHT][1]:t.serverInputs.right=0;break;case qf.controls.keyBinds[lt.JL.DRIFT][0]:case qf.controls.keyBinds[lt.JL.DRIFT][1]:t.serverInputs.drift=!1;break;case qf.controls.keyBinds[lt.JL.CAM_FORWARDS][0]:case qf.controls.keyBinds[lt.JL.CAM_FORWARDS][1]:t.clientInputs.camY>=0&&(t.clientInputs.camY-=1);break;case qf.controls.keyBinds[lt.JL.CAM_BACKWARDS][0]:case qf.controls.keyBinds[lt.JL.CAM_BACKWARDS][1]:t.clientInputs.camY<=0&&(t.clientInputs.camY+=1);break;case qf.controls.keyBinds[lt.JL.CAM_LEFT][0]:case qf.controls.keyBinds[lt.JL.CAM_LEFT][1]:t.clientInputs.camX<=0&&(t.clientInputs.camX+=1);break;case qf.controls.keyBinds[lt.JL.CAM_RIGHT][0]:case qf.controls.keyBinds[lt.JL.CAM_RIGHT][1]:t.clientInputs.camX>=0&&(t.clientInputs.camX-=1);break;case qf.controls.keyBinds[lt.JL.USE_ITEM][0]:case qf.controls.keyBinds[lt.JL.USE_ITEM][1]:t.serverInputs.useItem=0;break;case qf.controls.keyBinds[lt.JL.RESET][0]:case qf.controls.keyBinds[lt.JL.RESET][1]:t.networked.reset=!1}}))}},{key:"hasGamepadSupport",value:function(){return"getGamepads"in navigator}},{key:"initController",value:function(){var t=this;function e(t,e){var r=qf.controls.controllerBinds.button[e];return null!==r&&r==t}function r(t,e){var r=qf.controls.controllerBinds.axis[e.axe],n=e.x<vt&&e.x>-.15?0:e.x,o=e.y<vt&&e.y>-.15?0:-e.y;return r!==t?null:{x:n,y:o}}window.addEventListener("gamepadconnected",(function(e){console.log("Gamepad connected at index %d: %s. %d buttons, %d axes.",e.gamepad.index,e.gamepad.id,e.gamepad.buttons.length,e.gamepad.axes.length),t.setInputType("controller",{index:e.gamepad.index,id:e.gamepad.id})})),window.addEventListener("gamepad_keydown",(function(r){e(lt.oI.GAS,r.detail.button)&&(t.serverInputs.gas=r.detail.value),e(lt.oI.BRAKE,r.detail.button)&&(t.serverInputs.brake=r.detail.value),e(lt.oI.LEFT,r.detail.button)&&(t.serverInputs.left=r.detail.value),e(lt.oI.RIGHT,r.detail.button)&&(t.serverInputs.right=r.detail.value),e(lt.oI.DRIFT,r.detail.button)&&(t.serverInputs.drift=!0),e(lt.oI.RESET,r.detail.button)&&(t.networked.reset=!0)})),window.addEventListener("gamepad_keyup",(function(r){e(lt.oI.GAS,r.detail.button)&&(t.serverInputs.gas=0),e(lt.oI.BRAKE,r.detail.button)&&(t.serverInputs.brake=0),e(lt.oI.LEFT,r.detail.button)&&(t.serverInputs.left=0),e(lt.oI.RIGHT,r.detail.button)&&(t.serverInputs.right=0),e(lt.oI.DRIFT,r.detail.button)&&(t.serverInputs.drift=!1),e(lt.oI.RESET,r.detail.button)&&(t.networked.reset=!1)}));var n=function(t){return Math.abs(t)>.9?.99999:Math.pow(Math.abs(t),3)};window.addEventListener("gamepad_axeschange",(function(e){var o=r(lt.oI.STEERING,e.detail);null!==o&&(t.serverInputs.left=o.x<0?n(o.x):0,t.serverInputs.right=o.x>0?n(o.x):0);var i=r(lt.oI.CAM,e.detail);null!==i&&(t.clientInputs.camX=i.x,t.clientInputs.camY=i.y)})),window.addEventListener("gamepaddisconnected",(function(e){var r=w.h.getState().gamepad.activeIndex;"controller"===t.inputType&&r===e.gamepad.index&&t.setInputType("keyboard"),console.log("Gamepad disconnected from index %d: %s",e.gamepad.index,e.gamepad.id)}))}},{key:"initTouchControls",value:function(t){var e=this;t.on("start",(function(){e.isPaused()||"touch"!==e.inputType&&e.setInputType("touch")})),t.on("move",(function(t,r){e.isPaused()||(e.clientInputs.camX=Math.sin(r.vector.x*Math.PI),e.clientInputs.camY=Math.cos(r.vector.x*Math.PI))})),t.on("end",(function(){e.clientInputs.camX=0,e.clientInputs.camY=0}))}}],r=[{key:"serializeInputState",value:function(t){return[t.gas,t.brake,t.left,t.right,t.drift?1:0]}}],e&&pt(t.prototype,e),r&&pt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function bt(t,e){var r=e.changedTouches[0];return new MouseEvent(t,{view:window,bubbles:!0,cancelable:!1,clientX:r.clientX,clientY:r.clientY,screenX:r.screenX,screenY:r.screenY,relatedTarget:e.target,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,altKey:e.altKey,metaKey:e.metaKey})}function gt(t){switch(Oh.trackPageLeave(),w.h.getState().global.scene){case"MAP-TOOLS":case"GRAND-PRIX":case"TIME-TRIALS":return t.returnValue="Are you sure you want to leave the game?",t.returnValue}}var wt=r(85958),St=r(3173);function xt(t){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xt(t)}function Ot(){Ot=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==xt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(xt(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Pt(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Et(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Pt(i,n,o,a,u,"next",t)}function u(t){Pt(i,n,o,a,u,"throw",t)}a(void 0)}))}}function jt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ct(n.key),n)}}function kt(t,e,r){return e=_t(e),function(t,e){if(e&&("object"==xt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Tt()?Reflect.construct(e,r||[],_t(t).constructor):e.apply(t,r))}function Tt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Tt=function(){return!!t})()}function _t(t){return _t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_t(t)}function Lt(t,e){return Lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Lt(t,e)}function It(t,e,r){return(e=Ct(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ct(t){var e=function(t,e){if("object"!=xt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=xt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==xt(e)?e:e+""}var At=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return It(t=kt(this,e,[].concat(n)),"sdkId","none"),It(t,"init",Et(Ot().mark((function t(){return Ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,F.Z)());case 1:case"end":return t.stop()}}),t)})))),It(t,"playAd",Et(Ot().mark((function t(){return Ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,F.Z)());case 1:case"end":return t.stop()}}),t)})))),It(t,"rewardAd",Et(Ot().mark((function t(){return Ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",!0);case 1:case"end":return t.stop()}}),t)})))),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Lt(t,e)}(e,t),r=e,n&&jt(r.prototype,n),o&&jt(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(St.z);function Mt(t){return Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mt(t)}function Rt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Nt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Rt(Object(r),!0).forEach((function(e){Ht(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Rt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Dt(){Dt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==Mt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Mt(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Bt(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Ft(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Bt(i,n,o,a,u,"next",t)}function u(t){Bt(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Gt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qt(n.key),n)}}function Ut(t,e,r){return e=Wt(e),function(t,e){if(e&&("object"==Mt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,zt()?Reflect.construct(e,r||[],Wt(t).constructor):e.apply(t,r))}function zt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(zt=function(){return!!t})()}function Wt(t){return Wt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Wt(t)}function Vt(t,e){return Vt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Vt(t,e)}function Ht(t,e,r){return(e=qt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qt(t){var e=function(t,e){if("object"!=Mt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Mt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Mt(e)?e:e+""}var Xt=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Ut(this,e,[t])).framed=n,Ht(r,"sdkId","crazygames"),Ht(r,"crazygames",void 0),Ht(r,"gameplayActive",!1),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vt(t,e)}(e,t),r=e,n=[{key:"init",value:(v=Ft(Dt().mark((function t(){var e,r=this;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(e=document.createElement("script")).setAttribute("src","//sdk.crazygames.com/crazygames-sdk-v3.js"),document.head.appendChild(e),t.next=5,new Promise((function(t){var n=setTimeout((function(){t(!1)}),1e4);e.onload=function(){var e;if(clearTimeout(n),null===(e=window.CrazyGames)||void 0===e||!e.SDK)return console.error("CrazyGames SDK not available"),void t(!1);window.CrazyGames.SDK.init().then((function(){return t(!0)})).catch((function(e){console.log("Initialized, but the user likely has adblock",e),t(!0)})),r.crazygames=window.CrazyGames.SDK,setTimeout((function(){var t;r.openInviteDialog({room:null!==(t=Zf.getFullRoomCode())&&void 0!==t?t:""})}),4e3)}}));case 5:this.crazygames.game.loadingStart();case 6:case"end":return t.stop()}}),t,this)}))),function(){return v.apply(this,arguments)})},{key:"playAd",value:(d=Ft(Dt().mark((function t(){var e,r=this;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.crazygames){t.next=2;break}return t.abrupt("return");case 2:return this.trackAdShownAttempt("video"),t.next=5,this.crazygames.ad.hasAdblock();case 5:if(!t.sent){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,new Promise((function(t){r.crazygames.ad.requestAd("midgame",{adFinished:function(){r.trackAdShown("video"),t()},adError:function(e){console.error("Ad error",e),t()},adStarted:function(){var t;null===(t=r.config.lifecycle)||void 0===t||t.hardPause()}})}));case 9:null===(e=this.config.lifecycle)||void 0===e||e.resume();case 10:case"end":return t.stop()}}),t,this)}))),function(){return d.apply(this,arguments)})},{key:"rewardAd",value:(y=Ft(Dt().mark((function t(){var e,r,n,o=this;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.crazygames){t.next=2;break}return t.abrupt("return",!1);case 2:return this.trackAdShownAttempt("reward"),null===(e=this.config.lifecycle)||void 0===e||e.hardPause(),t.next=6,new Promise((function(t){o.crazygames.ad.requestAd("rewarded",{adFinished:function(){o.trackAdShown("reward"),t(void 0)},adError:function(e){return"Ad requested too soon"===e.message?t("Please wait a moment before watching another ad."):"No ad available"===e.message?t("No ad available. Try again later."):void t("An error occurred while trying to watch an ad.")},adStarted:function(){var t;null===(t=o.config.lifecycle)||void 0===t||t.hardPause()}})}));case 6:if(n=t.sent,null===(r=this.config.lifecycle)||void 0===r||r.resume(),!n){t.next=10;break}throw new Error(n);case 10:return t.abrupt("return",!0);case 11:case"end":return t.stop()}}),t,this)}))),function(){return y.apply(this,arguments)})},{key:"pageLoaded",value:function(){var t;null===(t=this.crazygames)||void 0===t||t.game.loadingStop()}},{key:"gameplayStart",value:(p=Ft(Dt().mark((function t(){var e;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.gameplayActive){t.next=2;break}return t.abrupt("return");case 2:this.gameplayActive=!0,null===(e=this.crazygames)||void 0===e||e.game.gameplayStart();case 4:case"end":return t.stop()}}),t,this)}))),function(){return p.apply(this,arguments)})},{key:"gameplayStop",value:(h=Ft(Dt().mark((function t(){var e;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.gameplayActive){t.next=2;break}return t.abrupt("return");case 2:this.gameplayActive=!1,null===(e=this.crazygames)||void 0===e||e.game.gameplayStop();case 4:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)})},{key:"getUrlParam",value:(f=Ft(Dt().mark((function t(e){var r;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",null===(r=this.crazygames)||void 0===r?void 0:r.game.getInviteParam(e));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return f.apply(this,arguments)})},{key:"getShareableUrl",value:(l=Ft(Dt().mark((function t(e){var r;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.abrupt("return",null===(r=this.crazygames)||void 0===r?void 0:r.game.inviteLink(null!=e?e:{}));case 4:return t.prev=4,t.t0=t.catch(0),t.abrupt("return",void 0);case 7:case"end":return t.stop()}}),t,this,[[0,4]])}))),function(t){return l.apply(this,arguments)})},{key:"hasAdBlock",value:(s=Ft(Dt().mark((function t(){var e,r;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",null!==(e=null===(r=this.crazygames)||void 0===r?void 0:r.ad.hasAdblock())&&void 0!==e&&e);case 1:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"openInviteDialog",value:(c=Ft(Dt().mark((function t(e){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.crazygames.game.showInviteButton(Nt({},e));case 2:case"end":return t.stop()}}),t,this)}))),function(t){return c.apply(this,arguments)})},{key:"showAuthPrompt",value:(u=Ft(Dt().mark((function t(){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.crazygames.user.showAuthPrompt();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.error("Failed to show auth prompt",t.t0);case 8:case"end":return t.stop()}}),t,this,[[0,5]])}))),function(){return u.apply(this,arguments)})},{key:"listenForAuth",value:(a=Ft(Dt().mark((function t(e){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.crazygames.user.addAuthListener(e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"getUserToken",value:(i=Ft(Dt().mark((function t(){var e;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,null===(e=this.crazygames)||void 0===e?void 0:e.user.getUserToken();case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",void 0);case 9:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(){return i.apply(this,arguments)})}],n&&Gt(r.prototype,n),o&&Gt(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,i,a,u,c,s,l,f,h,p,y,d,v}(St.z);function Kt(t,e){switch(e){case"discord":return new wt.s(t);case"crazygames":return new Xt(t)}return $.Vi,new At(t)}var Yt=r(68531);function Jt(t){return Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jt(t)}function Zt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Qt(n.key),n)}}function Qt(t){var e=function(t,e){if("object"!=Jt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Jt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Jt(e)?e:e+""}var $t=function(){return t=function t(){var e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,n=void 0,(r=Qt(r="available"))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,this.available=this.isLocalStorageAvailable()},(e=[{key:"isLocalStorageAvailable",value:function(){var t="test";try{return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(t){return!1}}},{key:"get",value:function(t){var e;if(this.available)return null!==(e=localStorage.getItem(t))&&void 0!==e?e:void 0}},{key:"set",value:function(t,e){this.available&&localStorage.setItem(t,e)}},{key:"remove",value:function(t){this.available&&localStorage.removeItem(t)}},{key:"has",value:function(t){return!!this.available&&null!==localStorage.getItem(t)}}])&&Zt(t.prototype,e),r&&Zt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function te(t){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(t)}function ee(){ee=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==te(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(te(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function re(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function ne(t){return oe.apply(this,arguments)}function oe(){var t;return t=ee().mark((function t(e){return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!zf.isFrameComplete(e)){t.next=2;break}return t.abrupt("return");case 2:return t.abrupt("return",new Promise((function(t){uh.callbackFn=function(r){r>=e&&(uh.callbackFn=F.Z,t())}})));case 3:case"end":return t.stop()}}),t)})),oe=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){re(i,n,o,a,u,"next",t)}function u(t){re(i,n,o,a,u,"throw",t)}a(void 0)}))},oe.apply(this,arguments)}var ie=r(26912);function ae(t){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(t)}function ue(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ce(n.key),n)}}function ce(t){var e=function(t,e){if("object"!=ae(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ae(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ae(e)?e:e+""}var se=ie.z.object({version:ie.z.number().int().positive(),tutorial:ie.z.object({lastStepIndex:ie.z.number(),completed:ie.z.boolean()})}),le=function(){return t=function t(){var e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,n=1,(r=ce(r="version"))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n},(e=[{key:"migrate",value:function(){var t={version:this.version,tutorial:{lastStepIndex:0,completed:!1}};return se.parse(t),t}}])&&ue(t.prototype,e),r&&ue(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),fe=r(68477),he=r(79355),pe={audio:{master:1,music:.5,sfx:.5},controls:{keyBinds:he.I.keyBinds,controllerBinds:he.I.controllerBinds},video:{preset:j.L.LOW,renderScale:.5,antialiasingEnabled:!1,shadowQuality:j.U.NONE},ui:{stats:{fpsEnabled:!0,pingEnabled:!0,speedEnabled:!1,frameComputeTimeEnabled:!1,physicsComputeTimeEnabled:!1},uiScale:O.tq?1.2:1},network:{region:void 0,dynamicInputDelay:!0,customInputDelay:5}};function ye(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return de(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?de(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function de(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ve(t){return ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ve(t)}function me(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,be(n.key),n)}}function be(t){var e=function(t,e){if("object"!=ve(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ve(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ve(e)?e:e+""}var ge=ie.z.object({mobile:ie.z.boolean(),recommended:ie.z.string(),gpu:ie.z.object({tier:ie.z.number(),type:ie.z.string(),isMobile:ie.z.boolean().optional(),fps:ie.z.number().optional(),gpu:ie.z.string().optional(),device:ie.z.string().optional()})}),we=ie.z.object({master:ie.z.number(),music:ie.z.number(),sfx:ie.z.number()}),Se=ie.z.object({keyBinds:ie.z.array(ie.z.tuple([ie.z.string(),ie.z.string()])),controllerBinds:ie.z.object({axis:ie.z.record(ie.z.string(),ie.z.nativeEnum(lt.oI)),button:ie.z.record(ie.z.string(),ie.z.nativeEnum(lt.oI))})}),xe=ie.z.object({preset:ie.z.nativeEnum(j.L),renderScale:ie.z.number(),antialiasingEnabled:ie.z.boolean(),shadowQuality:ie.z.nativeEnum(j.U)}),Oe=ie.z.object({stats:ie.z.object({fpsEnabled:ie.z.boolean(),pingEnabled:ie.z.boolean(),speedEnabled:ie.z.boolean(),frameComputeTimeEnabled:ie.z.boolean(),physicsComputeTimeEnabled:ie.z.boolean()}),uiScale:ie.z.number()}),Pe=ie.z.object({region:ie.z.string().optional(),dynamicInputDelay:ie.z.boolean(),customInputDelay:ie.z.number()}),Ee=se.extend({settings:ie.z.object({hardware:ge.optional(),audio:we,controls:Se,video:xe,ui:Oe,network:Pe})}),je=function(){return t=function t(){var e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,n=2,(r=be(r="version"))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n},(e=[{key:"migrate",value:function(t){var e,r=JSON.parse(null!==(e=vh.get("settings-v1"))&&void 0!==e?e:"{}"),n=(0,fe.Z)(t,{settings:pe},{settings:r});return yh.increaseDefaultUiScale&&(n.settings.ui.uiScale=1.2),function(t,e,r){var n,o=ye(t.settings.controls.keyBinds);try{for(o.s();!(n=o.n()).done;){var i=n.value;r.includes(i[0])?(i[1]=i[0],i[1]=""):r.includes(i[1])&&(i[1]="")}}catch(t){o.e(t)}finally{o.f()}t.settings.controls.keyBinds[e]=r}(n,lt.JL.USE_ITEM,["ShiftLeft",""]),Ee.parse(n),n}}])&&me(t.prototype,e),r&&me(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function ke(t){return ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ke(t)}function Te(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _e(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Te(Object(r),!0).forEach((function(e){Ie(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Te(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Le(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ce(n.key),n)}}function Ie(t,e,r){return(e=Ce(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ce(t){var e=function(t,e){if("object"!=ke(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ke(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ke(e)?e:e+""}var Ae=Ee.extend({tutorial:ie.z.object({initialTutorialCompleted:ie.z.boolean(),itemTutorialCompleted:ie.z.boolean(),driftTutorialCompleted:ie.z.boolean()})}),Me=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Ie(this,"version",3)},(e=[{key:"migrate",value:function(t){var e=t.tutorial.completed,r=_e(_e({},t),{},{tutorial:{initialTutorialCompleted:e,itemTutorialCompleted:e,driftTutorialCompleted:e}});return Ae.parse(r),r}}])&&Le(t.prototype,e),r&&Le(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Re(t){return Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Re(t)}function Ne(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,De(n.key),n)}}function De(t){var e=function(t,e){if("object"!=Re(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Re(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Re(e)?e:e+""}var Be=Ae,Fe=function(){return t=function t(){var e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,n=4,(r=De(r="version"))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n},(e=[{key:"migrate",value:function(t){return Array.isArray(t.settings.controls.keyBinds)||(t.settings.controls.keyBinds=Object.values(t.settings.controls.keyBinds)),Be.parse(t),t}}])&&Ne(t.prototype,e),r&&Ne(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Ge(t){return Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ge(t)}function Ue(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ze(n.key),n)}}function ze(t){var e=function(t,e){if("object"!=Ge(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ge(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ge(e)?e:e+""}var We=Be.extend({settings:Be.shape.settings.extend({gameplay:ie.z.object({smartSteering:ie.z.boolean()})})}),Ve=function(){return t=function t(){var e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,n=5,(r=ze(r="version"))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n},(e=[{key:"migrate",value:function(t){return t.settings.gameplay={smartSteering:!0},We.parse(t),t}}])&&Ue(t.prototype,e),r&&Ue(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function He(t){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},He(t)}function qe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Xe(n.key),n)}}function Xe(t){var e=function(t,e){if("object"!=He(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=He(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==He(e)?e:e+""}var Ke=We.extend({cosmetics:ie.z.object({defaultCar:ie.z.number().optional()})}),Ye=function(){return t=function t(){var e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,n=6,(r=Xe(r="version"))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n},(e=[{key:"migrate",value:function(t){return t.cosmetics={defaultCar:void 0},Ke.parse(t),t}}])&&qe(t.prototype,e),r&&qe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Je(t){return Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Je(t)}function Ze(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Qe(n.key),n)}}function Qe(t){var e=function(t,e){if("object"!=Je(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Je(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Je(e)?e:e+""}var $e=Ke.extend({tutorial:ie.z.object({inGameTutorial:ie.z.object({itemTutorialCompleted:ie.z.boolean(),driftTutorialCompleted:ie.z.boolean()}),initialTutorial:ie.z.object({complete:ie.z.boolean(),step:ie.z.string().optional()})})}),tr=function(){return t=function t(){var e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,n=7,(r=Qe(r="version"))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n},e=[{key:"migrate",value:function(t){var e={initialTutorial:{complete:t.tutorial.initialTutorialCompleted,step:void 0},inGameTutorial:{itemTutorialCompleted:t.tutorial.itemTutorialCompleted,driftTutorialCompleted:t.tutorial.driftTutorialCompleted}};return t.tutorial=e,t}}],e&&Ze(t.prototype,e),r&&Ze(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function er(t){return er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},er(t)}function rr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function nr(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?rr(Object(r),!0).forEach((function(e){ir(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function or(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ar(n.key),n)}}function ir(t,e,r){return(e=ar(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ar(t){var e=function(t,e){if("object"!=er(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=er(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==er(e)?e:e+""}var ur=$e.extend({settings:$e.shape.settings.extend({audio:$e.shape.settings.shape.audio.extend({muffleMusicOnPause:ie.z.boolean(),visualizerEnabled:ie.z.boolean()})})}),cr=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ir(this,"version",8)},(e=[{key:"migrate",value:function(t){return t.settings.audio=nr(nr({},t.settings.audio),{},{muffleMusicOnPause:!0,visualizerEnabled:!O.tq}),ur.parse(t),t}}])&&or(t.prototype,e),r&&or(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function sr(t){return sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sr(t)}function lr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function fr(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?lr(Object(r),!0).forEach((function(e){pr(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):lr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function hr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yr(n.key),n)}}function pr(t,e,r){return(e=yr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yr(t){var e=function(t,e){if("object"!=sr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=sr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==sr(e)?e:e+""}var dr=ur.extend({settings:ur.shape.settings.extend({ui:ur.shape.settings.shape.ui.extend({stats:ur.shape.settings.shape.ui.shape.stats.extend({gpuComputeTimeEnabled:ie.z.boolean()})})})}),vr=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),pr(this,"version",9)},(e=[{key:"migrate",value:function(t){return t.settings.ui.stats=fr(fr({},t.settings.ui.stats),{},{gpuComputeTimeEnabled:!1}),dr.parse(t),t}}])&&hr(t.prototype,e),r&&hr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function mr(t){return mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mr(t)}function br(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function gr(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?br(Object(r),!0).forEach((function(e){Sr(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):br(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function wr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xr(n.key),n)}}function Sr(t,e,r){return(e=xr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xr(t){var e=function(t,e){if("object"!=mr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=mr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==mr(e)?e:e+""}var Or=dr.extend({settings:dr.shape.settings.extend({video:dr.shape.settings.shape.video.extend({advancedMaterialFxEnabled:ie.z.boolean()})})}),Pr=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Sr(this,"version",10)},(e=[{key:"migrate",value:function(t){return t.settings.video=gr(gr({},t.settings.video),{},{advancedMaterialFxEnabled:t.settings.video.preset===j.L.HIGH}),Or.parse(t),t}}])&&wr(t.prototype,e),r&&wr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Er(t){return Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Er(t)}function jr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function kr(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?jr(Object(r),!0).forEach((function(e){_r(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Tr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Lr(n.key),n)}}function _r(t,e,r){return(e=Lr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lr(t){var e=function(t,e){if("object"!=Er(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Er(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Er(e)?e:e+""}var Ir=Or.extend({settings:Or.shape.settings.extend({video:Or.shape.settings.shape.video.extend({speedLinesEnabled:ie.z.boolean()})})}),Cr=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),_r(this,"version",10)},(e=[{key:"migrate",value:function(t){return t.settings.video=kr(kr({},t.settings.video),{},{speedLinesEnabled:t.settings.video.preset===j.L.HIGH}),Ir.parse(t),t}}])&&Tr(t.prototype,e),r&&Tr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Ar(t){return Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ar(t)}function Mr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Nr(n.key),n)}}function Rr(t,e,r){return(e=Nr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Nr(t){var e=function(t,e){if("object"!=Ar(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ar(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ar(e)?e:e+""}var Dr=[new le,new je,new Me,new Fe,new Ve,new Ye,new tr,new cr,new vr,new Pr,new Cr],Br=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Rr(this,"data",void 0),Rr(this,"isFirstTime",void 0);var e=vh.get("user");try{e?(this.isFirstTime=!1,this.data=this.migrate(JSON.parse(e))):(this.isFirstTime=!0,this.data=this.migrate({version:0}))}catch(t){console.error("Migration Failed: ",t),localStorage.setItem("settings-v1","{}"),this.isFirstTime=!1,this.data=this.migrate({version:0})}this.save()},(e=[{key:"migrate",value:function(t){for(var e=0,r=Dr;e<r.length;e++){var n=r[e];n.version<=t.version||((t=n.migrate(t)).version=n.version)}return t}},{key:"save",value:function(){vh.set("user",JSON.stringify(this.data))}},{key:"firstTime",get:function(){return this.isFirstTime}}])&&Mr(t.prototype,e),r&&Mr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),Fr=r(44018);function Gr(t){return Gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gr(t)}function Ur(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wr(n.key),n)}}function zr(t,e,r){return(e=Wr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wr(t){var e=function(t,e){if("object"!=Gr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Gr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Gr(e)?e:e+""}var Vr=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),zr(this,"idCounter",0),zr(this,"callstack",{})},(e=[{key:"register",value:function(t){var e=this.idCounter++;return this.callstack[e]=t,e}},{key:"cancel",value:function(t){delete this.callstack[t]}},{key:"run",value:function(t,e){for(var r=0,n=Object.keys(this.callstack);r<n.length;r++){var o=n[r],i=parseInt(o);this.callstack[i]&&(this.callstack[i](1e3*t,e),delete this.callstack[i])}}}])&&Ur(t.prototype,e),r&&Ur(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),Hr=r(68957),qr=r(47056),Xr=r(93192);var Kr=r(50602);function Yr(t){return Yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yr(t)}function Jr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Qr(n.key),n)}}function Zr(t,e,r){return(e=Qr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qr(t){var e=function(t,e){if("object"!=Yr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Yr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Yr(e)?e:e+""}var $r=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Zr(this,"timeoutId",void 0),Zr(this,"timeoutInMilliseconds",2e4),Zr(this,"isUserActive",!0),Zr(this,"handlePageInteractionBound",void 0),Zr(this,"handleVisibilityChangeBound",void 0),Zr(this,"activeFlow",void 0),this.activeFlow=new Kr.Z,this.handlePageInteractionBound=this.handlePageInteraction.bind(this),this.handleVisibilityChangeBound=this.handleVisibilityChange.bind(this),document.addEventListener("visibilitychange",this.handleVisibilityChangeBound),window.addEventListener("touchstart",this.handlePageInteractionBound),window.addEventListener("mousemove",this.handlePageInteractionBound),window.addEventListener("keypress",this.handlePageInteractionBound),window.addEventListener("scroll",this.handlePageInteractionBound),this.resetTimer()},(e=[{key:"destroy",value:function(){document.addEventListener("visibilitychange",this.handleVisibilityChangeBound),window.removeEventListener("touchstart",this.handlePageInteractionBound),window.removeEventListener("mousemove",this.handlePageInteractionBound),window.removeEventListener("keypress",this.handlePageInteractionBound),window.removeEventListener("scroll",this.handlePageInteractionBound),clearTimeout(this.timeoutId)}},{key:"getIsActive",value:function(){return this.isUserActive}},{key:"handlePageInteraction",value:function(){this.setActive(),this.resetTimer()}},{key:"handleVisibilityChange",value:function(){document.hidden?this.setInactive():(this.setActive(),this.resetTimer())}},{key:"resetTimer",value:function(){this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout(this.setInactive.bind(this),this.timeoutInMilliseconds)}},{key:"setActive",value:function(){this.isUserActive||(this.activeFlow.push(!0),this.isUserActive=!0)}},{key:"setInactive",value:function(){this.isUserActive&&(this.timeoutId&&clearTimeout(this.timeoutId),this.activeFlow.push(!1),this.isUserActive=!1)}}])&&Jr(t.prototype,e),r&&Jr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function tn(t){return tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tn(t)}function en(){en=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==tn(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(tn(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function rn(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function nn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){rn(i,n,o,a,u,"next",t)}function u(t){rn(i,n,o,a,u,"throw",t)}a(void 0)}))}}function on(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,un(n.key),n)}}function an(t,e,r){return(e=un(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function un(t){var e=function(t,e){if("object"!=tn(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=tn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==tn(e)?e:e+""}var cn=function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),an(this,"ws",void 0),an(this,"buffer",[]),an(this,"room",void 0),an(this,"awaitRoom",void 0),an(this,"roomFlow",void 0),an(this,"bucketFlow",void 0),an(this,"requestNewTicket",void 0),an(this,"newRegionFlow",void 0),an(this,"physicsStateFlow",void 0),an(this,"lastConnection",void 0),an(this,"activityMonitor",void 0),an(this,"roomResolve",void 0),an(this,"shouldReconnectOnActive",void 0),an(this,"canEnterGame",void 0),an(this,"readyToEnter",void 0),an(this,"pingInterval",void 0),an(this,"resetConnectionAttempts",void 0),an(this,"reconnectionAttemps",void 0),an(this,"onopen",(function(t){e.resetReconnectionAttemptsTimeout(),e.resetConnectionAttempts=setTimeout((function(){e.reconnectionAttemps=0}),1e4),e.buffer.forEach(e.send.bind(e)),e.buffer=[]})),an(this,"onerror",(function(t){console.error("Websocket Error: ",t),e.close(),e.attemptReconnect(t)})),an(this,"onclose",(function(t){1010!==t.code?(console.log("Websocket Closed: ",t),e.close(),e.attemptReconnect(t)):e.requestNewTicket.push(!0)})),an(this,"onmessage",(function(t){if(t.data instanceof Blob)t.data.arrayBuffer().then((function(t){e.physicsStateFlow.push(new Uint8Array(t))}));else try{var r=JSON.parse(t.data);switch(r.event){case"sessionUpdate":e.sessionUpdate(r.data);break;case"gameConnect":e.gameConnect(r.data);break;case"roomUpdate":e.roomUpdate(r.data);break;case"chatroomUpdate":e.chatroomUpdate(r.data);break;case"bucketUpdate":e.bucketUpdate(r.data);break;case"switchRegionUpdate":e.switchRegionUpdate(r.data);break;case"pong":break;default:console.warn("Unhandled event: ".concat(r.event))}}catch(t){console.error(t)}})),this.shouldReconnectOnActive=!1,this.canEnterGame=!1,this.readyToEnter=!1,this.awaitRoom=new Promise((function(t){e.roomResolve=t})),this.requestNewTicket=new Kr.Z,this.roomFlow=new Kr.Z,this.physicsStateFlow=new Kr.Z,this.bucketFlow=new Kr.Z,this.newRegionFlow=new Kr.Z,this.activityMonitor=new $r,this.reconnectionAttemps=0,this.activityMonitor.activeFlow.addListener((function(t){var r;"menu"===(null===(r=e.room)||void 0===r?void 0:r.state)&&e.activityUpdate(t),e.shouldReconnectOnActive&&(e.shouldReconnectOnActive=!1,e.lastConnection&&e.connect(e.lastConnection))}))},e=[{key:"isConnected",value:function(){var t,e;return void 0!==this.ws&&(null===(t=this.ws)||void 0===t?void 0:t.readyState)===(null===(e=this.ws)||void 0===e?void 0:e.OPEN)}},{key:"connect",value:(o=nn(en().mark((function t(e){var r,n,o,i,a,u,c=this;return en().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.lastConnection=e,r=e.host,n=e.roomCode,o=e.specialConnectionId,this.awaitRoom=new Promise((function(t){c.roomResolve=t})),i="".concat("wss:","//").concat(r,"/broadcast/socket?userId=").concat(Q.u.getUserId()),(a=Q.u.getSessionId())&&(i+="&sid=".concat(a)),n&&(i+="&roomCode=".concat(n)),t.next=9,rh.getAuthenticationToken();case 9:if((u=t.sent)&&(i+="&token=".concat(u)),o&&(i+="&connectionId=".concat(o)),this.close(),this.canEnterGame=!1,this.readyToEnter=!1,!("WebSocket"in window)){t.next=19;break}this.ws=new WebSocket(i),t.next=20;break;case 19:throw new Error("Your browser does not support websocket");case 20:this.ws.onclose=this.onclose.bind(this),this.ws.onopen=this.onopen.bind(this),this.ws.onerror=this.onerror.bind(this),this.ws.onmessage=this.onmessage.bind(this),this.pingInterval=setInterval((function(){c.ws&&c.ping()}),5e3);case 25:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"close",value:function(){this.ws&&(Q.u.clearSessionInfo(),this.ws.onclose=F.Z,this.ws.close(),this.ws=void 0),this.pingInterval&&clearInterval(this.pingInterval)}},{key:"attemptReconnect",value:function(t){var e=this;if(this.resetReconnectionAttemptsTimeout(),this.activityMonitor.getIsActive())if(this.reconnectionAttemps<5){var r=Math.min(Math.pow(10,this.reconnectionAttemps++),3e4);setTimeout((function(){e.lastConnection&&e.connect(e.lastConnection)}),r)}else w.h.dispatch((0,P.Cr)({content:"basic-alert",props:{title:"Looks like there are some connection issues. Please try again later.",message:"reason"in t?t.reason:"Connection lost"},noClose:!0}));else this.shouldReconnectOnActive=!0}},{key:"resetReconnectionAttemptsTimeout",value:function(){this.resetConnectionAttempts&&clearTimeout(this.resetConnectionAttempts)}},{key:"bucketUpdate",value:function(t){this.bucketFlow.push(t)}},{key:"switchRegionUpdate",value:function(t){this.newRegionFlow.push(t)}},{key:"roomUpdate",value:function(t){var e,r,n,o,i;if(Q.u.getSessionHash()){if((null===(e=this.room)||void 0===e?void 0:e.roomId)!==t.room.roomId&&this.lastConnection){var a=new URL(window.location.href),u="".concat(this.lastConnection.regionCode).concat(t.room.roomId);a.searchParams.set("room",u),window.history.replaceState({},"room_code",a.toString())}this.readyToEnter=!0;var c="in-game"===(null===(r=t.room)||void 0===r?void 0:r.state),s=null===(n=this.room)||void 0===n||null===(n=n.preload)||void 0===n?void 0:n.gameId,l=null===(o=t.room)||void 0===o||null===(o=o.preload)||void 0===o?void 0:o.gameId;if(l&&s!==l&&w.h.dispatch((0,qr.dX)(!0)),c){var f=t.room.preload;f&&Ph.setGameConfigurations(f)}else this.canEnterGame=!1,w.h.dispatch((0,P.wE)(void 0));c||t.room.preload||w.h.dispatch((0,qr.dX)(!1)),this.roomFlow.push(t.room),w.h.dispatch((0,Xr.tu)(t.room)),this.room=t.room,null===(i=this.roomResolve)||void 0===i||i.call(this)}}},{key:"gameConnect",value:function(t){t.gameId!==Zf.game.getLastGameId()&&(this.canEnterGame=!0,w.h.dispatch((0,P.wE)(t)),this.attemptToEnterGame())}},{key:"attemptToEnterGame",value:(n=nn(en().mark((function t(){var e,r,n,o,i,a;return en().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.awaitRoom;case 2:if(this.room){t.next=4;break}throw new Error("Room is undefined");case 4:if(e=Q.u.getSessionHash()){t.next=7;break}return t.abrupt("return",!1);case 7:if(!(this.readyToEnter&&this.canEnterGame||(0,$.GV)())){t.next=28;break}if(Oh.trackEvent("MatchFound",{lobbySize:Object.values(this.room.players).length,gameType:this.room.gameType,gameId:null!==(r=null===(n=this.room.preload)||void 0===n?void 0:n.gameId)&&void 0!==r?r:"",carSku:null===(o=this.room.players[e].config)||void 0===o||null===(o=o.car)||void 0===o?void 0:o.sku,roomId:Zf.region.roomCode}),w.h.dispatch((0,qr.dX)(!1)),w.h.dispatch((0,qr.SY)(null!==(i=null===(a=this.room.preload)||void 0===a?void 0:a.mapId)&&void 0!==i?i:0)),Xf.fadeToStop(),"time-trials-test"!==$.oJ){t.next=17;break}return w.h.dispatch((0,P.aq)("TIME-TRIALS")),t.abrupt("return",!0);case 17:if("grand-prix-test"!==$.oJ){t.next=20;break}return w.h.dispatch((0,P.aq)("GRAND-PRIX")),t.abrupt("return",!0);case 20:t.t0=this.room.gameType,t.next="GrandPrix"===t.t0?23:"TimeTrial"===t.t0?25:27;break;case 23:return w.h.dispatch((0,P.aq)("GRAND-PRIX")),t.abrupt("break",27);case 25:return w.h.dispatch((0,P.aq)("TIME-TRIALS")),t.abrupt("break",27);case 27:return t.abrupt("return",!0);case 28:return t.abrupt("return",!1);case 29:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"sessionUpdate",value:function(t){Ph.updatePlayerUserId(t.shash),Q.u.setSessionInfo(t.sid,t.shash)}},{key:"chatroomUpdate",value:function(t){w.h.dispatch((0,P.Hz)(t))}},{key:"gameLoaded",value:function(){this.readyToEnter=!0,this.attemptToEnterGame()}},{key:"ready",value:function(t){this.send(JSON.stringify({event:"readyStatus",data:{ready:t}}))}},{key:"updateDiscordId",value:function(t){this.send(JSON.stringify({event:"updateDiscordId",data:{discordId:t}}))}},{key:"updateConfig",value:function(t){this.send(JSON.stringify({event:"updateConfig",data:t}))}},{key:"changeGameType",value:function(t){this.send(JSON.stringify({event:"changeGameType",data:{gameType:t}}))}},{key:"changeMap",value:function(t){this.send(JSON.stringify({event:"changeMap",data:{map:t}}))}},{key:"kickPlayer",value:function(t){this.send(JSON.stringify({event:"kickPlayer",data:{id:t}}))}},{key:"hostCommand",value:function(t){this.send(JSON.stringify({event:"hostCommand",data:t}))}},{key:"spectateRequest",value:function(t){this.send(JSON.stringify({event:"requestSpectate",data:{gameId:t}}))}},{key:"activityUpdate",value:function(t){this.send(JSON.stringify({event:"activityUpdate",data:{active:t}}))}},{key:"message",value:function(t,e){this.send(JSON.stringify({event:"chatroomMessage",data:{type:t,message:e,time:Date.now()}}))}},{key:"regionUpdate",value:function(t,e){this.send(JSON.stringify({event:"updateRegion",data:{region:t,connectionId:e}}))}},{key:"ping",value:function(){this.send(JSON.stringify({event:"ping",data:{}}))}},{key:"sendPhysicsStateUpdate",value:function(t){this.send(t)}},{key:"send",value:function(t){this.ws&&this.ws.readyState===this.ws.OPEN?this.ws.send(t):this.buffer.push(t)}}],e&&on(t.prototype,e),r&&on(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}(),sn=r(99648);var ln=r(7142),fn=r(3771),hn=r(87141);function pn(t){return pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pn(t)}function yn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vn(n.key),n)}}function dn(t,e,r){return(e=vn(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vn(t){var e=function(t,e){if("object"!=pn(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=pn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==pn(e)?e:e+""}var mn=150,bn=100,gn=.1,wn=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),dn(this,"incomingMessage",new Kr.Z),dn(this,"outgoingMessage",new Kr.Z),dn(this,"timeouts",{})},(e=[{key:"received",value:function(t){var e=this;this.throttle((function(){e.incomingMessage.push(t)}))}},{key:"send",value:function(t){var e=this;this.throttle((function(){e.outgoingMessage.push(t)}))}},{key:"throttle",value:function(t){var e=this;if(!(Math.random()<gn)){var r=Math.random()*bn-bn/2,n=Math.max(mn+r,0),o=setTimeout((function(){delete e.timeouts[o.toString()],t()}),n);this.timeouts[o.toString()]=o}}},{key:"clear",value:function(){Object.values(this.timeouts).forEach((function(t){return clearTimeout(t)})),this.timeouts={}}}])&&yn(t.prototype,e),r&&yn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Sn(t){return Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sn(t)}function xn(){xn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==Sn(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Sn(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function On(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Pn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){On(i,n,o,a,u,"next",t)}function u(t){On(i,n,o,a,u,"throw",t)}a(void 0)}))}}function En(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,kn(n.key),n)}}function jn(t,e,r){return(e=kn(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kn(t){var e=function(t,e){if("object"!=Sn(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Sn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Sn(e)?e:e+""}var Tn=function(){return t=function t(e){var r=this;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.signaler=e,jn(this,"pc",void 0),jn(this,"dataChannel",void 0),jn(this,"iceCandidateBuffer",[]),jn(this,"remoteDescriptionSet",!1),jn(this,"connectionStateListener",new Kr.Z),jn(this,"incomingMessageListener",new Kr.Z),jn(this,"websocketDisposers",[]),jn(this,"throttler",void 0),RTCPeerConnection&&!O.vU){this.pc=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]});var n=this.signaler.connectionStateListener.addListener((function(t){if("CONNECTED"===t){var e;if("open"===(null===(e=r.dataChannel)||void 0===e?void 0:e.readyState))return;r.createOffer()}else"DISCONNECTED"===t&&r.close()})),o=this.signaler.incomingMessageListener.addListener(this.handleSignalMessage.bind(this));this.websocketDisposers=[n,o],$.P6&&(this.throttler=new wn,this.throttler.incomingMessage.addListener((function(t){r.incomingMessageListener.push(t)})),this.throttler.outgoingMessage.addListener((function(t){var e;r.dataChannel&&"open"===(null===(e=r.dataChannel)||void 0===e?void 0:e.readyState)&&r.dataChannel.send(t)})))}},e=[{key:"handleSignalMessage",value:(o=Pn(xn().mark((function t(e){var r,n,o,i,a,u,c=this;return xn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,"string"==typeof e.data){t.next=3;break}return t.abrupt("return");case 3:"signal"===(r=JSON.parse(e.data)).type&&("answer"===(n=r.data).type?(i=new RTCSessionDescription({type:"answer",sdp:n.payload}),null===(o=this.pc)||void 0===o||o.setRemoteDescription(i),this.remoteDescriptionSet=!0,this.iceCandidateBuffer.forEach((function(t){var e;null===(e=c.pc)||void 0===e||e.addIceCandidate(t).catch(console.error)}))):"candidate"===n.type&&(a=new RTCIceCandidate(n.payload),this.remoteDescriptionSet?null===(u=this.pc)||void 0===u||u.addIceCandidate(a).catch(console.error):this.iceCandidateBuffer.push(a))),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return o.apply(this,arguments)})},{key:"createOffer",value:(n=Pn(xn().mark((function t(){var e,r;return xn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.pc){t.next=2;break}return t.abrupt("return");case 2:e={ordered:!1,maxRetransmits:0},this.dataChannel=this.pc.createDataChannel("dc",e),this.setUpDataChannelListeners(this.dataChannel),r={offerToReceiveAudio:!1,offerToReceiveVideo:!1},this.pc.onicecandidate=this.onIceCandidate.bind(this),this.pc.createOffer(this.onOfferCreated.bind(this),this.onOfferFailed.bind(this),r),this.pc.onsignalingstatechange=this.onConnectionStateChange.bind(this),this.pc.onconnectionstatechange=this.onConnectionStateChange.bind(this),this.pc.ondatachannel=this.onDataChannelReceived.bind(this);case 11:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"onConnectionStateChange",value:function(){this.pc&&("connected"===this.pc.connectionState?this.connectionStateListener.push("CONNECTED"):("disconnected"===this.pc.connectionState||"failed"===this.pc.connectionState)&&this.connectionStateListener.push("DISCONNECTED"))}},{key:"onDataChannelReceived",value:function(t){this.setUpDataChannelListeners(t.channel)}},{key:"setUpDataChannelListeners",value:function(t){t.onmessage=this.onDataChannelMessage.bind(this),t.onopen=this.onDataChannelOpen.bind(this)}},{key:"onDataChannelMessage",value:function(t){this.throttler?this.throttler.received(t):this.incomingMessageListener.push(t)}},{key:"onDataChannelOpen",value:function(){console.log("Data channel opened")}},{key:"onIceCandidate",value:function(t){t&&t.candidate&&this.signaler.send(JSON.stringify({type:"signal",data:{type:"candidate",payload:t.candidate}}))}},{key:"onOfferCreated",value:function(t){this.pc&&(this.pc.setLocalDescription(t),this.signaler.send(JSON.stringify({type:"signal",data:{type:"offer",payload:t}})))}},{key:"onOfferFailed",value:function(t){console.error("Offer failed",t)}},{key:"send",value:function(t){var e;this.dataChannel&&"open"===(null===(e=this.dataChannel)||void 0===e?void 0:e.readyState)&&(this.throttler?this.throttler.send(t):this.dataChannel.send(t))}},{key:"close",value:function(){var t,e;this.dataChannel&&(this.dataChannel.onopen=void 0,this.dataChannel.onmessage=void 0,this.dataChannel.close()),null===(t=this.pc)||void 0===t||t.close(),null===(e=this.throttler)||void 0===e||e.clear(),this.websocketDisposers.forEach((function(t){return t()}))}}],e&&En(t.prototype,e),r&&En(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function _n(t){return _n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_n(t)}function Ln(){Ln=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==_n(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(_n(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function In(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Cn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Mn(n.key),n)}}function An(t,e,r){return(e=Mn(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mn(t){var e=function(t,e){if("object"!=_n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_n(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_n(e)?e:e+""}var Rn=(0,$.GV)()||"menu-test"===$.oJ?"ws":"wss",Nn=function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),An(this,"ws",void 0),An(this,"buffer",void 0),An(this,"connectionStateListener",new Kr.Z),An(this,"incomingMessageListener",new Kr.Z),An(this,"onopen",(function(t){var r=e.buffer;e.buffer=[],r.forEach((function(t){var r;null===(r=e.ws)||void 0===r||r.send(t)})),e.connectionStateListener.push("CONNECTED")})),An(this,"onerror",(function(t){console.error(t)})),An(this,"onclose",(function(t){e.buffer=[],"100"===t.reason?e.connectionStateListener.push("SERVER_FULL"):"101"===t.reason?e.connectionStateListener.push("KICKED"):"200"===t.reason||"201"===t.reason?e.connectionStateListener.push("DISCONNECTED"):e.connectionStateListener.push("ERROR")})),An(this,"onmessage",function(){var t,r=(t=Ln().mark((function t(r){return Ln().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.incomingMessageListener.push(r);case 1:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){In(i,n,o,a,u,"next",t)}function u(t){In(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t){return r.apply(this,arguments)}}()),this.buffer=[]},(e=[{key:"connect",value:function(t){if(this.ws&&this.ws.readyState===this.ws.OPEN&&this.close(),!("WebSocket"in window))throw new Error("Your browser does not support websocket");this.ws=new WebSocket("".concat(Rn,"://").concat(Zf.getRegionHost(),"/game/").concat(t.gameName,"/").concat(Q.u.getSessionHash(),"/").concat(t.key)),this.ws.onclose=this.onclose,this.ws.onopen=this.onopen,this.ws.onerror=this.onerror,this.ws.onmessage=this.onmessage}},{key:"send",value:function(t){this.ws&&this.ws.readyState===this.ws.OPEN?this.ws.send(t):this.buffer.push(t)}},{key:"close",value:function(){this.ws&&(this.ws.onclose=F.Z,this.ws.onopen=F.Z,this.ws.onerror=F.Z,this.ws.onmessage=F.Z,this.ws.close(1e3,"201"),this.ws=void 0)}},{key:"isConnected",value:function(){return this.ws&&this.ws.readyState===this.ws.OPEN}}])&&Cn(t.prototype,e),r&&Cn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),Dn=r(61201),Bn=r(8987);function Fn(t){return Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fn(t)}function Gn(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=zn(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function Un(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||zn(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zn(t,e){if(t){if("string"==typeof t)return Wn(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Wn(t,e):void 0}}function Wn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Vn(){Vn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==Fn(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Fn(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Hn(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function qn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Hn(i,n,o,a,u,"next",t)}function u(t){Hn(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Xn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Yn(n.key),n)}}function Kn(t,e,r){return(e=Yn(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yn(t){var e=function(t,e){if("object"!=Fn(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Fn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Fn(e)?e:e+""}var Jn=function(t){return t[t.KEY_UPDATE=0]="KEY_UPDATE",t[t.ENTER_GAME=1]="ENTER_GAME",t[t.ENTER_SPECTATE=2]="ENTER_SPECTATE",t[t.READY_UP=3]="READY_UP",t[t.USER_DATA=4]="USER_DATA",t[t.RESET=5]="RESET",t}(Jn||{}),Zn=function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Kn(this,"incomingBuffer",void 0),Kn(this,"outgoingBuffer",void 0),Kn(this,"gameWebsocket",void 0),Kn(this,"gameWRTC",void 0),Kn(this,"gameId",void 0),Kn(this,"results",void 0),Kn(this,"endGame",void 0),Kn(this,"rttBuffer",void 0),Kn(this,"pingUpdateCounter",void 0),Kn(this,"latestPings",void 0),Kn(this,"pingCounterElement",void 0),Kn(this,"lastFrame",void 0),Kn(this,"lastTick",void 0),Kn(this,"MsPerTick",1e3/zf.getTickRate()),Kn(this,"rtcConnected",void 0),Kn(this,"wrtcListeners",void 0),Kn(this,"focusListener",void 0),Kn(this,"inputPacketSize",void 0),this.outgoingBuffer=[],this.incomingBuffer=[],this.rttBuffer=[],this.latestPings=new Float32Array(10),this.pingUpdateCounter=0,this.lastFrame=-1,this.lastTick=-1,this.wrtcListeners=[],this.inputPacketSize=zf.getSizeOfInputArray(),this.rtcConnected=!1,this.gameWebsocket=new Nn,this.gameWebsocket.connectionStateListener.addListener((function(t){console.log("Game Websocket State",t),"DISCONNECTED"===t?e.serverDisconnect():"KICKED"===t?e.kicked():"SERVER_FULL"===t?e.serverFull():"ERROR"===t?e.serverError():"CONNECTED"===t&&e.setSmartSteering(qf.gameplay.smartSteering)})),this.gameWebsocket.incomingMessageListener.addListener(function(){var t=qn(Vn().mark((function t(r){return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r.data instanceof Blob)){t.next=8;break}return t.t0=e,t.t1=DataView,t.next=5,r.data.arrayBuffer();case 5:t.t2=t.sent,t.t3=new t.t1(t.t2),t.t0.handleIncomingEvent.call(t.t0,t.t3);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.pingCounterElement=document.getElementById("ping-counter"),this.results=new Kr.Z,this.endGame=new Kr.Z},e=[{key:"connect",value:function(t){var e=this;this.gameId=t.gameId,this.pingCounterElement=document.getElementById("ping-counter"),this.gameWRTC=new Tn(this.gameWebsocket);var r=this.gameWRTC.connectionStateListener.addListener((function(t){"CONNECTED"===t?e.rtcConnected=!0:"DISCONNECTED"===t&&(e.rtcConnected=!1)})),n=this.gameWRTC.incomingMessageListener.addListener(function(){var t=qn(Vn().mark((function t(r){return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r.data instanceof ArrayBuffer&&e.handleIncomingEvent(new DataView(r.data));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());this.wrtcListeners=[r,n],this.gameWebsocket.connect(t)}},{key:"kicked",value:function(){(0,Bn.c)("GameConnectionHandler: Kicked from server"),console.error("GameConnectionHandler: Kicked from server"),this.stop(),w.h.dispatch((0,P.aq)("MAIN-MENU")),w.h.dispatch((0,P.Cr)({content:"basic-alert",props:{title:"Server Message",message:"You've been kicked for inactivity."}}))}},{key:"serverFull",value:function(){(0,Bn.c)("GameConnectionHandler: Can't connect to server, server is full"),console.error("GameConnectionHandler: Can't connect to server, server is full"),this.stop(),w.h.dispatch((0,P.aq)("MAIN-MENU")),w.h.dispatch((0,P.Cr)({content:"basic-alert",props:{title:"Server Message",message:"The server is full. Try again later."}}))}},{key:"serverDisconnect",value:function(){this.stop(),this.endGame.push("ENDGAME")}},{key:"serverError",value:function(){console.error("GameConnectionHandler: Server error"),this.stop(),this.endGame.push("ERROR"),w.h.dispatch((0,P.aq)("MAIN-MENU")),w.h.dispatch((0,P.Cr)({content:"basic-alert",props:{title:"Server Message",message:"There was an unknown server error. Try again later."}}))}},{key:"networkTick",value:function(t,e){this.lastFrame=bh.register(this.networkTick.bind(this)),this.internalTick(e)}},{key:"run",value:function(){var t=this;this.outgoingBuffer=[],this.lastFrame=bh.register(this.networkTick.bind(this)),this.focusListener=function(){t.flushNetworkBuffer()},window.addEventListener("focus",this.focusListener.bind(this))}},{key:"stop",value:function(){var t,e;this.outgoingBuffer=[],this.incomingBuffer=[],this.rttBuffer=[],bh.cancel(this.lastFrame),this.sendLeave(),this.gameWebsocket.close(),null===(t=this.gameWRTC)||void 0===t||t.close(),this.gameWRTC=void 0,this.gameId=void 0,this.wrtcListeners.forEach((function(t){return t()})),this.wrtcListeners=[],this.focusListener&&window.removeEventListener("focus",null===(e=this.focusListener)||void 0===e?void 0:e.bind(this))}},{key:"addOutgoingEvent",value:function(t,e){this.outgoingBuffer.push({time:new Uf.Time,frameNumber:t,input:e})}},{key:"getWorldUpdates",value:function(){var t=this.incomingBuffer;return this.incomingBuffer=[],t}},{key:"getLastGameId",value:function(){return this.gameId}},{key:"isConnected",value:function(){return this.gameWebsocket.isConnected()}},{key:"calculateRTT",value:function(t,e){for(var r=0,n=Object.entries(this.rttBuffer);r<n.length;r++){var o=Un(n[r],2),i=o[0],a=o[1];if(parseInt(i)===t){if(this.pingUpdateCounter++,this.latestPings[this.pingUpdateCounter%10]=e-a,this.pingCounterElement&&this.pingUpdateCounter%10==0){var u=Math.floor((0,ln.Y)(this.latestPings)/2);this.pingCounterElement.textContent="".concat(u," ms")}break}}for(var c=Object.entries(this.rttBuffer);c.length>50;){var s=c.shift();if(!s)return;delete this.rttBuffer[parseInt(s[0])]}}},{key:"internalTick",value:function(t){var e=Math.floor(t/this.MsPerTick/3);e>this.lastTick&&(this.networkUpdate(),this.lastTick=e)}},{key:"handleIncomingEvent",value:function(t){var e=t.getInt8(0);switch(e){case 0:this.handleWorldUpdate(t);break;case 1:this.handleUserIdUpdate(t);break;case 2:this.handleGameResultsUpdate(t);break;case 4:this.handleTimeTrialsUpdate(t);break;case 5:this.handleGrandPrixUpdate(t);break;case 6:this.handlePingUpdate(t);break;default:console.error("Unknown command id",e)}}},{key:"handlePingUpdate",value:function(t){var e=function(t){var e=(0,sn.h)(new Uint8Array(t.buffer));return new Uf.PingViewer(e,t.byteLength)}(t),r=e.getPingId();this.gameWebsocket.send(JSON.stringify({type:"ping",data:{pingId:r}}))}},{key:"handleGameResultsUpdate",value:function(t){var e=this,r=function(t){var e=(0,sn.h)(new Uint8Array(t.buffer));return new Uf.GameResultsViewer(e,t.byteLength)}(t),n=Q.u.getUserId();w.h.dispatch((0,Dn.__)(!0)),r.isTempUser()&&(Ph.updatePlayerUserId(r.getTempUserId()),rh.driftAuth.login({id:r.getTempUserId(),key:r.getTempUserKey()}),n=r.getTempUserId()),rh.game.getGameResults(r.getGameType(),r.getGameId(),n).then((function(t){t&&e.results.push(t)}))}},{key:"handleGrandPrixUpdate",value:function(t){if(Jf instanceof hn.v){Jf.state.gameStarted=!0;for(var e=function(t){var e=(0,sn.h)(new Uint8Array(t.buffer));return new Uf.GrandPrixViewer(e,t.byteLength)}(t),r=e.getPlayerCount(),n={},o=0;o<r;o++){var i=e.getUserId(o),a={id:Ph.getClientId(i),serverId:i,placement:e.getPlacement(o),lap:e.getLap(o),finished:e.getFinished(o),disconnected:e.getDisconnected(o)};n[a.serverId]=a}Jf.state.players=n,Jf.state.roundTime=e.getRoundTime(),Jf.state.maxLaps=e.getMaxLaps(),Jf.state.showResults=e.showResults(),Uf.destroy(e)}}},{key:"handleUserIdUpdate",value:function(t){for(var e=function(t){var e=(0,sn.h)(new Uint8Array(t.buffer));return new Uf.UserIdViewer(e,t.byteLength)}(t),r=e.getPlayerCount(),n=[],o=0;o<r;o++)n.push({client:e.getBroadcastId(o),server:e.getGameId(o)});Uf.destroy(e),Ph.setIds(n)}},{key:"handleTimeTrialsUpdate",value:function(t){if(Jf instanceof fn._){var e=function(t){var e=(0,sn.h)(new Uint8Array(t.buffer));return new Uf.TimeTrialsViewer(e,t.byteLength)}(t);Jf.state.time=e.getTime(),Jf.state.ended=e.hasEnded();for(var r=[],n=0;n<e.getNumLaps();n++)r[n]=e.getLapTime(n);Jf.state.lapTimes=r}}},{key:"handleWorldUpdate",value:function(t){this.incomingBuffer.push(t)}},{key:"networkUpdate",value:function(){if(0!=this.outgoingBuffer.length){var t=Float32Array.BYTES_PER_ELEMENT,e=this.outgoingBuffer.length*(this.inputPacketSize+2+1)+1,r=new ArrayBuffer(e*t),n=new DataView(r);n.setFloat32(0,Jn.KEY_UPDATE,!0);var o,i=1,a=Gn(this.outgoingBuffer);try{for(a.s();!(o=a.n()).done;){var u=o.value;this.addToRttBuffer(u.frameNumber),n.setUint32(i++*t,u.time.high(),!0),n.setUint32(i++*t,u.time.low(),!0),n.setFloat32(i++*t,u.frameNumber,!0);var c,s=Gn(u.input);try{for(s.s();!(c=s.n()).done;){var l=c.value;n.setFloat32(i++*t,l,!0)}}catch(t){s.e(t)}finally{s.f()}}}catch(t){a.e(t)}finally{a.f()}for(this.sendInput(n.buffer);this.outgoingBuffer.length>20;){var f=this.outgoingBuffer.shift();if(!f)return;Uf.destroy(null==f?void 0:f.time)}}else this.outgoingBuffer=[]}},{key:"addToRttBuffer",value:function(t){this.rttBuffer[t]||(this.rttBuffer[t]=(new Date).getTime())}},{key:"sendInput",value:function(t){var e;this.rtcConnected&&this.gameWRTC?null===(e=this.gameWRTC)||void 0===e||e.send(t):this.gameWebsocket.send(t)}},{key:"sendReset",value:function(){this.gameWebsocket.send(JSON.stringify({type:"reset"}))}},{key:"flushNetworkBuffer",value:function(){this.gameWebsocket.send(JSON.stringify({type:"flushBuffer"}))}},{key:"sendLeave",value:function(){this.gameWebsocket.isConnected()&&this.gameWebsocket.send(JSON.stringify({type:"leave"}))}},{key:"setSmartSteering",value:function(t){this.gameWebsocket.send(JSON.stringify({type:"smartSteering",data:{enabled:t}}))}}],e&&Xn(t.prototype,e),r&&Xn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),Qn=r(73002),$n=r(75203);function to(t){return to="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},to(t)}function eo(){eo=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==to(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(to(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function ro(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function no(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ro(i,n,o,a,u,"next",t)}function u(t){ro(i,n,o,a,u,"throw",t)}a(void 0)}))}}function oo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ao(n.key),n)}}function io(t,e,r){return(e=ao(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ao(t){var e=function(t,e){if("object"!=to(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=to(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==to(e)?e:e+""}var uo=function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),io(this,"isInitial",!0),io(this,"regionHost",void 0),io(this,"game",void 0),io(this,"region",void 0),io(this,"broadcast",void 0),io(this,"closeRequestNewTicket",void 0),io(this,"closeNewRegionFlow",void 0),this.game=new Zn,this.region=new Qn.O,this.broadcast=new cn,this.closeRequestNewTicket=this.broadcast.requestNewTicket.addListener(function(){var t=no(eo().mark((function t(r){return eo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r&&e.connectToBroadcastServer();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.closeNewRegionFlow=this.broadcast.newRegionFlow.addListener(function(){var t=no(eo().mark((function t(r){return eo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.connectToBroadcastServer(r);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},e=[{key:"init",value:(c=no(eo().mark((function t(){var e=this;return eo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.isInitial=!0,t.next=3,new Promise((function(t){rh.init(function(){var r=no(eo().mark((function r(n){return eo().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return Q.u.setFirebaseProfile(n),w.h.dispatch((0,P.ck)(n)),n&&void 0===n.lastUsernameUpdate&&!n.isTemporary&&w.h.dispatch((0,P.hB)(!0)),n&&void 0===n.trackingId&&rh.updateTrackingId(Q.u.getTrackingId()).then((function(t){Q.u.setFirebaseProfile(t)})),r.next=8,e.connectToBroadcastServer();case 8:e.game.isConnected()||w.h.dispatch((0,P.jY)()),w.h.dispatch((0,P.dF)(!0)),e.sendSpectateRequest(),t();case 12:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}())}));case 3:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"refreshConnection",value:(u=no(eo().mark((function t(){return eo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.connectToBroadcastServer();case 2:this.game.isConnected()||w.h.dispatch((0,P.jY)());case 3:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"refreshPlayerConfig",value:function(){var t;this.broadcast.updateConfig({config:{defaultCar:(0,$.GV)()?0:null!==(t=mh.data.cosmetics.defaultCar)&&void 0!==t?t:0}})}},{key:"getRegionHost",value:function(){return(0,$.GV)()?"localhost:8090":this.regionHost}},{key:"switchRegion",value:(a=no(eo().mark((function t(e){var r,n;return eo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.region.setSessionRegion(e);case 2:return n=null!==(r=this.specialConnectionId())&&void 0!==r?r:(0,$n.Z)(),this.broadcast.regionUpdate(e,n),t.next=6,this.connectToBroadcastServer({region:e,connectionId:n});case 6:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"connectToBroadcastServer",value:(i=no(eo().mark((function t(e){var r,n,o,i,a,u;return eo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=null==e?void 0:e.region,t.next=3,this.region.getConnectionInfo(n);case 3:return o=t.sent,i=null!==(r=this.specialConnectionId())&&void 0!==r?r:null==e?void 0:e.connectionId,this.regionHost=o.host,t.next=8,this.broadcast.connect({host:o.host,regionCode:o.region,roomCode:o.roomCode,specialConnectionId:i});case 8:return $f.is("discord")&&(u=null===(a=$f.getCurrentUser())||void 0===a?void 0:a.id)&&this.broadcast.updateDiscordId(u),t.next=11,this.broadcast.awaitRoom;case 11:this.refreshPlayerConfig();case 12:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"specialConnectionId",value:function(){if($f.is("discord"))return $f.getConnectionId()}},{key:"sendSpectateRequest",value:(o=no(eo().mark((function t(){var e,r,n;return eo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getGameIdData();case 2:if(e=t.sent){t.next=5;break}return t.abrupt("return");case 5:if(r=e.gameId,(n=e.region)===this.region.getRegion()){t.next=9;break}return t.next=9,this.switchRegion(n);case 9:this.broadcast.spectateRequest(r);case 10:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"getGameIdData",value:(n=no(eo().mark((function t(){var e,r,n,o;return eo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!yh.is("poki")){t.next=2;break}return t.abrupt("return",void 0);case 2:if(r=new URL(window.location.href),n=null!==(e=r.searchParams.get("game_id"))&&void 0!==e?e:void 0){t.next=6;break}return t.abrupt("return",void 0);case 6:if(2===(o=n.split(":")).length){t.next=9;break}return t.abrupt("return",void 0);case 9:return t.abrupt("return",{gameId:o[1],region:o[0]});case 10:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"getFullRoomCode",value:function(){var t,e;if(null!==(t=this.broadcast.room)&&void 0!==t&&t.roomId&&this.region.getRegion())return"".concat(this.region.getRegion()).concat(null===(e=this.broadcast.room)||void 0===e?void 0:e.roomId)}},{key:"dispose",value:function(){this.closeRequestNewTicket(),this.closeNewRegionFlow()}}],e&&oo(t.prototype,e),r&&oo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,u,c}(),co=r(3406),so=r(91361),lo=r(5071),fo=r(10745);function ho(t){return ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ho(t)}function po(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yo(n.key),n)}}function yo(t){var e=function(t,e){if("object"!=ho(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ho(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ho(e)?e:e+""}var vo=function(){return t=function t(){var e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,r="_orientation",n=new lo.P,(r=yo(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n},e=[{key:"playIdAtPosition",value:function(t,e,r){var n,o=this;null===(n=Hf.positionalAudio[t])||void 0===n||n.then((function(t){o.playAtPosition(t(),e,r)}))}},{key:"playAtPosition",value:function(t,e,r){Qf.scene.add(t),(0,fo.D)(t,e,r),t.onEnded=function(){Qf.scene.remove(t)},t.play()}}],e&&po(t.prototype,e),r&&po(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function mo(t,e){for(var r=e;t>1;t--)r+=e;return r}var bo="data:audio/mpeg;base64,//uQx"+mo(23,"A")+"WGluZwAAAA8AAAACAAACcQCA"+mo(16,"gICA")+mo(66,"/")+"8AAABhTEFNRTMuMTAwA8MAAAAAAAAAABQgJAUHQQAB9AAAAnGMHkkI"+mo(320,"A")+"//sQxAADgnABGiAAQBCqgCRMAAgEAH"+mo(15,"/")+"7+n/9FTuQsQH//////2NG0jWUGlio5gLQTOtIoeR2WX////X4s9Atb/JRVCbBUpeRUq"+mo(18,"/")+"9RUi0f2jn/+xDECgPCjAEQAABN4AAANIAAAAQVTEFNRTMuMTAw"+mo(97,"V")+"Q==";function go(t){return go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},go(t)}function wo(){wo=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==go(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(go(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function So(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function xo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Po(n.key),n)}}function Oo(t,e,r){return(e=Po(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Po(t){var e=function(t,e){if("object"!=go(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=go(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==go(e)?e:e+""}var Eo=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Oo(this,"context",void 0),Oo(this,"allowPlayback",!0),Oo(this,"mediaPlaybackEventOccurred",!1),Oo(this,"firstInteraction",!1),Oo(this,"addedMediaPlaybackListeners",!1),Oo(this,"channelTag",null),Oo(this,"boundWindowMediaPlayback",void 0),Oo(this,"boundDocumentVisibilityChange",void 0),Oo(this,"boundWindowFocusChange",void 0),Oo(this,"boundContextStateChange",void 0),Oo(this,"positional",void 0),this.positional=new vo,this.context=co.H.getContext(),this.boundWindowMediaPlayback=this.windowMediaPlayback.bind(this),this.boundDocumentVisibilityChange=this.documentVisibilityChange.bind(this),this.boundWindowFocusChange=this.windowFocusChange.bind(this),this.boundContextStateChange=this.contextStateChange.bind(this),document.addEventListener("visibilitychange",this.boundDocumentVisibilityChange,{capture:!0,passive:!0}),O.gn&&(window.addEventListener("focus",this.boundWindowFocusChange,!0),window.addEventListener("blur",this.boundWindowFocusChange,!0)),this.context.addEventListener("statechange",this.boundContextStateChange),this.addMediaPlaybackListeners()},e=[{key:"documentVisibilityChange",value:function(){this.updatePlaybackState()}},{key:"windowFocusChange",value:function(t){t&&t.target!==window||this.updatePlaybackState()}},{key:"contextStateChange",value:function(){this.updateContextState()}},{key:"updatePlaybackState",value:function(){var t=!O.tq||!document.hidden;t!==this.allowPlayback&&(this.allowPlayback=t,this.updateChannelState(!1),this.updateContextState()),t&&this.addMediaPlaybackListeners()}},{key:"updateContextState",value:function(){if(this.allowPlayback){if("running"!==this.context.state&&"closed"!==this.context.state&&this.mediaPlaybackEventOccurred){var t=this.context.resume();t&&t.then(F.Z,F.Z).catch(F.Z)}}else if("running"===this.context.state){var e=this.context.suspend();e&&e.then(F.Z,F.Z).catch(F.Z)}}},{key:"playId",value:(n=wo().mark((function t(e){var r,n,o,i=arguments;return wo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},t.next=3,Hf.audio[e];case 3:if((n=t.sent).buffer){t.next=6;break}return t.abrupt("return");case 6:return o=new s.B(Qf.audioListener).setBuffer(n.buffer),r.volume&&o.setVolume(r.volume),r.detune&&(o.detune=r.detune),r.playbackRate&&o.setPlaybackRate(r.playbackRate),o.play(),t.abrupt("return",o);case 12:case"end":return t.stop()}}),t)})),o=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){So(i,r,o,a,u,"next",t)}function u(t){So(i,r,o,a,u,"throw",t)}a(void 0)}))},function(t){return o.apply(this,arguments)})},{key:"addMediaPlaybackListeners",value:function(){this.addedMediaPlaybackListeners||(document.addEventListener("click",this.boundWindowMediaPlayback),document.addEventListener("keydown",this.boundWindowMediaPlayback),document.addEventListener("touchstart",this.boundWindowMediaPlayback),document.addEventListener("touchend",this.boundWindowMediaPlayback),this.addedMediaPlaybackListeners=!0)}},{key:"removeMediaPlaybackListeners",value:function(){this.addedMediaPlaybackListeners&&(document.removeEventListener("click",this.boundWindowMediaPlayback),document.removeEventListener("keydown",this.boundWindowMediaPlayback),document.removeEventListener("touchstart",this.boundWindowMediaPlayback),document.removeEventListener("touchend",this.boundWindowMediaPlayback),this.addedMediaPlaybackListeners=!1)}},{key:"windowMediaPlayback",value:function(){this.mediaPlaybackEventOccurred=!0,this.updateChannelState(!0),this.updateContextState(),this.firstInteraction||(this.firstInteraction=!0,Xf.radio.init(),Qf.audioListener.setMasterVolume(qf.audio.master*qf.audio.sfx*so.B5)),this.removeMediaPlaybackListeners()}},{key:"updateChannelState",value:function(t){if(O.gn)if(this.allowPlayback){if(t){if(!this.channelTag){var e=document.createElement("div");e.innerHTML="<audio x-webkit-airplay='deny'></audio>",this.channelTag=e.children.item(0),this.channelTag.controls=!1,this.channelTag.disableRemotePlayback=!0,this.channelTag.preload="auto",this.channelTag.src=bo,this.channelTag.loop=!0,this.channelTag.load()}if(this.channelTag.paused){var r=this.channelTag.play();r&&r.then(F.Z,this.destroyChannelTag).catch(this.destroyChannelTag)}}}else this.destroyChannelTag()}},{key:"destroyChannelTag",value:function(){this.channelTag&&(this.channelTag.src="about:blank",this.channelTag.load(),this.channelTag=null)}}],e&&xo(t.prototype,e),r&&xo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function jo(t){return jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jo(t)}function ko(){var t,e=window.location.hostname,r=document.createElement("script"),n=document.getElementsByTagName("script")[0],o="https://cmp.quantcast.com".concat("/choice/","Z9c4UC4Kb_2SN","/",e,"/choice.js?tag_version=V2"),i=0;r.async=!0,r.type="text/javascript",r.src=o,n.parentNode.insertBefore(r,n),function(){for(var e="__tcfapiLocator",r=[],n=window;n;){try{if(n.frames[e]){t=n;break}}catch(t){(0,F.Z)()}if(n===window.top)break;n=n.parent}t||(!function t(){var r=n.document,o=!!n.frames[e];if(!o)if(r.body){var i=r.createElement("iframe");i.style.cssText="display:none",i.name=e,r.body.appendChild(i)}else setTimeout(t,5);return!o}(),n.__tcfapi=function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];if(!n.length)return r;if("setGdprApplies"===n[0])n.length>3&&2===n[2]&&"boolean"==typeof n[3]&&(t=n[3],"function"==typeof n[2]&&(0,n[2])("set",!0));else if("ping"===n[0]){var i={gdprApplies:t,cmpLoaded:!1,cmpStatus:"stub"};"function"==typeof n[2]&&n[2](i)}else"init"===n[0]&&"object"===jo(n[3])&&(n[3]=Object.assign(n[3],{tag_version:"V2"})),r.push(n)},n.addEventListener("message",(function(t){var e="string"==typeof t.data,r={};try{r=e?JSON.parse(t.data):t.data}catch(t){(0,F.Z)()}var n=r.__tcfapiCall;n&&window.__tcfapi(n.command,n.version,(function(r,o){var i={__tcfapiReturn:{returnValue:r,success:o,callId:n.callId}};e&&(i=JSON.stringify(i)),t&&t.source&&t.source.postMessage&&t.source.postMessage(i,"*")}),n.parameter)}),!1))}();var a,u=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];jo(window.__uspapi)!==u&&setTimeout((function(){void 0!==window.__uspapi&&window.__uspapi.apply(window.__uspapi,e)}),500)};void 0===window.__uspapi&&(window.__uspapi=u,a=setInterval((function(){i++,window.__uspapi===u&&i<3?console.warn("USP is not accessible"):clearInterval(a)}),6e3))}function To(t){return To="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},To(t)}function _o(){_o=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==To(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(To(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Lo(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Io(){return Co.apply(this,arguments)}function Co(){var t;return t=_o().mark((function t(){return _o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("dev"!==$.Vi){t.next=2;break}return t.abrupt("return");case 2:"web"===yh.id&&ko();case 3:case"end":return t.stop()}}),t)})),Co=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Lo(i,n,o,a,u,"next",t)}function u(t){Lo(i,n,o,a,u,"throw",t)}a(void 0)}))},Co.apply(this,arguments)}function Ao(t){return Ao="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ao(t)}function Mo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,No(n.key),n)}}function Ro(t,e,r){return(e=No(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function No(t){var e=function(t,e){if("object"!=Ao(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ao(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ao(e)?e:e+""}var Do=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Ro(this,"focused",!0),Ro(this,"hardPaused",!1),Ro(this,"firstInteraction",!1),this.blur=this.blur.bind(this),this.focus=this.focus.bind(this),this.handleInteraction=this.handleInteraction.bind(this),window.addEventListener("blur",this.blur),window.addEventListener("focus",this.focus),window.addEventListener("click",this.handleInteraction,!0),window.addEventListener("touchstart",this.handleInteraction,!0),window.addEventListener("keydown",this.handleInteraction,!0)},(e=[{key:"pause",value:function(){w.h.dispatch((0,qr.I6)(!0)),Yf.resetInputs(),Qf.audioListener.setMasterVolume(0),Xf.muffle(qf.audio.muffleMusicOnPause)}},{key:"hardPause",value:function(){this.hardPaused=!0,this.pause(),Xf.pause(),Xf.setVolume(0)}},{key:"resume",value:function(){(this.focused||O.tq)&&(w.h.dispatch((0,qr.I6)(!1)),Qf.audioListener.setMasterVolume(qf.audio.master*qf.audio.sfx*so.B5),Xf.setVolume(qf.audio.music*qf.audio.master),Xf.muffle(!1),this.hardPaused&&(Xf.play(),this.hardPaused=!1))}},{key:"blur",value:function(){this.focused=!1,$.Eb||this.pause()}},{key:"focus",value:function(){this.focused=!0}},{key:"handleInteraction",value:function(){this.firstInteraction||(this.firstInteraction=!0,w.h.dispatch((0,P.aX)(!0)))}},{key:"destroy",value:function(){window.removeEventListener("blur",this.blur),window.removeEventListener("focus",this.focus),window.removeEventListener("click",this.handleInteraction,!0),window.removeEventListener("touchstart",this.handleInteraction,!0),window.removeEventListener("keydown",this.handleInteraction,!0)}}])&&Mo(t.prototype,e),r&&Mo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),Bo=r(94407),Fo=r(50100),Go=r(65124);function Uo(t){return Uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uo(t)}function zo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Vo(n.key),n)}}function Wo(t,e,r){return(e=Vo(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vo(t){var e=function(t,e){if("object"!=Uo(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Uo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Uo(e)?e:e+""}var Ho=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.interval=e,Wo(this,"frameCount",0),Wo(this,"totalFrames",0),Wo(this,"framesMin",1/0),Wo(this,"framesMax",0),Wo(this,"cpuTimeCount",0),Wo(this,"totalCpuTime",0),Wo(this,"cpuTimeMin",1/0),Wo(this,"cpuTimeMax",0),Wo(this,"physicsTimeCount",0),Wo(this,"totalPhysicsTime",0),Wo(this,"physicsTimeMin",1/0),Wo(this,"physicsTimeMax",0),Wo(this,"gpuTimeCount",0),Wo(this,"totalGpuTime",0),Wo(this,"gpuTimeMin",1/0),Wo(this,"gpuTimeMax",0),Wo(this,"accumulator",0)},(e=[{key:"update",value:function(){this.accumulator++%this.interval==0&&(this.frameCount++,this.totalFrames+=Go.T.latestFps,this.framesMin=Math.min(this.framesMin,Th),this.framesMax=Math.max(this.framesMax,Th),this.cpuTimeCount++,this.totalCpuTime+=Go.T.latestCpuTime,this.cpuTimeMin=Math.min(this.cpuTimeMin,_h),this.cpuTimeMax=Math.max(this.cpuTimeMax,_h),this.physicsTimeCount++,this.totalPhysicsTime+=Go.T.latestPhysicsTime,this.physicsTimeMin=Math.min(this.physicsTimeMin,Lh),this.physicsTimeMax=Math.max(this.physicsTimeMax,Lh),this.gpuTimeCount++,this.totalGpuTime+=Go.T.latestGpuTime,this.gpuTimeMin=Math.min(this.gpuTimeMin,Go.T.latestGpuTime),this.gpuTimeMax=Math.max(this.gpuTimeMax,Go.T.latestGpuTime))}},{key:"getFrameStats",value:function(){return{avg:0===this.frameCount?0:this.totalFrames/this.frameCount,min:this.framesMin,max:this.framesMax}}},{key:"getCpuTimeStats",value:function(){return{avg:0===this.cpuTimeCount?0:this.totalCpuTime/this.cpuTimeCount,min:this.cpuTimeMin,max:this.cpuTimeMax}}},{key:"getPhysicsTimeStats",value:function(){return{avg:0===this.physicsTimeCount?0:this.totalPhysicsTime/this.physicsTimeCount,min:this.physicsTimeMin,max:this.physicsTimeMax}}},{key:"getGpuTimeStats",value:function(){return{avg:0===this.gpuTimeCount?0:this.totalGpuTime/this.gpuTimeCount,min:this.gpuTimeMin,max:this.gpuTimeMax}}}])&&zo(t.prototype,e),r&&zo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function qo(t){return qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qo(t)}function Xo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ko(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Zo(n.key),n)}}function Yo(t,e,r){return e&&Ko(t.prototype,e),r&&Ko(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Jo(t,e,r){return(e=Zo(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zo(t){var e=function(t,e){if("object"!=qo(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=qo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==qo(e)?e:e+""}var Qo=function(){return Yo((function t(e){Xo(this,t),this.visualData=e,Jo(this,"complete",!1),Jo(this,"performance",void 0),Jo(this,"time",0),Jo(this,"step",void 0),this.step=e.step,this.performance=new Ho(20)}),[{key:"update",value:function(t){var e;this.complete||(this.time+=t,null===(e=this.performance)||void 0===e||e.update())}},{key:"updateVisuals",value:function(){w.h.dispatch((0,Dn.fS)(this.visualData))}},{key:"completeStep",value:function(){var t,e,r,n,o,i,a,u,c,s,l,f,h=this.performance.getFrameStats(),p=this.performance.getCpuTimeStats(),y=this.performance.getPhysicsTimeStats(),d=this.performance.getGpuTimeStats();Oh.trackEvent("TutorialStepComplete",{step:this.visualData.step,fpsAvg:null!==(t=h.avg)&&void 0!==t?t:0,fpsMin:null!==(e=h.min)&&void 0!==e?e:0,fpsMax:null!==(r=h.max)&&void 0!==r?r:0,cpuAvg:null!==(n=p.avg)&&void 0!==n?n:0,cpuMin:null!==(o=p.min)&&void 0!==o?o:0,cpuMax:null!==(i=p.max)&&void 0!==i?i:0,physicsAvg:null!==(a=y.avg)&&void 0!==a?a:0,physicsMin:null!==(u=y.min)&&void 0!==u?u:0,physicsMax:null!==(c=y.max)&&void 0!==c?c:0,gpuMin:null!==(s=d.min)&&void 0!==s?s:0,gpuMax:null!==(l=d.max)&&void 0!==l?l:0,gpuAvg:null!==(f=d.avg)&&void 0!==f?f:0,timeTaken:this.time}),this.complete=!0}}])}(),$o=Yo((function t(){Xo(this,t)})),ti=r(15233);function ei(t){return ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ei(t)}function ri(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,li(n.key),n)}}function ni(t,e,r){return e=ui(e),function(t,e){if(e&&("object"==ei(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,oi()?Reflect.construct(e,r||[],ui(t).constructor):e.apply(t,r))}function oi(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(oi=function(){return!!t})()}function ii(t,e,r,n){var o=ai(ui(1&n?t.prototype:t),e,r);return 2&n?function(t){return o.apply(r,t)}:o}function ai(){return ai="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=ui(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},ai.apply(null,arguments)}function ui(t){return ui=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ui(t)}function ci(t,e){return ci=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ci(t,e)}function si(t,e,r){return(e=li(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function li(t){var e=function(t,e){if("object"!=ei(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ei(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ei(e)?e:e+""}var fi=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=ni(this,e,[{step:"move"}])).player=t,si(r,"distanceDriven",0),si(r,"transform",void 0),si(r,"lastPosition",void 0),si(r,"init",F.Z),r.transform={origin:new lo.P,rotation:new Bo._},r.lastPosition=new lo.P,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ci(t,e)}(e,t),r=e,(n=[{key:"update",value:function(t){if(ii(e,"update",this,3)([t]),!this.complete){if(this.player.entity.isGrounded()&&(this.distanceDriven+=this.calculateDistanceDriven()),O.tq){var r=w.h.getState();r.tutorial.gasPedalPressed&&r.tutorial.mobileSteeringPressed&&this.distanceDriven>=40&&this.completeStep()}else this.distanceDriven>=40&&this.completeStep();Jf instanceof ti.P||this.silentComplete()}}},{key:"calculateDistanceDriven",value:function(){this.lastPosition.copy(this.transform.origin),(0,Fo.g)(this.player.entity.getTransform(),this.transform);var t=this.transform.origin.distanceTo(this.lastPosition);return t>=3&&(t=0),t}},{key:"silentComplete",value:function(){ii(e,"completeStep",this,3)([]),this.updateVisuals()}},{key:"completeStep",value:function(){ii(e,"completeStep",this,3)([]),this.updateVisuals(),Kf.playId("levelUp")}}])&&ri(r.prototype,n),o&&ri(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(Qo);function hi(t){return hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hi(t)}function pi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yi(n.key),n)}}function yi(t){var e=function(t,e){if("object"!=hi(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=hi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==hi(e)?e:e+""}function di(t,e,r){return e=gi(e),function(t,e){if(e&&("object"==hi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,vi()?Reflect.construct(e,r||[],gi(t).constructor):e.apply(t,r))}function vi(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(vi=function(){return!!t})()}function mi(t,e,r,n){var o=bi(gi(1&n?t.prototype:t),e,r);return 2&n?function(t){return o.apply(r,t)}:o}function bi(){return bi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=gi(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},bi.apply(null,arguments)}function gi(t){return gi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},gi(t)}function wi(t,e){return wi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},wi(t,e)}var Si=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),di(this,e,[{step:"navigateToCrates"}])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wi(t,e)}(e,t),r=e,(n=[{key:"init",value:function(){var t=this;if(w.h.getState().tutorial.crateOpenButtonPressed)setTimeout((function(){mi(e,"completeStep",t,3)([])}),1e3);else var r=w.h.subscribe((function(){w.h.getState().tutorial.crateOpenButtonPressed&&(console.log("crateOpenButtonPressed"),r(),t.completeStep())}))}},{key:"completeStep",value:function(){mi(e,"completeStep",this,3)([]),Kf.playId("levelUp")}}])&&pi(r.prototype,n),o&&pi(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(Qo);function xi(t){return xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xi(t)}function Oi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ti(n.key),n)}}function Pi(t,e,r){return e=ji(e),function(t,e){if(e&&("object"==xi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ei()?Reflect.construct(e,r||[],ji(t).constructor):e.apply(t,r))}function Ei(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ei=function(){return!!t})()}function ji(t){return ji=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ji(t)}function ki(t,e){return ki=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ki(t,e)}function Ti(t){var e=function(t,e){if("object"!=xi(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=xi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==xi(e)?e:e+""}var _i=function(t){function e(t){var r,n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Pi(this,e,[{step:"pause"}])).pauseTime=t,n=r,i=function(){setTimeout((function(){r.completeStep()}),r.pauseTime)},(o=Ti(o="init"))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ki(t,e)}(e,t),r=e,n&&Oi(r.prototype,n),o&&Oi(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(Qo);function Li(t){return Li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Li(t)}function Ii(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Di(n.key),n)}}function Ci(t,e,r){return e=Ni(e),function(t,e){if(e&&("object"==Li(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ai()?Reflect.construct(e,r||[],Ni(t).constructor):e.apply(t,r))}function Ai(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ai=function(){return!!t})()}function Mi(t,e){return Mi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Mi(t,e)}function Ri(){return Ri="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Ni(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Ri.apply(null,arguments)}function Ni(t){return Ni=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ni(t)}function Di(t){var e=function(t,e){if("object"!=Li(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Li(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Li(e)?e:e+""}var Bi=function(t){function e(){var t,r,n,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=Ci(this,e,[{step:"queue"}]),r=t,o=function(){"in-game"===w.h.getState().mainMenu.room.state&&setTimeout((function(){var r,n,o,i,a;(r=e,n="completeStep",o=t,a=Ri(Ni(1&(i=3)?r.prototype:r),n,o),2&i?function(t){return a.apply(o,t)}:a)([])}),1e3);var r=w.h.subscribe((function(){"in-game"===w.h.getState().mainMenu.room.state&&(r(),t.completeStep())}))},(n=Di(n="init"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mi(t,e)}(e,t),r=e,n&&Ii(r.prototype,n),o&&Ii(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(Qo);function Fi(t){return Fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fi(t)}function Gi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ui(n.key),n)}}function Ui(t){var e=function(t,e){if("object"!=Fi(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Fi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Fi(e)?e:e+""}function zi(t,e,r){return e=qi(e),function(t,e){if(e&&("object"==Fi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Wi()?Reflect.construct(e,r||[],qi(t).constructor):e.apply(t,r))}function Wi(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Wi=function(){return!!t})()}function Vi(t,e,r,n){var o=Hi(qi(1&n?t.prototype:t),e,r);return 2&n?function(t){return o.apply(r,t)}:o}function Hi(){return Hi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=qi(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Hi.apply(null,arguments)}function qi(t){return qi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qi(t)}function Xi(t,e){return Xi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xi(t,e)}var Ki=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),zi(this,e,[{step:"completeAGame"}])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xi(t,e)}(e,t),r=e,(n=[{key:"init",value:function(){var t=this;if(w.h.getState().tutorial.gameResultsReceived)setTimeout((function(){Vi(e,"completeStep",t,3)([])}),1e3);else var r=w.h.subscribe((function(){w.h.getState().tutorial.gameResultsReceived&&(r(),t.completeStep())}))}},{key:"completeStep",value:function(){Vi(e,"completeStep",this,3)([])}}])&&Gi(r.prototype,n),o&&Gi(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(Qo);function Yi(t){return Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yi(t)}function Ji(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Zi(n.key),n)}}function Zi(t){var e=function(t,e){if("object"!=Yi(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Yi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Yi(e)?e:e+""}var Qi={tutorialProperties:new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},(e=[{key:"complete",get:function(){return mh.data.tutorial.initialTutorial.complete},set:function(t){mh.data.tutorial.initialTutorial.complete=t,w.h.dispatch((0,Dn.fS)({step:"none"})),mh.save()}},{key:"step",get:function(){var t;return null!==(t=mh.data.tutorial.initialTutorial.step)&&void 0!==t?t:"none"},set:function(t){mh.data.tutorial.initialTutorial.step=t,mh.save()}}])&&Ji(t.prototype,e),r&&Ji(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()),validationGetters:function(t){if(!t)throw new Error("Player is required for initial tutorial");return[new _i(500),new fi(t),new Bi,new Ki,new Si]}};function $i(t){return $i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$i(t)}function ta(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ra(n.key),n)}}function ea(t,e,r){return(e=ra(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ra(t){var e=function(t,e){if("object"!=$i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=$i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==$i(e)?e:e+""}var na=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=e,ea(this,"initialized",!1),ea(this,"stepIndex",0),ea(this,"validators",[])},(e=[{key:"initialize",value:function(t){if(!this.config.tutorialProperties.complete&&!this.initialized){this.initialized=!0,this.validators=this.config.validationGetters(t);var e=this.config.tutorialProperties.step;w.h.dispatch((0,Dn.fS)({step:e}));var r=this.validators.findIndex((function(t){return t.step===e}));-1!==r&&(this.stepIndex=r),this.validators[this.stepIndex].init(),this.validators[this.stepIndex].updateVisuals(),this.setStep()}}},{key:"complete",value:function(){this.config.tutorialProperties.complete||(this.validators=[],this.config.tutorialProperties.complete=!0)}},{key:"update",value:function(t){var e=this.validators[this.stepIndex];e&&(e.update(t),e.complete&&this.nextStep())}},{key:"setStep",value:function(){this.config.tutorialProperties.step=this.validators[this.stepIndex].step}},{key:"nextStep",value:function(){this.stepIndex!==this.validators.length-1?(this.stepIndex++,this.validators[this.stepIndex].init(),this.validators[this.stepIndex].updateVisuals(),this.setStep()):this.complete()}}])&&ta(t.prototype,e),r&&ta(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),oa=r(79594);function ia(t){return ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ia(t)}function aa(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fa(n.key),n)}}function ua(t,e,r){return e=sa(e),function(t,e){if(e&&("object"==ia(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ca()?Reflect.construct(e,r||[],sa(t).constructor):e.apply(t,r))}function ca(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ca=function(){return!!t})()}function sa(t){return sa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sa(t)}function la(t,e){return la=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},la(t,e)}function fa(t){var e=function(t,e){if("object"!=ia(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ia(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ia(e)?e:e+""}var ha=function(t){function e(){var t,r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,a=new Array(i),u=0;u<i;u++)a[u]=arguments[u];return t=ua(this,e,[].concat(a)),r=t,o=!1,(n=fa(n="promptUser"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&la(t,e)}(e,t),r=e,(n=[{key:"initialize",value:function(t){return!mh.data.tutorial.inGameTutorial.itemTutorialCompleted}},{key:"update",value:function(t){var e=oa.n.getInventoryItem(0);if(this.promptUser){if(Yf.serverInputs.useItem)return mh.data.tutorial.inGameTutorial.itemTutorialCompleted=!0,mh.save(),w.h.dispatch((0,Dn.BD)(!1)),!0}else e&&0===e.timeTillUse&&(this.promptUser=!0,w.h.dispatch((0,Dn.BD)(!0)));return!1}}])&&aa(r.prototype,n),o&&aa(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}($o);function pa(t){return pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pa(t)}function ya(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,va(n.key),n)}}function da(t,e,r){return(e=va(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function va(t){var e=function(t,e){if("object"!=pa(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=pa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==pa(e)?e:e+""}var ma=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),da(this,"stepIndex",0),da(this,"initialTutorial",void 0),da(this,"asyncTutorial",void 0),this.initialTutorial=new na(Qi),this.asyncTutorial=[]},(e=[{key:"initialize",value:function(t){this.initialTutorial.initialize(t),this.asyncTutorial=[new ha].filter((function(e){return e.initialize(t)}))}},{key:"update",value:function(t){this.initialTutorial.update(t),0!==this.asyncTutorial.length&&(this.asyncTutorial=this.asyncTutorial.filter((function(e){return!e.update(t)})))}}])&&ya(t.prototype,e),r&&ya(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),ba=r(312);function ga(t){return ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ga(t)}function wa(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xa(n.key),n)}}function Sa(t,e,r){return(e=xa(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xa(t){var e=function(t,e){if("object"!=ga(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ga(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ga(e)?e:e+""}var Oa=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Sa(this,"units",0),Sa(this,"completedUnits",0),Sa(this,"complete",!1)},(e=[{key:"progress",get:function(){return Math.min(this.completedUnits/this.units,1)}},{key:"defineWork",value:function(t){this.units+=t}},{key:"completeWork",value:function(t){this.complete||(this.completedUnits+=t,this.completedUnits>=this.units&&(this.complete=!0),ba.o.setProgress(this.progress))}},{key:"reset",value:function(){this.units=0,this.completedUnits=0,this.complete=!1}}])&&wa(t.prototype,e),r&&wa(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),Pa=r(19040),Ea=r(7746),ja=r(56633);function ka(t){qf.video.renderScale=t,this.renderer.setSize(window.innerWidth*t,window.innerHeight*t,!1),this.composer.setSize(window.innerWidth*t,window.innerHeight*t,!1),this.resolutionUpdateFlow.push({width:window.innerWidth,height:window.innerHeight}),this.resolution={width:window.innerWidth,height:window.innerHeight}}var Ta=r(47472),_a=r(46802),La=r(54494),Ia=r(64195),Ca=r(31154),Aa=r(69024),Ma=r(86795),Ra=r(698),Na=r(27068),Da=r(17507);function Ba(t){return Ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ba(t)}function Fa(){Fa=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==Ba(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Ba(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Ga(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Ua(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||Wa(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function za(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Wa(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function Wa(t,e){if(t){if("string"==typeof t)return Va(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Va(t,e):void 0}}function Va(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ha(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Xa(n.key),n)}}function qa(t,e,r){return(e=Xa(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Xa(t){var e=function(t,e){if("object"!=Ba(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ba(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ba(e)?e:e+""}Ta.K.prototype.raycast=Ra.uL;var Ka=function(){return t=function t(e,r,n){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),qa(this,"canvas",void 0),qa(this,"three",void 0),qa(this,"camera",void 0),qa(this,"raycaster",void 0),qa(this,"mousePosition",void 0),qa(this,"clickListeners",void 0),qa(this,"hoverListeners",void 0),qa(this,"hasMoveSinceClick",void 0),qa(this,"getClicked3DPoint",(0,Da.Z)((function(t){if(!o.hasMoveSinceClick&&0!==Object.values(o.clickListeners).length){t.preventDefault();var e=t instanceof MouseEvent?t.clientX:t.changedTouches[0].clientX,r=t instanceof MouseEvent?t.clientY:t.changedTouches[0].clientY;o.mousePosition.x=(e-o.canvas.offsetLeft)/o.three.resolution.width*2-1,o.mousePosition.y=-(r-o.canvas.offsetTop)/o.three.resolution.height*2+1,o.raycaster.setFromCamera(o.mousePosition,o.camera);for(var n=0,i=Object.values(o.clickListeners);n<i.length;n++){var a=i[n],u=o.raycaster.intersectObjects([a.clickableObj],!0);if(u.length>0){a.callback(u[0].point);break}}}}),100)),qa(this,"getHovered3DPoint",(0,Da.Z)((function(t){if(!O.tq&&0!==Object.values(o.hoverListeners).length){t.preventDefault(),o.mousePosition.x=(t.clientX-o.canvas.offsetLeft)/o.three.resolution.width*2-1,o.mousePosition.y=-(t.clientY-o.canvas.offsetTop)/o.three.resolution.height*2+1,o.raycaster.setFromCamera(o.mousePosition,o.camera);for(var e=new Map,r=0,n=Object.values(o.hoverListeners);r<n.length;r++){var i=n[r],a=o.raycaster.intersectObjects([i.clickableObj],!0).length>0;e.set(i,a)}var u,c=za(e);try{for(c.s();!(u=c.n()).done;){var s=Ua(u.value,2),l=s[0];!s[1]&&l.isHovering&&(l.isHovering=!1,l.callback(!1))}}catch(t){c.e(t)}finally{c.f()}var f,h=za(e);try{for(h.s();!(f=h.n()).done;){var p=Ua(f.value,2),y=p[0];p[1]&&!y.isHovering&&(y.isHovering=!0,y.callback(!0))}}catch(t){h.e(t)}finally{h.f()}}}),80,{trailing:!0})),this.raycaster=new _a.i,this.raycaster.firstHitOnly=!0,this.mousePosition=new La.F,this.canvas=e,this.camera=r,this.three=n,this.clickListeners={},this.hoverListeners={},this.hasMoveSinceClick=!1,this.canvas.addEventListener("mousedown",(function(){o.hasMoveSinceClick=!1})),this.canvas.addEventListener("mousemove",(function(){o.hasMoveSinceClick=!0})),this.canvas.addEventListener("mouseup",this.getClicked3DPoint.bind(this)),this.canvas.addEventListener("touchend",this.getClicked3DPoint.bind(this)),this.canvas.addEventListener("mousemove",this.getHovered3DPoint.bind(this))},e=[{key:"addListeners",value:(n=Fa().mark((function t(e,r,n){var o,i,a=this;return Fa().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=(0,$n.Z)(),t.next=3,new Promise((function(t){return setTimeout(t,500)}));case 3:return i=this.getRaytracableMesh(e),this.hoverListeners[o]={originalObj:e,clickableObj:i,callback:r,isHovering:!1},this.clickListeners[o]={originalObj:e,clickableObj:i,callback:n},t.abrupt("return",{cancelHover:function(){(0,U.w)(a.hoverListeners[o].clickableObj),delete a.hoverListeners[o]},cancelClick:function(){(0,U.w)(a.hoverListeners[o].clickableObj),delete a.clickListeners[o]}});case 7:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){Ga(i,r,o,a,u,"next",t)}function u(t){Ga(i,r,o,a,u,"throw",t)}a(void 0)}))},function(t,e,r){return o.apply(this,arguments)})},{key:"dispose",value:function(){this.canvas.removeEventListener("click",this.getClicked3DPoint.bind(this)),this.canvas.removeEventListener("mousemove",this.getHovered3DPoint.bind(this))}},{key:"getRaytracableMesh",value:function(t){var e=this,r=[];t.traverse((function(t){t instanceof Ta.K&&r.push(t)}));var n=(0,Ma.K)(r.map((function(t){var r;if(t instanceof Ia.T){if("missile"===t.name)return;r=e.bakeSkinnedMesh(t)}else(r=t.clone()).geometry=r.geometry.clone();return r})).filter((function(t){return t})));return n.boundsTree=new Na.r(n),new Ta.K(n,new Ca.v({color:16711680}))}},{key:"bakeSkinnedMesh",value:function(t){var e=t.geometry.clone();e.computeVertexNormals();for(var r=e.attributes.position,n=[],o=0;o<r.count;o++){var i=new lo.P(r.getX(o),r.getY(o),r.getZ(o)),a=t.applyBoneTransform(o,i);n.push(a.x,a.y,a.z)}e.setAttribute("position",new Aa.a$(n,3)),e.computeVertexNormals();var u=t.clone();return u.geometry=e,u.bind(u.skeleton,u.matrixWorld),u}}],e&&Ha(t.prototype,e),r&&Ha(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function Ya(t){return Ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ya(t)}function Ja(t){return function(t){if(Array.isArray(t))return Qa(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Za(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Za(t,e){if(t){if("string"==typeof t)return Qa(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Qa(t,e):void 0}}function Qa(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function $a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,uu(n.key),n)}}function tu(t,e,r){return e=ou(e),function(t,e){if(e&&("object"==Ya(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,eu()?Reflect.construct(e,r||[],ou(t).constructor):e.apply(t,r))}function eu(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(eu=function(){return!!t})()}function ru(t,e,r,n){var o=nu(ou(1&n?t.prototype:t),e,r);return 2&n?function(t){return o.apply(r,t)}:o}function nu(){return nu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=ou(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},nu.apply(null,arguments)}function ou(t){return ou=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ou(t)}function iu(t,e){return iu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},iu(t,e)}function au(t,e,r){return(e=uu(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uu(t){var e=function(t,e){if("object"!=Ya(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ya(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ya(e)?e:e+""}var cu=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=document.getElementById("webgl-canvas");if(!r)throw new Error("Error: No canvas found, aborting three initialization");return au(t=tu(this,e,[r,new Pa.c(75,window.innerWidth/window.innerHeight,1,3e3)]),"audioListener",void 0),au(t,"rendererStatsElement",null),au(t,"resolutionUpdateFlow",void 0),au(t,"resolution",void 0),au(t,"mouseHandler",void 0),au(t,"resolutionCheckTimer",0),au(t,"prevWindowWidth",window.innerWidth),au(t,"prevWindowHeight",window.innerHeight),au(t,"gl",void 0),au(t,"ext",void 0),au(t,"pendingQueries",[]),au(t,"updateMasterVolume",so.EP.bind(t)),au(t,"updateSfxVolume",so.Ab.bind(t)),au(t,"updateRenderScale",ka.bind(t)),t.resolutionUpdateFlow=new Kr.Z,t.audioListener=new Ea.S,t.camera.add(t.audioListener),t.resolution=t.updateResolution(window.innerWidth,window.innerHeight),t.mouseHandler=new Ka(r,t.camera,t),t.gl=t.canvas.getContext("webgl2"),t.gl&&(t.ext=t.gl.getExtension("EXT_disjoint_timer_query_webgl2")),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&iu(t,e)}(e,t),r=e,n=[{key:"detectHardware",value:function(){qf.detectHardware(this.renderer.getContext())}},{key:"render",value:function(t){var r;this.checkForResolutionChange(t),this.audioListener.updateMatrixWorld(),this.renderer.info.reset();var n,o,i=O.tq||null===(r=this.gl)||void 0===r?void 0:r.createQuery();this.gl&&i&&this.gl.beginQuery(null===(n=this.ext)||void 0===n?void 0:n.TIME_ELAPSED_EXT,i),ru(e,"render",this,3)([t]),this.gl&&i&&(this.gl.endQuery(null===(o=this.ext)||void 0===o?void 0:o.TIME_ELAPSED_EXT),this.pendingQueries.push({query:i,frame:Ah}),this.processQueryResults()),this.updateRendererStats()}},{key:"processQueryResults",value:function(){if(this.gl){var t,e=[],r=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Za(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}(this.pendingQueries);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(this.gl.getQueryParameter(n.query,this.gl.QUERY_RESULT_AVAILABLE)){if(!this.gl.getParameter(this.ext.GPU_DISJOINT_EXT)){var o=this.gl.getQueryParameter(n.query,this.gl.QUERY_RESULT);Go.T.reportGpuTime(n.frame,o/1e6)}this.gl.deleteQuery(n.query)}else Ah-n.frame<10?e.push(n):this.gl.deleteQuery(n.query)}}catch(t){r.e(t)}finally{r.f()}this.pendingQueries=e}}},{key:"checkForResolutionChange",value:function(t){this.resolutionCheckTimer>=.4&&(this.resolutionCheckTimer=0,this.prevWindowWidth===window.innerWidth&&this.prevWindowHeight===window.innerHeight||(this.updateResolution(window.innerWidth,window.innerHeight),this.prevWindowWidth=window.innerWidth,this.prevWindowHeight=window.innerHeight)),this.resolutionCheckTimer+=t}},{key:"updateRendererStats",value:function(){this.rendererStatsElement&&(this.rendererStatsElement.textContent="\n      FRAME: ".concat(this.renderer.info.render.frame,"\n      CALLS: ").concat(this.renderer.info.render.calls,"\n      TRIANGLES: ").concat(this.renderer.info.render.triangles,"\n      POINTS: ").concat(this.renderer.info.render.points,"\n      LINES: ").concat(this.renderer.info.render.lines,"\n      M_GEOMETRIES: ").concat(this.renderer.info.memory.geometries,"\n      M_TEXTURES: ").concat(this.renderer.info.memory.textures,"\n    "))}},{key:"updateResolution",value:function(t,r){ru(e,"updateResolution",this,3)([t,r]);var n=r>t,o=n?window.innerHeight/1920:window.innerWidth/1920;return w.h.dispatch((0,S.P7)({scale:o,width:window.innerWidth,height:window.innerHeight,isPortrait:n})),this.resolutionUpdateFlow.push({width:window.innerWidth,height:window.innerHeight}),this.resolution={width:t,height:r},this.resolution}},{key:"getCameraMatrecies",value:function(){return[].concat(Ja(this.camera.projectionMatrix.toArray()),Ja(this.camera.matrixWorld.toArray()))}}],n&&$a(r.prototype,n),o&&$a(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ja.S);function su(t){return function(t){if(Array.isArray(t))return lu(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return lu(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?lu(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lu(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var fu=r(44165);function hu(t){return hu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hu(t)}function pu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,du(n.key),n)}}function yu(t,e,r){return(e=du(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function du(t){var e=function(t,e){if("object"!=hu(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=hu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==hu(e)?e:e+""}var vu=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),yu(this,"history",[]),yu(this,"currentIndex",-1)},(e=[{key:"add",value:function(t){this.history.length>=20&&this.history.shift(),this.history.push(t),this.currentIndex=this.history.length}},{key:"getPrevious",value:function(){return this.currentIndex>0?(this.currentIndex--,this.history[this.currentIndex]):null}},{key:"getNext",value:function(){return this.currentIndex<this.history.length-1?(this.currentIndex++,this.history[this.currentIndex]):this.currentIndex===this.history.length-1?(this.currentIndex++,""):null}},{key:"resetIndex",value:function(){this.currentIndex=this.history.length}}])&&pu(t.prototype,e),r&&pu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),mu=function(t){w.h.dispatch((0,P.Hz)({type:"LOG",message:t}))};function bu(t){return bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bu(t)}function gu(t){return function(t){if(Array.isArray(t))return xu(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Su(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||Su(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Su(t,e){if(t){if("string"==typeof t)return xu(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xu(t,e):void 0}}function xu(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ou(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Eu(n.key),n)}}function Pu(t,e,r){return(e=Eu(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Eu(t){var e=function(t,e){if("object"!=bu(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=bu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==bu(e)?e:e+""}var ju=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Pu(this,"commands",{}),Pu(this,"aliases",{}),Pu(this,"arguments",[]),Pu(this,"description",void 0)},e=[{key:"registerCommand",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.commands[t]={cmd:e,hidden:!1},n.forEach((function(n){r.aliases[t]||(r.aliases[t]=[]),r.aliases[t].push(n),r.commands[n]={cmd:e,hidden:!0}}))}},{key:"execute",value:function(t){var e,r=null===(e=t[0])||void 0===e?void 0:e.toLowerCase(),n=this.commands[r];return n?n.cmd.execute(t.slice(1)):"help"===r?this.help():0===this.arguments.length&&t[0]?(mu("Unknown command".concat(t[0]?" ".concat(t[0]):"",". Refer to the below help menu:")),void this.help()):void(this.validateArgs(t)&&this.run(this.convertArgs(t)))}},{key:"convertArgs",value:function(t){var e=this;return t.map((function(t,r){return e.arguments[r].convert(t)}))}},{key:"validateArgs",value:function(t){if(t.length<this.arguments.length)return mu("Not enough arguments. Expected: ".concat(this.arguments.length,"  Provided: ").concat(t.length)),!1;if(t.length>this.arguments.length)return mu("Too many arguments. Expected: ".concat(this.arguments.length,"  Provided: ").concat(t.length)),!1;for(var e=0;e<this.arguments.length;e++){var r=this.arguments[e],n=t[e];if(!r.validate(n))return!1}return!0}},{key:"help",value:function(){var t=this,e="".concat(this.description,"\n\n");Object.keys(this.commands).length>0&&(e+="Commands:\n".concat(Object.entries(this.commands).filter((function(t){return!wu(t,2)[1].hidden})).map((function(e){var r=wu(e,2),n=r[0],o=r[1].cmd,i=t.aliases[n];return"  ".concat(n," ").concat(o.arguments.map((function(t){return"[".concat(t.name,"]")})).join(" "),"     ").concat(i?"(aliases: ".concat(i.join(", "),")"):"")})).join("\n"),"\n")),this.arguments.length>0&&(e+="Arguments:\n".concat(this.arguments.map((function(t){return"  ".concat(t.name,"   ").concat(t.description)})).join("\n"))),mu(e)}},{key:"autocomplete",value:function(t){var e,r=null===(e=t[0])||void 0===e?void 0:e.toLowerCase(),n=this.commands[r];if(n)return n.cmd.autocomplete(t.slice(1));var o=this.arguments[t.length-1];return o?o.autocomplete(t[t.length-1]):t.length>1?[]:gu(Array.from(Object.entries(this.commands)).filter((function(t){var e=wu(t,2),n=e[0];return!e[1].hidden&&n.startsWith(r)})).map((function(t){return{value:wu(t,1)[0],color:"#ffffff"}})))}}],e&&Ou(t.prototype,e),r&&Ou(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function ku(t){return ku="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ku(t)}function Tu(t){return function(t){if(Array.isArray(t))return _u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return _u(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_u(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Lu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Iu(n.key),n)}}function Iu(t){var e=function(t,e){if("object"!=ku(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ku(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ku(e)?e:e+""}var Cu=function(){return t=function t(e,r){var n,o,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=e,this.description=r,n=this,i="boolean",(o=Iu(o="type"))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i},(e=[{key:"autocomplete",value:function(t){var e=t.toLowerCase();return[{value:"[".concat(this.name,"]"),color:"#ff4141",passive:!0}].concat(Tu(["true","false"].filter((function(t){return t.startsWith(e)&&t!==e})).map((function(t){return{value:t,color:"#ff4141"}}))))}},{key:"validate",value:function(t){var e=t.toLowerCase();return"true"===e||"false"===e||(mu("Invalid value for argument ".concat(this.name,". Value must be 'true' or 'false'.")),!1)}},{key:"convert",value:function(t){return"true"===t.toLowerCase()}}])&&Lu(t.prototype,e),r&&Lu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Au(t){return Au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Au(t)}function Mu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ru(n.key),n)}}function Ru(t){var e=function(t,e){if("object"!=Au(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Au(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Au(e)?e:e+""}var Nu=function(){return t=function t(e,r,n,o){var i,a,u,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=e,this.description=r,this.min=n,this.max=o,this.step=c,i=this,u="number",(a=Ru(a="type"))in i?Object.defineProperty(i,a,{value:u,enumerable:!0,configurable:!0,writable:!0}):i[a]=u},(e=[{key:"autocomplete",value:function(t){return[{value:"[".concat(this.name,"]"),color:"#ff35d2",passive:!0}]}},{key:"validate",value:function(t){var e=Number(t);return isNaN(e)?(mu("Invalid value for argument ".concat(this.name,". Value must be a number.")),!1):!(e<this.min||e>this.max)||(mu("Invalid value for argument ".concat(this.name,". Value must be between ").concat(this.min," and ").concat(this.max,".")),!1)}},{key:"convert",value:function(t){var e=Number(t);return Math.round(e/this.step)*this.step}}])&&Mu(t.prototype,e),r&&Mu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Du(t){return Du="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Du(t)}function Bu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Fu(n.key),n)}}function Fu(t){var e=function(t,e){if("object"!=Du(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Du(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Du(e)?e:e+""}var Gu=function(){return t=function t(e,r){var n,o,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=e,this.description=r,n=this,i="string",(o=Fu(o="type"))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i},(e=[{key:"autocomplete",value:function(t){return[{value:"[".concat(this.name,"]"),color:"#8aff35",passive:!0}]}},{key:"validate",value:function(t){return""!==t||(mu("Invalid value for argument ".concat(this.name,". Value must not be empty.")),!1)}},{key:"convert",value:function(t){return t}}])&&Bu(t.prototype,e),r&&Bu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Uu(t){return Uu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uu(t)}function zu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Wu(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Wu(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wu(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Vu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$u(n.key),n)}}function qu(t,e,r){return e&&Hu(t.prototype,e),r&&Hu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Xu(t,e,r){return e=Yu(e),function(t,e){if(e&&("object"==Uu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ku()?Reflect.construct(e,r||[],Yu(t).constructor):e.apply(t,r))}function Ku(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ku=function(){return!!t})()}function Yu(t){return Yu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Yu(t)}function Ju(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zu(t,e)}function Zu(t,e){return Zu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Zu(t,e)}function Qu(t,e,r){return(e=$u(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $u(t){var e=function(t,e){if("object"!=Uu(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Uu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Uu(e)?e:e+""}var tc=function(t){function e(){var t;Vu(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Qu(t=Xu(this,e,[].concat(n)),"description","Commands for debugging performance."),t}return Ju(e,t),qu(e,[{key:"run",value:function(){this.help()}}])}(ju),ec=function(t){function e(){var t;Vu(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Qu(t=Xu(this,e,[].concat(n)),"description","Toggle the stats graph."),Qu(t,"arguments",[new Cu("enabled","Whether the debug stats graph is enabled.")]),t}return Ju(e,t),qu(e,[{key:"run",value:function(t){var e=zu(t,1)[0];w.h.dispatch((0,S.Cq)(e)),mu("Debug stats graph ".concat(e?"enabled":"disabled"))}}])}(ju),rc=function(t){function e(){var t;Vu(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Qu(t=Xu(this,e,[].concat(n)),"description","Toggle the renderer stats."),Qu(t,"arguments",[new Cu("enabled","Whether the renderer stats are enabled.")]),t}return Ju(e,t),qu(e,[{key:"run",value:function(t){var e=zu(t,1)[0];w.h.dispatch((0,S.nd)(e)),mu("Debug stats graph ".concat(e?"enabled":"disabled"))}}])}(ju),nc=function(t){function e(){var t;Vu(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Qu(t=Xu(this,e,[].concat(n)),"description","Download a performance report."),t}return Ju(e,t),qu(e,[{key:"run",value:function(){mu("Downloading performance report..."),Go.T.downloadReport()}}])}(ju),oc=function(t){function e(){var t;Vu(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Qu(t=Xu(this,e,[].concat(n)),"description","Update the stats buffer size used for performance reporting."),Qu(t,"arguments",[new Nu("size","The size of the stats buffer.",20,5e3)]),t}return Ju(e,t),qu(e,[{key:"run",value:function(t){var e=zu(t,1)[0];Go.T.setBufferSize(e),mu("Buffer size set to ".concat(e))}}])}(ju),ic=new tc;function ac(t){return ac="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ac(t)}function uc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hc(n.key),n)}}function cc(t,e,r){return e=lc(e),function(t,e){if(e&&("object"==ac(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,sc()?Reflect.construct(e,r||[],lc(t).constructor):e.apply(t,r))}function sc(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(sc=function(){return!!t})()}function lc(t){return lc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},lc(t)}function fc(t,e){return fc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},fc(t,e)}function hc(t){var e=function(t,e){if("object"!=ac(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ac(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ac(e)?e:e+""}ic.registerCommand("graph",new ec),ic.registerCommand("renderer",new rc),ic.registerCommand("download_report",new nc),ic.registerCommand("buffer_size",new oc);var pc=new(function(t){function e(){var t,r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,a=new Array(i),u=0;u<i;u++)a[u]=arguments[u];return t=cc(this,e,[].concat(a)),r=t,o="A suite of commands for debugging the game.",(n=hc(n="description"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fc(t,e)}(e,t),r=e,(n=[{key:"run",value:function(){this.help()}}])&&uc(r.prototype,n),o&&uc(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ju));function yc(t){return yc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yc(t)}function dc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wc(n.key),n)}}function vc(t,e,r){return e=bc(e),function(t,e){if(e&&("object"==yc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,mc()?Reflect.construct(e,r||[],bc(t).constructor):e.apply(t,r))}function mc(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(mc=function(){return!!t})()}function bc(t){return bc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bc(t)}function gc(t,e){return gc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},gc(t,e)}function wc(t){var e=function(t,e){if("object"!=yc(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=yc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==yc(e)?e:e+""}pc.registerCommand("performance",ic);var Sc=new(function(t){function e(){var t,r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,a=new Array(i),u=0;u<i;u++)a[u]=arguments[u];return t=vc(this,e,[].concat(a)),r=t,o="Access the editor.",(n=wc(n="description"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gc(t,e)}(e,t),r=e,(n=[{key:"run",value:function(){w.h.dispatch((0,P.aq)("EDITOR"))}}])&&dc(r.prototype,n),o&&dc(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ju));function xc(t){return xc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xc(t)}function Oc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Tc(n.key),n)}}function Pc(t,e,r){return e=jc(e),function(t,e){if(e&&("object"==xc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ec()?Reflect.construct(e,r||[],jc(t).constructor):e.apply(t,r))}function Ec(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ec=function(){return!!t})()}function jc(t){return jc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},jc(t)}function kc(t,e){return kc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},kc(t,e)}function Tc(t){var e=function(t,e){if("object"!=xc(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=xc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==xc(e)?e:e+""}var _c=new(function(t){function e(){var t,r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,a=new Array(i),u=0;u<i;u++)a[u]=arguments[u];return t=Pc(this,e,[].concat(a)),r=t,o="Join a room.",(n=Tc(n="description"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kc(t,e)}(e,t),r=e,(n=[{key:"run",value:function(){console.log("Leaving room")}}])&&Oc(r.prototype,n),o&&Oc(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ju));function Lc(t){return Lc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lc(t)}function Ic(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Dc(n.key),n)}}function Cc(t,e,r){return e=Mc(e),function(t,e){if(e&&("object"==Lc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ac()?Reflect.construct(e,r||[],Mc(t).constructor):e.apply(t,r))}function Ac(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ac=function(){return!!t})()}function Mc(t){return Mc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Mc(t)}function Rc(t,e){return Rc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Rc(t,e)}function Nc(t,e,r){return(e=Dc(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Dc(t){var e=function(t,e){if("object"!=Lc(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Lc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Lc(e)?e:e+""}var Bc=new(function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Nc(t=Cc(this,e,[].concat(n)),"description","Kick a user from the room. You must be the host to use this command."),Nc(t,"arguments",[new Gu("userId","The ID of the user to kick.")]),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Rc(t,e)}(e,t),r=e,(n=[{key:"run",value:function(t){var e=t[0];console.log("Kicking user with ID: ".concat(e))}}])&&Ic(r.prototype,n),o&&Ic(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ju));function Fc(t){return Fc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fc(t)}function Gc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Hc(n.key),n)}}function Uc(t,e,r){return e=Wc(e),function(t,e){if(e&&("object"==Fc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,zc()?Reflect.construct(e,r||[],Wc(t).constructor):e.apply(t,r))}function zc(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(zc=function(){return!!t})()}function Wc(t){return Wc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Wc(t)}function Vc(t,e){return Vc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Vc(t,e)}function Hc(t){var e=function(t,e){if("object"!=Fc(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Fc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Fc(e)?e:e+""}var qc=new(function(t){function e(){var t,r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,a=new Array(i),u=0;u<i;u++)a[u]=arguments[u];return t=Uc(this,e,[].concat(a)),r=t,o="Leave the current room.",(n=Hc(n="description"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vc(t,e)}(e,t),r=e,(n=[{key:"run",value:function(){console.log("Leaving room")}}])&&Gc(r.prototype,n),o&&Gc(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ju));function Xc(t){return Xc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xc(t)}function Kc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$c(n.key),n)}}function Yc(t,e,r){return e=Zc(e),function(t,e){if(e&&("object"==Xc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Jc()?Reflect.construct(e,r||[],Zc(t).constructor):e.apply(t,r))}function Jc(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Jc=function(){return!!t})()}function Zc(t){return Zc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zc(t)}function Qc(t,e){return Qc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Qc(t,e)}function $c(t){var e=function(t,e){if("object"!=Xc(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Xc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Xc(e)?e:e+""}var ts=new(function(t){function e(){var t,r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,a=new Array(i),u=0;u<i;u++)a[u]=arguments[u];return t=Yc(this,e,[].concat(a)),r=t,o="A suite of commands to control room status.",(n=$c(n="description"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qc(t,e)}(e,t),r=e,(n=[{key:"run",value:function(){this.help()}}])&&Kc(r.prototype,n),o&&Kc(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ju));function es(t){return es="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},es(t)}function rs(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ns(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ns(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ns(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function os(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function is(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ps(n.key),n)}}function as(t,e,r){return e&&is(t.prototype,e),r&&is(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function us(t,e,r){return e=ss(e),function(t,e){if(e&&("object"==es(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,cs()?Reflect.construct(e,r||[],ss(t).constructor):e.apply(t,r))}function cs(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(cs=function(){return!!t})()}function ss(t){return ss=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ss(t)}function ls(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fs(t,e)}function fs(t,e){return fs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},fs(t,e)}function hs(t,e,r){return(e=ps(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ps(t){var e=function(t,e){if("object"!=es(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=es(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==es(e)?e:e+""}ts.registerCommand("kick",Bc,["k"]),ts.registerCommand("join",_c,["j"]),ts.registerCommand("leave",qc,["l"]);var ys=function(t){function e(){var t;os(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return hs(t=us(this,e,[].concat(n)),"description","Update audio settings."),t}return ls(e,t),as(e,[{key:"run",value:function(){this.help()}}])}(ju),ds=function(t){function e(){var t;os(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return hs(t=us(this,e,[].concat(n)),"description","Set the game's master volume."),hs(t,"arguments",[new Nu("volume","The master volume.",0,100)]),t}return ls(e,t),as(e,[{key:"run",value:function(t){var e=rs(t,1)[0];Qf.updateMasterVolume(e/100),mu("Master volume set to ".concat(e))}}])}(ju),vs=function(t){function e(){var t;os(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return hs(t=us(this,e,[].concat(n)),"description","Set the game's sound effect volume."),hs(t,"arguments",[new Nu("volume","The SFX volume.",0,100)]),t}return ls(e,t),as(e,[{key:"run",value:function(t){var e=rs(t,1)[0];Qf.updateSfxVolume(e/100),mu("SFX volume set to ".concat(e))}}])}(ju),ms=function(t){function e(){var t;os(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return hs(t=us(this,e,[].concat(n)),"description","Set the game's music volume."),hs(t,"arguments",[new Nu("volume","The music volume.",0,100)]),t}return ls(e,t),as(e,[{key:"run",value:function(t){var e=rs(t,1)[0];(0,so.b$)(e/100),mu("Music volume set to ".concat(e))}}])}(ju),bs=function(t){function e(){var t;os(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return hs(t=us(this,e,[].concat(n)),"description","Enable/disable the music muffle effect when pausing the game."),hs(t,"arguments",[new Cu("enabled","Whether music muffle on pause is enabled.")]),t}return ls(e,t),as(e,[{key:"run",value:function(t){var e=rs(t,1)[0];qf.audio.muffleMusicOnPause=e,mu("Muffle music on pause ".concat(e?"enabled":"disabled"))}}])}(ju),gs=function(t){function e(){var t;os(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return hs(t=us(this,e,[].concat(n)),"description","Enable/disable the audio visualizer."),hs(t,"arguments",[new Cu("enabled","Whether the audio visualizer is enabled.")]),t}return ls(e,t),as(e,[{key:"run",value:function(t){var e=rs(t,1)[0];qf.audio.visualizerEnabled=e,w.h.dispatch((0,A.Pw)(e)),mu("Audio visualizer ".concat(e?"enabled":"disabled"))}}])}(ju),ws=new ys;function Ss(t){return Ss="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ss(t)}function xs(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Os(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Os(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Os(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ps(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Es(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,As(n.key),n)}}function js(t,e,r){return e&&Es(t.prototype,e),r&&Es(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ks(t,e,r){return e=_s(e),function(t,e){if(e&&("object"==Ss(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ts()?Reflect.construct(e,r||[],_s(t).constructor):e.apply(t,r))}function Ts(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ts=function(){return!!t})()}function _s(t){return _s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_s(t)}function Ls(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Is(t,e)}function Is(t,e){return Is=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Is(t,e)}function Cs(t,e,r){return(e=As(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function As(t){var e=function(t,e){if("object"!=Ss(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ss(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ss(e)?e:e+""}ws.registerCommand("master_volume",new ds,["mastervolume","master"]),ws.registerCommand("sfx_volume",new vs,["sfxvolume","sfx"]),ws.registerCommand("music_volume",new ms,["musicvolume","music"]),ws.registerCommand("muffle_on_pause",new bs,["muffleonpause","muffle"]),ws.registerCommand("visualizer",new gs);var Ms=function(t){function e(){var t;Ps(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Cs(t=ks(this,e,[].concat(n)),"description","Update gameplay settings."),t}return Ls(e,t),js(e,[{key:"run",value:function(){this.help()}}])}(ju),Rs=function(t){function e(){var t;Ps(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Cs(t=ks(this,e,[].concat(n)),"description","Enable/disable smart steering. Smart steering helps you stay on the track and off the walls."),Cs(t,"arguments",[new Cu("enabled","Whether smart steering is enabled.")]),t}return Ls(e,t),js(e,[{key:"run",value:function(t){var e=xs(t,1)[0];qf.gameplay.smartSteering=e,Zf.game.setSmartSteering(qf.gameplay.smartSteering),mu("Smart steering ".concat(e?"enabled":"disabled"))}}])}(ju),Ns=new Ms;Ns.registerCommand("smart_steering",new Rs,["smartsteering"]);var Ds=r(73649),Bs=r(11778),Fs=r(61221);function Gs(t){return Gs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gs(t)}function Us(t){return function(t){if(Array.isArray(t))return zs(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return zs(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?zs(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zs(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ws(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Vs(n.key),n)}}function Vs(t){var e=function(t,e){if("object"!=Gs(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Gs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Gs(e)?e:e+""}var Hs=function(){return t=function t(e,r,n){var o,i,a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=e,this.description=r,this.enumType=n,o=this,a="enum",(i=Vs(i="type"))in o?Object.defineProperty(o,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[i]=a},(e=[{key:"autocomplete",value:function(t){var e=t.toLowerCase();return[{value:"[".concat(this.name,"]"),color:"#35f4ff",passive:!0}].concat(Us(Object.values(this.enumType).filter((function(r){return r.toLowerCase().startsWith(e)&&r!==t})).map((function(t){return{value:t,color:"#35f4ff"}}))))}},{key:"validate",value:function(t){var e=t.toLowerCase();return!!Object.values(this.enumType).map((function(t){return t.toLowerCase()})).includes(e)||(mu("Invalid value for argument ".concat(this.name,". Value must be one of ").concat(Object.values(this.enumType).join(", "),".")),!1)}},{key:"convert",value:function(t){var e=t.toLowerCase();return Object.values(this.enumType).find((function(t){return t.toLowerCase()===e}))||t}}])&&Ws(t.prototype,e),r&&Ws(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function qs(t){return qs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qs(t)}function Xs(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Ks(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ks(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ks(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ys(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Js(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ol(n.key),n)}}function Zs(t,e,r){return e&&Js(t.prototype,e),r&&Js(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Qs(t,e,r){return e=tl(e),function(t,e){if(e&&("object"==qs(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,$s()?Reflect.construct(e,r||[],tl(t).constructor):e.apply(t,r))}function $s(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return($s=function(){return!!t})()}function tl(t){return tl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tl(t)}function el(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rl(t,e)}function rl(t,e){return rl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},rl(t,e)}function nl(t,e,r){return(e=ol(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ol(t){var e=function(t,e){if("object"!=qs(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=qs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==qs(e)?e:e+""}var il=function(t){function e(){var t;Ys(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return nl(t=Qs(this,e,[].concat(n)),"description","Update video settings."),t}return el(e,t),Zs(e,[{key:"run",value:function(){this.help()}}])}(ju),al=function(t){function e(){var t;Ys(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return nl(t=Qs(this,e,[].concat(n)),"description","Apply a video preset."),nl(t,"arguments",[new Hs("preset","The video preset.",j.L)]),t}return el(e,t),Zs(e,[{key:"run",value:function(t){var e=Xs(t,1)[0];e!==j.L.CUSTOM?((0,E.o)(e),mu("".concat(e," video preset applied"))):mu("Video preset updated to custom, no other changes have been made.")}}])}(ju),ul=function(t){function e(){var t;Ys(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return nl(t=Qs(this,e,[].concat(n)),"description","Set the render scale."),nl(t,"arguments",[new Nu("scale","The render scale.",.1,2,.1)]),t}return el(e,t),Zs(e,[{key:"run",value:function(t){var e=Xs(t,1)[0];qf.video.preset=j.L.CUSTOM,Qf.updateRenderScale(e),mu("Render scale set to ".concat(e))}}])}(ju),cl=function(t){function e(){var t;Ys(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return nl(t=Qs(this,e,[].concat(n)),"description","Enable/disable anti-aliasing. Anti-aliasing smooths out jagged edges for a cleaner look."),nl(t,"arguments",[new Cu("enabled","Whether anti-aliasing is enabled.")]),t}return el(e,t),Zs(e,[{key:"run",value:function(t){var e=Xs(t,1)[0];qf.video.preset=j.L.CUSTOM,(0,Bs.M)(e),mu("Anti-aliasing ".concat(e?"enabled":"disabled"))}}])}(ju),sl=function(t){function e(){var t;Ys(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return nl(t=Qs(this,e,[].concat(n)),"description","Set game to fullscreen."),nl(t,"arguments",[new Cu("enabled","Whether fullscreen is enabled.")]),t}return el(e,t),Zs(e,[{key:"run",value:function(t){var e=Xs(t,1)[0];e?document.documentElement.requestFullscreen():document.fullscreenElement&&document.exitFullscreen(),mu("Fullscreen ".concat(e?"enabled":"disabled"))}}])}(ju),ll=function(t){function e(){var t;Ys(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return nl(t=Qs(this,e,[].concat(n)),"description","Set the shadow quality."),nl(t,"arguments",[new Hs("quality","The shadow quality.",j.U)]),t}return el(e,t),Zs(e,[{key:"run",value:function(t){var e=Xs(t,1)[0];qf.video.preset=j.L.CUSTOM,(0,Fs.o)(e),mu("Shadow quality set to ".concat(e))}}])}(ju),fl=function(t){function e(){var t;Ys(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return nl(t=Qs(this,e,[].concat(n)),"description","Enable/disable advanced material visual effects. This simplifies + changes the look of some metallic objects, glass, fog, etc."),nl(t,"arguments",[new Cu("enabled","Whether advanced material VFX is enabled.")]),t}return el(e,t),Zs(e,[{key:"run",value:function(t){var e=Xs(t,1)[0];qf.video.preset=j.L.CUSTOM,(0,Ds.t)(e),mu("Advanced material VFX ".concat(e?"enabled":"disabled"))}}])}(ju),hl=new il;function pl(t){return pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pl(t)}function yl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gl(n.key),n)}}function dl(t,e,r){return e=ml(e),function(t,e){if(e&&("object"==pl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,vl()?Reflect.construct(e,r||[],ml(t).constructor):e.apply(t,r))}function vl(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(vl=function(){return!!t})()}function ml(t){return ml=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ml(t)}function bl(t,e){return bl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},bl(t,e)}function gl(t){var e=function(t,e){if("object"!=pl(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=pl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==pl(e)?e:e+""}hl.registerCommand("render_scale",new ul,["renderscale","scale"]),hl.registerCommand("antialiasing",new cl,["anti-aliasing","aa"]),hl.registerCommand("fullscreen",new sl),hl.registerCommand("shadow_quality",new ll,["shadowquality","shadow","shadows"]),hl.registerCommand("preset",new al),hl.registerCommand("advanced_material_fx",new fl,["advanced_fx"]);var wl=new(function(t){function e(){var t,r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,a=new Array(i),u=0;u<i;u++)a[u]=arguments[u];return t=dl(this,e,[].concat(a)),r=t,o="A suite of commands to control game settings.",(n=gl(n="description"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bl(t,e)}(e,t),r=e,(n=[{key:"run",value:function(){this.help()}}])&&yl(r.prototype,n),o&&yl(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ju));function Sl(t){return Sl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sl(t)}function xl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,kl(n.key),n)}}function Ol(t,e,r){return e=El(e),function(t,e){if(e&&("object"==Sl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Pl()?Reflect.construct(e,r||[],El(t).constructor):e.apply(t,r))}function Pl(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Pl=function(){return!!t})()}function El(t){return El=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},El(t)}function jl(t,e){return jl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},jl(t,e)}function kl(t){var e=function(t,e){if("object"!=Sl(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Sl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Sl(e)?e:e+""}wl.registerCommand("video",hl),wl.registerCommand("audio",ws),wl.registerCommand("gameplay",Ns);var Tl=new(function(t){function e(){var t,r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,a=new Array(i),u=0;u<i;u++)a[u]=arguments[u];return t=Ol(this,e,[].concat(a)),r=t,o="The Drift.io command line",(n=kl(n="description"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jl(t,e)}(e,t),r=e,(n=[{key:"run",value:function(){this.help()}}])&&xl(r.prototype,n),o&&xl(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ju));function _l(t){return _l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_l(t)}function Ll(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Il(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Il(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function Il(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Cl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Al(n.key),n)}}function Al(t){var e=function(t,e){if("object"!=_l(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_l(e)?e:e+""}Tl.registerCommand("settings",wl,["setting"]),Tl.registerCommand("debug",pc),Tl.registerCommand("editor",Sc);var Ml=function(){return t=function t(){var e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,n=void 0,(r=Al(r="history"))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,this.history=new vu},(e=[{key:"autocomplete",value:function(t){var e=t.split(";"),r=e[e.length-1].trimStart(),n=this.preprocessCommand(r);return Tl.autocomplete(n)}},{key:"execute",value:function(t){w.h.dispatch((0,P.Hz)({type:"CMD",message:t.replace(/\s*;\s*/g,"\n")}));var e,r=Ll(t.split(";"));try{for(r.s();!(e=r.n()).done;){var n=e.value;if(""!==n){n=n.trim();var o=this.preprocessCommand(n);Tl.execute(o)}}}catch(t){r.e(t)}finally{r.f()}this.history.add(t)}},{key:"preprocessCommand",value:function(t){"/"===t[0]&&(t=t.slice(1));var e=t.split(" ");return e.filter((function(t,r){return""!==t||r===e.length-1}))}}])&&Cl(t.prototype,e),r&&Cl(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Rl(t){return Rl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rl(t)}function Nl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Dl(n.key),n)}}function Dl(t){var e=function(t,e){if("object"!=Rl(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Rl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Rl(e)?e:e+""}var Bl=function(){return t=function t(){var e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,n=void 0,(r=Dl(r="id"))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,this.id=this.getSdkString()},e=[{key:"getSdkString",value:function(){var t,e=window.location.pathname.replace("/","").split("/");return e.length>0&&""!==e[0]?(0,J.getPlatform)(e[0]):window.location.hostname.includes("discordsays")?"discord":(0,J.getPlatform)(null!==(t=new URLSearchParams(window.location.search).get("x"))&&void 0!==t?t:void 0)}},{key:"is",value:function(){for(var t=this,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.some((function(e){return e===t.id}))}},{key:"allowsAds",get:function(){return"discord"!==this.id}},{key:"allowsIap",get:function(){return"discord"!==this.id&&"poki"!==this.id}},{key:"allowsFullscreen",get:function(){return"discord"!==this.id&&"poki"!==this.id}},{key:"increaseDefaultUiScale",get:function(){return this.is("poki","discord","crazygames")}}],e&&Nl(t.prototype,e),r&&Nl(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),Fl=r(24200),Gl=r(99971),Ul=r(98396);function zl(t){return zl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zl(t)}function Wl(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Vl(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Wl(Object(r),!0).forEach((function(e){$l(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Wl(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Hl(){Hl=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==zl(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(zl(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function ql(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Xl(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ql(i,n,o,a,u,"next",t)}function u(t){ql(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Kl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tf(n.key),n)}}function Yl(t,e,r){return e=Zl(e),function(t,e){if(e&&("object"==zl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Jl()?Reflect.construct(e,r||[],Zl(t).constructor):e.apply(t,r))}function Jl(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Jl=function(){return!!t})()}function Zl(t){return Zl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zl(t)}function Ql(t,e){return Ql=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ql(t,e)}function $l(t,e,r){return(e=tf(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tf(t){var e=function(t,e){if("object"!=zl(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=zl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==zl(e)?e:e+""}var ef=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),$l(t=Yl(this,e,[[new Fl.Fw({getUserId:Q.u.getTrackingId,host:dh.parse(Yt.le[(0,Hr.Z)()]),platform:yh.id})]]),"pageVisitTime",void 0),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ql(t,e)}(e,t),r=e,n=[{key:"getIp",value:(a=Xl(Hl().mark((function t(){var e,r;return Hl().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("https://api.ipify.org?format=json");case 3:return e=t.sent,t.next=6,e.json();case 6:return r=t.sent,t.abrupt("return",r.ip);case 10:return t.prev=10,t.t0=t.catch(0),t.abrupt("return",void 0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])}))),function(){return a.apply(this,arguments)})},{key:"identifyUser",value:(i=Xl(Hl().mark((function t(){var e,r,n,o,i,a;return Hl().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=Gl.getParser(window.navigator.userAgent),t.next=3,(0,Ul.fm)();case 3:return i=t.sent,t.next=6,this.getIp();case 6:a=t.sent,this.trackUser({"hardware.gpuTier":null===(e=qf.hardware)||void 0===e||null===(e=e.gpu)||void 0===e?void 0:e.tier,"hardware.gpuName":null===(r=qf.hardware)||void 0===r||null===(r=r.gpu)||void 0===r?void 0:r.gpu,"settings.video.preset":qf.video.preset,version:null!==(n="2.5.15")?n:"unknown",browser:o.getBrowserName(),browserVersion:o.getBrowserVersion(),deviceType:o.getPlatformType(),os:o.getOSName(),deviceId:i,language:window.navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,ip:a,platform:yh.id});case 8:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"trackPageVisit",value:function(){var t=this.getNavigationTimingInfo();if(this.pageVisitTime=window.performance.now(),"reload"===t.navigationType)return this.trackEvent("PageReload",Vl({},t));var e=Vl(Vl({},t),{},{referrer:document.referrer&&new URL(document.referrer).hostname,referringDomain:document.referrer}),r=new URLSearchParams(window.location.search).get("room");r&&(e.joinedRoom=r.substring(3,9),e.joinedRegion=r.substring(0,3)),this.trackEvent("PageVisit",e)}},{key:"trackPageLeave",value:function(){var t;this.pageVisitTime&&(t=Math.round((window.performance.now()-this.pageVisitTime)/1e3)),this.trackEvent("PageLeave",{visitLength:t})}},{key:"getNavigationTimingInfo",value:function(){var t=window.performance.getEntriesByType("navigation")[0];if(!t)return{};var e=window.performance.now();return{loadTime:Math.round(e-t.startTime),navigationType:t.type}}}],n&&Kl(r.prototype,n),o&&Kl(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,i,a}(Fl.dF),rf=r(28854),nf=r(39118),of=r(76223),af=r(74613);function uf(t){return uf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uf(t)}function cf(){cf=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==uf(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(uf(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function sf(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function lf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vf(n.key),n)}}function ff(t,e,r){return e=yf(e),function(t,e){if(e&&("object"==uf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,hf()?Reflect.construct(e,r||[],yf(t).constructor):e.apply(t,r))}function hf(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(hf=function(){return!!t})()}function pf(){return pf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=yf(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},pf.apply(null,arguments)}function yf(t){return yf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yf(t)}function df(t,e){return df=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},df(t,e)}function vf(t){var e=function(t,e){if("object"!=uf(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=uf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==uf(e)?e:e+""}var mf=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n,o,i,a=document.createElement("canvas"),u=new Pa.c(75,1,.1,1e3);return u.position.set(-4,4,-4),u.lookAt(0,0,0),u.updateMatrixWorld(),t=ff(this,e,[a,u,!0]),n=t,i=null,(o=vf(o="model"))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,t.renderer.setClearColor(0,0),t.setupScene(),t.updateResolution(r,r),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&df(t,e)}(e,t),r=e,n=[{key:"setupScene",value:function(){this.scene.background=null;var t=new nf.M(16775119,.8*Math.PI);this.scene.add(t);var e=new of.O(15261845,1*Math.PI);e.position.set(0,1,0),this.scene.add(e)}},{key:"load",value:(i=cf().mark((function t(e){return cf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.model&&this.scene.remove(this.model),this.model=e.scene,this.scene.add(this.model),this.centerAndScaleModel();case 4:case"end":return t.stop()}}),t,this)})),a=function(){var t=this,e=arguments;return new Promise((function(r,n){var o=i.apply(t,e);function a(t){sf(o,r,n,a,u,"next",t)}function u(t){sf(o,r,n,a,u,"throw",t)}a(void 0)}))},function(t){return a.apply(this,arguments)})},{key:"centerAndScaleModel",value:function(){if(this.model){var t=(new af.Z).setFromObject(this.model),e=t.getCenter(new lo.P),r=t.getSize(new lo.P),n=3/Math.max(r.x,r.y,r.z);this.model.scale.setScalar(n),this.model.position.sub(e.multiplyScalar(n))}}},{key:"generateThumbnail",value:function(){return this.render(0),this.canvas.toDataURL("image/png")}},{key:"dispose",value:function(){var t,r,n,o,i;this.model&&(this.scene.remove(this.model),this.model=null),(t=e,r="dispose",n=this,i=pf(yf(1&(o=3)?t.prototype:t),r,n),2&o?function(t){return i.apply(n,t)}:i)([])}}],n&&lf(r.prototype,n),o&&lf(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,i,a}(ja.S),bf=r(2684),gf=r(69300);function wf(t){return wf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wf(t)}function Sf(){Sf=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==wf(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(wf(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function xf(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Of(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Pf(n.key),n)}}function Pf(t){var e=function(t,e){if("object"!=wf(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=wf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==wf(e)?e:e+""}var Ef=function(){return t=function t(e){var r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=void 0,(n=Pf(n="generator"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,this.generator=new mf(e),this.generator.camera.position.set(2,1,4),this.generator.camera.lookAt(-1,0,0),this.generator.camera.zoom=1.5,this.generator.camera.updateProjectionMatrix(),this.generator.camera.updateMatrixWorld()},e=[{key:"load",value:(n=Sf().mark((function t(e){var r,n;return Sf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.generator.model&&this.generator.scene.remove(this.generator.model),t.next=3,ch.car.getCosmeticCar((0,gf.h)(e));case 3:(r=t.sent).mesh.traverse((function(t){return t.visible=!0})),n=[],r.mesh.traverse((function(t){if(t instanceof Ta.K&&(t.name.includes("tire")||t.name.includes("spare"))){var e=(0,bf.d9)(r.tireMesh);e.position.copy(t.position),t.name.includes("spare")?e.rotateOnAxis(new lo.P(0,0,1),3*Math.PI/2):e.position.x<0&&e.rotateOnAxis(new lo.P(0,1,0),Math.PI),e.updateMatrixWorld(),n.push(e),t.visible=!1}})),n.forEach((function(t){return r.mesh.add(t)})),r.mesh.updateMatrixWorld(),this.generator.scene.add(r.mesh),this.generator.model=r.mesh;case 11:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){xf(i,r,o,a,u,"next",t)}function u(t){xf(i,r,o,a,u,"throw",t)}a(void 0)}))},function(t){return o.apply(this,arguments)})},{key:"generateThumbnail",value:function(){return this.generator.render(0),this.generator.canvas.toDataURL("image/png")}},{key:"dispose",value:function(){this.generator.dispose()}}],e&&Of(t.prototype,e),r&&Of(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function jf(t){return jf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jf(t)}function kf(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Tf(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Tf(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tf(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _f(){_f=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==jf(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(jf(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Lf(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function If(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Lf(i,n,o,a,u,"next",t)}function u(t){Lf(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Cf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Mf(n.key),n)}}function Af(t,e,r){return(e=Mf(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mf(t){var e=function(t,e){if("object"!=jf(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=jf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==jf(e)?e:e+""}var Rf=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.generator=e,Af(this,"queue",[]),Af(this,"cache",new Map),Af(this,"inProgress",new Set),Af(this,"maxConcurrent",1)},e=[{key:"getThumbnail",value:(o=If(_f().mark((function t(e,r){var n=this;return _f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.cache.has(e)){t.next=2;break}return t.abrupt("return",this.cache.get(e));case 2:if(!this.inProgress.has(e)){t.next=4;break}return t.abrupt("return",new Promise((function(t,o){n.queue.push({id:e,data:r,resolve:t,reject:o})})));case 4:return t.abrupt("return",new Promise((function(t,o){n.queue.push({id:e,data:r,resolve:t,reject:o}),n.processQueue()})));case 5:case"end":return t.stop()}}),t,this)}))),function(t,e){return o.apply(this,arguments)})},{key:"dequeue",value:function(t){var e=this.queue.findIndex((function(e){return e.id===t}));return-1!==e&&(kf(this.queue.splice(e,1),1)[0].resolve(void 0),!0)}},{key:"processQueue",value:(n=If(_f().mark((function t(){var e,r;return _f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.inProgress.size>=this.maxConcurrent)){t.next=2;break}return t.abrupt("return");case 2:if(e=this.queue.shift()){t.next=5;break}return t.abrupt("return");case 5:return this.inProgress.add(e.id),t.prev=6,t.next=9,this.generator.load(e.data);case 9:r=this.generator.generateThumbnail(),this.cache.set(e.id,r),e.resolve(r),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(6),e.reject(t.t0);case 17:return t.prev=17,this.inProgress.delete(e.id),this.processQueue(),t.finish(17);case 21:case"end":return t.stop()}}),t,this,[[6,14,17,21]])}))),function(){return n.apply(this,arguments)})},{key:"clearCache",value:function(){this.cache.clear()}},{key:"dispose",value:function(){this.generator.dispose(),this.cache.clear(),this.queue=[],this.inProgress.clear()}}],e&&Cf(t.prototype,e),r&&Cf(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function Nf(t){return Nf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nf(t)}function Df(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Gf(n.key),n)}}function Bf(t,e,r){return e&&Df(t.prototype,e),r&&Df(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ff(t,e,r){return(e=Gf(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gf(t){var e=function(t,e){if("object"!=Nf(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Nf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Nf(e)?e:e+""}var Uf,zf,Wf,Vf,Hf,qf,Xf,Kf,Yf,Jf,Zf,Qf,$f,th,eh,rh,nh,oh,ih,ah,uh,ch,sh=Bf((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Ff(this,"thumbnailManager",new Rf(new mf(128))),Ff(this,"carThumbnailManager",new Rf(new Ef(128)))}));function lh(t){return lh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lh(t)}function fh(){fh=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==lh(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(lh(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function hh(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function ph(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){hh(i,n,o,a,u,"next",t)}function u(t){hh(i,n,o,a,u,"throw",t)}a(void 0)}))}}var yh=new Bl,dh=(0,fu.y)(),vh=new $t,mh=new Br,bh=new Vr,gh=new Oa;gh.defineWork(30);var wh,Sh,xh,Oh=new ef,Ph=new st,Eh=function(){var t=ph(fh().mark((function t(){return fh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Io();case 2:return t.abrupt("return",new Promise((function(t){(0,n.DRIFT)({wasmFile:o,worker_0:new Worker(new URL(r.p+r.u(268),r.b))}).then(function(){var e=ph(fh().mark((function e(r){var n;return fh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Uf=r,gh.completeWork(10),(n=new Uf.VisualCreator).createEntity=Fr.JP,n.removeEntity=Fr.Sx,zf=new Uf.Global(n.ptr),Wf=zf.proxyClientMap(),Vf=zf.proxyCollision(),(uh=new Uf.CallbackHandlerInt).callbackFn=F.Z,zf.setFrameCompleteCallback(uh),Wf.setTestItem($.w0),qf=new D,Qf=new cu,Yf=new mt,th=new Do,Hf=new g,Xf=new B.Q,Kf=new Eo,Zf=new uo,eh=new Y,rh=(0,Yt.hu)({stage:(0,Hr.Z)(),platform:yh.id,hostParser:dh,authDirector:(0,rf.p)()}),nh=new Ml,oh=new sh,ih=zf.getTickRate(),ah=new ma,$f=Kt({settings:qf,three:Qf,tracking:Oh,lifecycle:th},yh.id),ch=new f.yu(Qf),window.onbeforeunload=gt,window.addEventListener("keydown",(function(t){["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t.key)&&t.preventDefault()})),document.addEventListener("touchstart",(function(t){var e;t.target instanceof Element&&t.target.matches("input, textarea, [contenteditable]")||(t.preventDefault(),null===(e=t.target)||void 0===e||e.dispatchEvent(bt("mousedown",t)))}),{passive:!1}),document.addEventListener("touchend",(function(t){var e,r;t.target instanceof Element&&t.target.matches("input, textarea, [contenteditable]")||(t.preventDefault(),null===(e=t.target)||void 0===e||e.dispatchEvent(bt("click",t)),null===(r=t.target)||void 0===r||r.dispatchEvent(bt("mouseup",t)))}),{passive:!1}),document.addEventListener("contextmenu",(function(t){return t.preventDefault()})),e.next=31,Promise.all([$f.init(),Uh(0)]);case 31:return Qf.detectHardware(),t(),gh.completeWork(2),Oh.identifyUser(),e.next=37,Zf.init();case 37:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})));case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),jh=(wh=function(){var t=ph(fh().mark((function t(e){var r;return fh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!Jf){t.next=6;break}return r=Jf,Jf=void 0,t.next=6,r.dispose();case 6:return Jf=e,t.next=9,e.init();case 9:w.h.dispatch((0,P.Vp)()),t.next=16;break;case 12:throw t.prev=12,t.t0=t.catch(0),w.h.dispatch((0,P.Cr)({content:"basic-alert",props:{title:"Uh oh something went wrong: ".concat(t.t0.message)},noClose:!0})),t.t0;case 16:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}(),Sh=[],xh=!1,function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return new Promise((function(t){if(Sh.push({params:e,completionCallback:t}),!xh){xh=!0;var r=function(){if(0!==Sh.length){var t=Sh.shift();t&&wh.apply(void 0,su(t.params)).then((function(){t.completionCallback(),r()}))}else xh=!1};r()}}))}),kh=0,Th=0,_h=0,Lh=0,Ih=[],Ch=0,Ah=0,Mh=0,Rh=0,Nh=[],Dh=[],Bh=void 0,Fh=1,Gh=0,Uh=function(){var t=ph(fh().mark((function t(e){var r,n,o,i,a,u,c,s,l,f,h,p,y,d;return fh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Jf){t.next=4;break}return requestAnimationFrame(Uh),t.abrupt("return");case 4:Ah++,n=performance.now(),o=(e-Mh)/1e3,Mh=e,o>.1&&(o=.1),Dh.push(o),Dh.length>60&&Dh.shift(),i=Dh.reduce((function(t,e){return t+e}),0)/Dh.length,a=1/ih,Gh=0,Ch+=i;case 15:if(!(Ch>=a)){t.next=34;break}if(Fh=Math.floor(Ch/a),c=kh++,kh+=Fh-1,Ch-=Fh*a,Gh+=Fh,Nh.push({frame:c,dTicks:Fh}),null===(u=Jf)||void 0===u||u.startPhysicsStep(c,Fh),!(Nh.length>1)){t.next=32;break}if(void 0===(Bh=Nh.shift())){t.next=32;break}return t.next=28,ne(Bh.frame);case 28:l=zf.getFrameComputeTime(),Lh=l/1e3,Go.T.fixedUpdate(Lh),null===(s=Jf)||void 0===s||s.fixedUpdate(Bh.frame,Bh.dTicks);case 32:t.next=15;break;case 34:f=Ch/a,i>a&&(y=null!==(h=null===(p=Bh)||void 0===p?void 0:p.dTicks)&&void 0!==h?h:1,f=1-1/y+Rh/a/y),Rh=Ch,ah.update(i),Xf.update(i),Yf.update(),null===(r=Jf)||void 0===r||r.update(i,f),Qf.render(i),bh.run(i,e),requestAnimationFrame(Uh),d=performance.now(),Th=1/o,_h=d-n,Go.T.update(Ah,Th,_h);case 48:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},71355:(t,e,r)=>{r.d(e,{Q:()=>et,A:()=>tt});var n=r(82140),o=r(71274),i=r(56642),a=r(74650),u=r(48418);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function s(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||h(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(){l=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new C(n||[]);return o(a,"_invoke",{value:T(t,r,u)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var y="suspendedStart",d="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function S(){}var x={};f(x,a,(function(){return this}));var O=Object.getPrototypeOf,P=O&&O(O(A([])));P&&P!==r&&n.call(P,a)&&(x=P);var E=S.prototype=g.prototype=Object.create(x);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=p(t[o],t,i);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==c(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function T(e,r,n){var o=y;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=_(u,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===y)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var s=p(e,r,n);if("normal"===s.type){if(o=n.done?m:d,s.arg===b)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=m,n.method="throw",n.arg=s.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(c(e)+" is not iterable")}return w.prototype=S,o(E,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=f(S,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,S):(t.__proto__=S,f(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(k.prototype),f(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(h(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),f(E,s,"Generator"),f(E,a,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function f(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=h(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function h(t,e){if(t){if("string"==typeof t)return p(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function y(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function d(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){y(i,n,o,a,u,"next",t)}function u(t){y(i,n,o,a,u,"throw",t)}a(void 0)}))}}function v(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,b(n.key),n)}}function m(t,e,r){return(e=b(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b(t){var e=function(t,e){if("object"!=c(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==c(e)?e:e+""}var g=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.music=e,m(this,"radioType",void 0),m(this,"initialLoad",!1)},e=[{key:"init",value:(c=d(l().mark((function t(){var e,r,n,o;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.music.songQueue.length>0)){t.next=2;break}return t.abrupt("return");case 2:e=a.q,u.ZW.firstTime||(e=(0,i.Z)(a.q)),r=f(e);try{for(r.s();!(n=r.n()).done;)o=n.value,this.music.queueSong(o,1)}catch(t){r.e(t)}finally{r.f()}this.music.play(),this.initialLoad=!0;case 8:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"initMapRadio",value:(o=d(l().mark((function t(e){var r,n,o,u,c,h;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.music.songQueue.length>0)){t.next=2;break}return t.abrupt("return");case 2:r=a.O[e],n=(0,i.Z)(a.q).filter((function(t){return t.title!==r.title})),o=[r].concat(s(n)),u=f(o);try{for(u.s();!(c=u.n()).done;)h=c.value,this.music.queueSong(h,1)}catch(t){u.e(t)}finally{u.f()}this.music.play();case 8:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"correctMenuRadio",value:(n=d(l().mark((function t(){var e,r,n,o,u;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.initialLoad){t.next=2;break}return t.abrupt("return");case 2:if(!(this.music.songQueue.length>1)){t.next=4;break}return t.abrupt("return");case 4:e=(0,i.Z)(a.q),1===this.music.songQueue.length&&this.music.currentSong&&(this.music.currentSong.numLoops=1,this.music.currentSong.currentNumLoops=0,r=this.music.currentSong.song.title,e=e.filter((function(t){return t.title!==r}))),n=f(e);try{for(n.s();!(o=n.n()).done;)u=o.value,this.music.queueSong(u,1)}catch(t){n.e(t)}finally{n.f()}case 8:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}],e&&v(t.prototype,e),r&&v(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,c}(),w=r(50602),S=r(13268);function x(t){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x(t)}function O(){O=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new C(n||[]);return o(a,"_invoke",{value:T(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,P=S&&S(S(A([])));P&&P!==r&&n.call(P,a)&&(w=P);var E=g.prototype=m.prototype=Object.create(w);function j(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==x(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function T(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=_(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(x(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(k.prototype),s(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),s(E,c,"Generator"),s(E,a,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function P(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function E(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){P(i,n,o,a,u,"next",t)}function u(t){P(i,n,o,a,u,"throw",t)}a(void 0)}))}}function j(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,T(n.key),n)}}function k(t,e,r){return(e=T(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T(t){var e=function(t,e){if("object"!=x(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=x(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==x(e)?e:e+""}var _=S.tq?6:20,L=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=null,r=[{key:"getBuffer",value:(o=E(O().mark((function t(e,r){var n;return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.cache.has(r)){t.next=8;break}return this.cache.size>=_&&this.evictCacheItem(),n=this.loadBuffer(e,r),this.cache.set(r,n),this.accessOrder.push(r),t.abrupt("return",n);case 8:return this.updateAccessOrder(r),t.abrupt("return",this.cache.get(r));case 10:case"end":return t.stop()}}),t,this)}))),function(t,e){return o.apply(this,arguments)})},{key:"evictCacheItem",value:function(){var t=this.accessOrder.shift();t&&this.cache.delete(t)}},{key:"updateAccessOrder",value:function(t){var e=this.accessOrder.indexOf(t);e>-1&&this.accessOrder.splice(e,1),this.accessOrder.push(t)}},{key:"loadBuffer",value:(n=E(O().mark((function t(e,r){var n,o;return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(r);case 2:return n=t.sent,t.next=5,n.arrayBuffer();case 5:return o=t.sent,t.abrupt("return",e.decodeAudioData(o));case 7:case"end":return t.stop()}}),t)}))),function(t,e){return n.apply(this,arguments)})}],e&&j(t.prototype,e),r&&j(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function I(t){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(t)}function C(){C=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(A([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==I(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(I(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function A(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function M(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,N(n.key),n)}}function R(t,e,r){return(e=N(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function N(t){var e=function(t,e){if("object"!=I(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=I(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==I(e)?e:e+""}k(L,"cache",new Map),k(L,"accessOrder",[]);var D=function(){return t=function t(e,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=e,R(this,"loadedPromise",void 0),R(this,"isLoaded",!1),R(this,"paused",!0),R(this,"gainNode",void 0),R(this,"buffer",void 0),R(this,"sourceNode",void 0),R(this,"startTime",0),R(this,"pauseTime",0),this.gainNode=this.context.createGain(),this.loadedPromise=L.getBuffer(e,r).then((function(t){n.buffer=t,n.isLoaded=!0}))},e=[{key:"duration",get:function(){return this.buffer.duration}},{key:"currentTime",get:function(){return this.paused?this.pauseTime:this.context.currentTime-this.startTime},set:function(t){t<0||t>this.duration?console.error("BufferedAudio: Invalid time value"):(this.pauseTime=t,this.paused||this.play())}},{key:"volume",get:function(){return this.gainNode.gain.value},set:function(t){this.gainNode.gain.value=Math.max(0,Math.min(t,1))}},{key:"start",value:(n=C().mark((function t(){return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadedPromise;case 2:this.play();case 3:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){A(i,r,o,a,u,"next",t)}function u(t){A(i,r,o,a,u,"throw",t)}a(void 0)}))},function(){return o.apply(this,arguments)})},{key:"play",value:function(){var t=this;if(this.paused){this.sourceNode=this.context.createBufferSource(),this.sourceNode.buffer=this.buffer,this.sourceNode.connect(this.gainNode);var e=this.pauseTime;this.sourceNode.start(0,e),this.startTime=this.context.currentTime-e,this.paused=!1,this.sourceNode.onended=function(){t.reset()}}}},{key:"pause",value:function(){var t,e;this.paused||(this.sourceNode&&(this.sourceNode.onended=null),this.pauseTime=this.context.currentTime-this.startTime,null===(t=this.sourceNode)||void 0===t||t.stop(),null===(e=this.sourceNode)||void 0===e||e.disconnect(),this.paused=!0)}},{key:"reset",value:function(){this.pause(),this.gainNode.disconnect(),this.pauseTime=0}}],e&&M(t.prototype,e),r&&M(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function F(){F=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==B(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(B(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function G(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function U(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){G(i,n,o,a,u,"next",t)}function u(t){G(i,n,o,a,u,"throw",t)}a(void 0)}))}}function z(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,V(n.key),n)}}function W(t,e,r){return(e=V(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function V(t){var e=function(t,e){if("object"!=B(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=B(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==B(e)?e:e+""}var H=function(){return t=function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=e,this.song=r,this.numLoops=n,W(this,"loaded",void 0),W(this,"audioFlow",void 0),W(this,"playtime",0),W(this,"currentNumLoops",void 0),W(this,"audio",[]),W(this,"currentAudioIndex",0),W(this,"nextAudioIndex",void 0),W(this,"fadeOutCounter",0),this.currentNumLoops=n,this.audioFlow=new w.Z},e=[{key:"load",value:function(){this.loaded=this.loadBuffers()}},{key:"loadBuffers",value:(i=U(F().mark((function t(){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"loop"===this.song.type?(this.audio=[new D(this.context,this.song.introSrc),new D(this.context,this.song.loopSrc),new D(this.context,this.song.loopSrc)],this.nextAudioIndex=1):this.audio=[new D(this.context,this.song.src)];case 1:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"isPlaying",get:function(){return!1===this.currentBufferedAudio.paused||!this.currentBufferedAudio.isLoaded}},{key:"currentBufferedAudio",get:function(){return this.audio[this.currentAudioIndex]}},{key:"nextBufferedAudio",get:function(){return void 0!==this.nextAudioIndex?this.audio[this.nextAudioIndex]:void 0}},{key:"play",value:(o=U(F().mark((function t(){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loaded||this.load(),t.next=3,this.loaded;case 3:return t.next=5,this.currentBufferedAudio.start();case 5:this.audioFlow.push(this.currentBufferedAudio);case 6:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"pause",value:function(){this.currentBufferedAudio.pause()}},{key:"fadeOut",value:function(){this.fadeOutCounter=1}},{key:"reset",value:function(){this.audio.forEach((function(t){return t.reset()})),this.playtime=0,this.currentAudioIndex=0,this.nextAudioIndex="loop"===this.song.type?1:void 0,this.fadeOutCounter=0,this.currentNumLoops=this.numLoops}},{key:"skipTo",value:(n=U(F().mark((function t(e){var r;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.reset(),t.next=3,this.currentBufferedAudio.loadedPromise;case 3:r=0;case 4:if(!(e<r+this.currentBufferedAudio.duration)){t.next=8;break}return this.play(),this.currentBufferedAudio.currentTime=e-r,t.abrupt("return");case 8:r+=this.currentBufferedAudio.duration,this.updateAudioPointers();case 10:if(void 0!==this.nextAudioIndex){t.next=4;break}case 11:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"update",value:function(t){this.isPlaying&&!1!==this.currentBufferedAudio.isLoaded&&(this.playtime+=t,this.currentBufferedAudio.duration-this.currentBufferedAudio.currentTime<=tt&&(this.nextBufferedAudio&&this.nextBufferedAudio.paused&&(this.nextBufferedAudio.start(),this.audioFlow.push(this.nextBufferedAudio)),this.updateAudioPointers()),this.updateFadeOut(t))}},{key:"updateAudioPointers",value:function(){if(void 0===this.nextAudioIndex)this.audioFlow.push(void 0);else{var t=0===this.currentAudioIndex?this.nextAudioIndex+1:this.currentAudioIndex;this.currentAudioIndex=this.nextAudioIndex,0===this.currentNumLoops?this.nextAudioIndex=void 0:(this.nextAudioIndex=t,this.currentNumLoops--)}}},{key:"updateFadeOut",value:function(t){var e=void 0===this.nextBufferedAudio,r="loop"===this.song.type;e&&r&&this.currentBufferedAudio.currentTime>=10&&this.fadeOutCounter<=0&&(this.fadeOutCounter=5),this.fadeOutCounter>0&&(this.currentBufferedAudio.volume=this.fadeOutCounter/5,this.fadeOutCounter-=t,this.fadeOutCounter<=0&&(this.currentBufferedAudio.pause(),this.currentBufferedAudio.volume=1,this.audioFlow.push(void 0)))}}],e&&z(t.prototype,e),r&&z(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i}(),q=r(3406);function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function K(){K=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==X(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(X(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Y(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function J(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Y(i,n,o,a,u,"next",t)}function u(t){Y(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Z(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$(n.key),n)}}function Q(t,e,r){return(e=$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $(t){var e=function(t,e){if("object"!=X(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=X(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==X(e)?e:e+""}var tt=2.5,et=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Q(this,"radio",void 0),Q(this,"context",void 0),Q(this,"analyser",void 0),Q(this,"biquadFilter",void 0),Q(this,"gainNode",void 0),Q(this,"bufferData",void 0),Q(this,"connectedAudios",new Set),Q(this,"targetFrequency",1e4),Q(this,"muffleLerpTime",0),Q(this,"songCache",new Map),Q(this,"songQueue",[]),Q(this,"currentSongIndex",0),Q(this,"betweenSongTimer",0),Q(this,"stopAfterFadeOut",!1),Q(this,"paused",!0),this.context=q.H.getContext(),this.radio=new g(this),this.analyser=this.context.createAnalyser(),this.analyser.fftSize=S.tq?256:2048,this.analyser.smoothingTimeConstant=.9,this.biquadFilter=this.context.createBiquadFilter(),this.biquadFilter.type="lowpass",this.gainNode=this.context.createGain(),this.analyser.connect(this.biquadFilter),this.biquadFilter.connect(this.gainNode),this.gainNode.connect(this.context.destination),this.bufferData=new Uint8Array(this.analyser.frequencyBinCount),this.setVolume(u.Xd.audio.music*u.Xd.audio.master)},e=[{key:"isPlaying",value:function(){var t;return(null===(t=this.currentSong)||void 0===t?void 0:t.isPlaying)||!1}},{key:"currentSong",get:function(){if(0!==this.songQueue.length)return this.songQueue[this.currentSongIndex]}},{key:"nextSong",get:function(){if(0!==this.songQueue.length)return this.songQueue[(this.currentSongIndex+1)%this.songQueue.length]}},{key:"fullReset",value:(f=J(K().mark((function t(){return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.songQueue.forEach((function(t){return t.reset()})),this.songQueue=[],this.currentSongIndex=0,this.betweenSongTimer=0,this.stopAfterFadeOut=!1,this.paused=!0;case 6:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)})},{key:"getAudioData",value:function(){var t;return null!==(t=this.currentSong)&&void 0!==t&&t.isPlaying&&this.analyser.getByteFrequencyData(this.bufferData),this.bufferData}},{key:"clearBufferData",value:function(){this.bufferData.fill(0)}},{key:"muffle",value:function(t){this.targetFrequency=t?400:1e4,this.muffleLerpTime=0}},{key:"setVolume",value:function(t){this.gainNode.gain.value=Math.max(0,Math.min(t,1))}},{key:"fadeToStop",value:function(){var t;null===(t=this.currentSong)||void 0===t||t.fadeOut(),this.stopAfterFadeOut=!0}},{key:"connectAudioNodes",value:function(t){if(!t)return this.stopAfterFadeOut&&(this.paused=!0,this.stopAfterFadeOut=!1),void this.clearBufferData();t.gainNode.connect(this.analyser),this.currentSong&&n.h.dispatch((0,o.lr)(this.currentSong.song))}},{key:"play",value:(l=J(K().mark((function t(){return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.currentSong){t.next=2;break}return t.abrupt("return");case 2:if(0!==this.betweenSongTimer){t.next=6;break}return t.next=5,this.currentSong.play();case 5:n.h.dispatch((0,o.lr)(this.currentSong.song));case 6:this.paused=!1;case 7:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"pause",value:(s=J(K().mark((function t(){var e;return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null===(e=this.currentSong)||void 0===e||e.pause(),this.paused=!0;case 2:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"skipForward",value:(c=J(K().mark((function t(){var e;return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.currentSong){t.next=2;break}return t.abrupt("return");case 2:return this.currentSong.reset(),this.currentSongIndex<this.songQueue.length-1?this.currentSongIndex++:this.currentSongIndex=0,t.next=6,this.currentSong.play();case 6:null===(e=this.nextSong)||void 0===e||e.load(),n.h.dispatch((0,o.lr)(this.currentSong.song));case 8:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"skipBackward",value:(a=J(K().mark((function t(){return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.currentSong){t.next=2;break}return t.abrupt("return");case 2:if(!(this.currentSong.playtime>5)){t.next=7;break}return this.currentSong.reset(),t.next=6,this.currentSong.play();case 6:return t.abrupt("return");case 7:return this.currentSong.reset(),this.currentSongIndex>0?this.currentSongIndex--:this.currentSongIndex=this.songQueue.length-1,t.next=11,this.currentSong.play();case 11:n.h.dispatch((0,o.lr)(this.currentSong.song));case 12:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"queueSong",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=this.songCache.get(t);r?(r.currentNumLoops=e,r.numLoops=e):((r=new H(this.context,t,e)).audioFlow.addListener(this.connectAudioNodes.bind(this)),this.songCache.set(t,r)),this.songQueue.find((function(e){return e.song===t}))||(this.songQueue.length<2&&r.load(),this.songQueue.push(r))}},{key:"skipTo",value:(i=J(K().mark((function t(e){var r;return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null===(r=this.currentSong)||void 0===r||r.skipTo(e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"update",value:function(t){var e,r;this.updateMuffle(t),null!==(e=this.currentSong)&&void 0!==e&&e.isPlaying?null===(r=this.currentSong)||void 0===r||r.update(t):this.paused||(this.betweenSongTimer+=t,this.betweenSongTimer>=3&&(this.skipForward(),this.betweenSongTimer=0))}},{key:"updateMuffle",value:function(t){if(this.muffleLerpTime<.5){var e=this.muffleLerpTime/.5,r=this.biquadFilter.frequency.value+(this.targetFrequency-this.biquadFilter.frequency.value)*e;this.biquadFilter.frequency.value=r,this.muffleLerpTime+=t}}}],e&&Z(t.prototype,e),r&&Z(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,i,a,c,s,l,f}()},10745:(t,e,r)=>{r.d(e,{D:()=>o});var n=new(r(5071).P),o=function(t,e,r){n.set(0,0,1).applyQuaternion(r),t.panner.positionX?(t.panner.positionX.value=e.x,t.panner.positionY.value=e.y,t.panner.positionZ.value=e.z,t.panner.orientationX.value=n.x,t.panner.orientationY.value=n.y,t.panner.orientationZ.value=n.z):(t.panner.setPosition(e.x,e.y,e.z),t.panner.setOrientation(n.x,n.y,n.z))}},83484:(t,e,r)=>{r.d(e,{D:()=>s});var n=r(5071),o=r(48418);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,c(n.key),n)}}function u(t,e,r){return(e=c(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}var s=function(){return t=function t(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,"position",new n.P),u(this,"lookAtPosition",new n.P),u(this,"zoom",1),u(this,"fov",75),u(this,"camera",void 0),u(this,"previousPosition",new n.P),this.camera=null!=e?e:o.Ts.camera,r||(this.camera.zoom=1,this.camera.fov=75,this.camera.updateProjectionMatrix())},(e=[{key:"update",value:function(t,e){isNaN(this.position.length())||isNaN(this.lookAtPosition.length())||(this.camera.position.copy(this.position),this.camera.lookAt(this.lookAtPosition),this.camera.zoom=this.zoom,this.camera.fov=this.fov,this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.camera.updateProjectionMatrix())}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()},50382:(t,e,r)=>{r.d(e,{Y:()=>j});var n=r(5071),o=r(49582),i=r(21198),a=r(83484),u=r(48418),c=r(4003),s=r(82140);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,b(n.key),n)}}function h(t,e,r){return e=d(e),function(t,e){if(e&&("object"==l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,p()?Reflect.construct(e,r||[],d(t).constructor):e.apply(t,r))}function p(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(p=function(){return!!t})()}function y(){return y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},y.apply(null,arguments)}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function v(t,e){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},v(t,e)}function m(t,e,r){return(e=b(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b(t){var e=function(t,e){if("object"!=l(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==l(e)?e:e+""}var g=4,w=3.5,S=1.75,x=.2,O=1.2,P=6,E=2.5,j=function(t){function e(t){var r,a,u,c,l,f,p,y,d;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),m(d=h(this,e),"follow",void 0),m(d,"config",void 0),m(d,"driftAdjustment",void 0),m(d,"targetPos",void 0),m(d,"fovDistanceAdj",void 0),m(d,"distance",void 0),m(d,"driftSideAdjustment",void 0),m(d,"_e",void 0),m(d,"targetDriftAdj",new n.P),m(d,"skipLerp",void 0),m(d,"isPortrait",void 0),m(d,"rotateSubscribeListener",void 0),m(d,"setTarget",(function(t){if(!(t instanceof i.l))throw new Error("Can only follow cars");d.follow=t})),m(d,"getTarget",(function(){return d.follow})),d.config={distance:null!==(r=null==t?void 0:t.distance)&&void 0!==r?r:g,height:null!==(a=null==t?void 0:t.height)&&void 0!==a?a:w,lookAbove:null!==(u=null==t?void 0:t.lookAbove)&&void 0!==u?u:S,damping:null!==(c=null==t?void 0:t.damping)&&void 0!==c?c:x,zoomFactor:null!==(l=null==t?void 0:t.zoomFactor)&&void 0!==l?l:O,clippingDistance:null!==(f=null==t?void 0:t.clippingDistance)&&void 0!==f?f:P,overrideFov:null==t?void 0:t.overrideFov,overrideZoom:null==t?void 0:t.overrideZoom,angle:null==t?void 0:t.angle},d.skipLerp=null===(p=null==t?void 0:t.skipLerp)||void 0===p||p,d.distance=d.config.distance,d.driftSideAdjustment=null!==(y=d.config.driftSideAdjustment)&&void 0!==y?y:E,d.driftAdjustment=new n.P,d.targetPos=new n.P,d.fov=75,d.fovDistanceAdj=0,d._e=new o.U,d._e.reorder("ZXY"),d.isPortrait=s.h.getState().ui.isPortrait,d.adjustForPoraitmode(t),d.rotateSubscribeListener=s.h.subscribe((function(){var e=s.h.getState();d.isPortrait!==e.ui.isPortrait&&(d.isPortrait=e.ui.isPortrait,d.adjustForPoraitmode(t))})),d}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v(t,e)}(e,t),r=e,a=[{key:"adjustForPoraitmode",value:function(t){var e;this.distance=(null!==(e=null==t?void 0:t.distance)&&void 0!==e?e:g)+(this.isPortrait?2.5:0),this.driftSideAdjustment=this.isPortrait?1.3:2.5}},{key:"getBounceFactor",value:function(t){var e=1*t>.7,r=1*t-Math.PI/20;return{factor:-Math.sin(20*r)*(1/r)*.03,done:e}}},{key:"update",value:function(t,r){var o,i,a,s,l;if(this.follow&&!this.follow.isKilled()&&!this.follow.entity.isKilled()){var f=this.follow.entity.getVelocity(),h=new n.P(f.x(),0,f.z()),p=this.follow.worldPosition,v=null!==(o=null===(i=this.config.angle)||void 0===i?void 0:i.x)&&void 0!==o?o:u.qH.clientInputs.camX,m=null!==(a=null===(s=this.config.angle)||void 0===s?void 0:s.y)&&void 0!==a?a:u.qH.clientInputs.camY,b=Math.atan2(v,m);this._e.setFromQuaternion(this.follow.entityQuaternion);var g=Math.PI/2-this._e.y;b+=g;var w=40*t;this.follow.entity.isBoosting()&&this.follow.entity.getSpeed()>this.follow.entity.getMaxSpeed()?this.fov+w<103&&(this.fov+=w,this.fovDistanceAdj+=.04*w):this.fov-w>75&&(this.fov-=w,this.fovDistanceAdj-=.04*w),this.fov=null!==(l=this.config.overrideFov)&&void 0!==l?l:this.fov,this.config.overrideZoom&&(this.zoom=this.config.overrideZoom);var S=this.driftSideAdjustment,x=this.follow.entity.isDrifting();this.lookAtPosition=p.clone().setY(p.y+this.config.lookAbove);var O=0;x===c.XA.LEFT?(g-=Math.PI/2,this.targetDriftAdj.set(Math.cos(g),0,Math.sin(g)).multiplyScalar(S),O=-.5):x===c.XA.RIGHT?(g+=Math.PI/2,this.targetDriftAdj.set(Math.cos(g),0,Math.sin(g)).multiplyScalar(S),O=-.5):this.targetDriftAdj.set(0,0,0),this.driftAdjustment.lerp(this.targetDriftAdj,1.5*t),this.lookAtPosition.add(this.driftAdjustment),0!==v||0!==m||h.length()<30?this.targetPos.set(Math.cos(b),0,Math.sin(b)):this.targetPos.set(h.x,0,h.z);var P,E,j,k,T,_=this.distance+(this.follow.isLargeVehicle()?2:0),L=this.config.height+(this.follow.isLargeVehicle()?.5:0);this.targetPos.normalize().multiplyScalar(-1*_).setY(L+O).add(p),this.skipLerp?(this.position.copy(this.targetPos),this.skipLerp=!1):this.position.lerp(this.targetPos,Math.min(30*t,1)),(P=e,E="update",j=this,T=y(d(1&(k=3)?P.prototype:P),E,j),2&k?function(t){return T.apply(j,t)}:T)([t,r])}}},{key:"changeAngle",value:function(t){this.config.angle=t}},{key:"dispose",value:function(){var t;null===(t=this.rotateSubscribeListener)||void 0===t||t.call(this)}}],a&&f(r.prototype,a),l&&f(r,l),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,a,l}(a.D)},83492:(t,e,r)=>{r.d(e,{w:()=>a});var n=r(70042),o=r(5421);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}var a=function(t){t.geometry.dispose(),t.children.forEach((function(t){t instanceof n.V&&t.stop()})),(0,o.h)(t.material,u)},u=function(t){t.dispose();for(var e=0,r=Object.keys(t);e<r.length;e++){var n=t[r[e]];n&&"object"===i(n)&&"minFilter"in n&&n.dispose()}}},85958:(t,e,r)=>{r.d(e,{N:()=>b,s:()=>g});var n=r(25701),o=r(3173),i=r(48418),a=r(50602);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(){c=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new C(n||[]);return o(a,"_invoke",{value:T(t,r,u)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var y="suspendedStart",d="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function S(){}var x={};f(x,a,(function(){return this}));var O=Object.getPrototypeOf,P=O&&O(O(A([])));P&&P!==r&&n.call(P,a)&&(x=P);var E=S.prototype=g.prototype=Object.create(x);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,c){var s=p(t[o],t,i);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==u(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function T(e,r,n){var o=y;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=_(u,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===y)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var s=p(e,r,n);if("normal"===s.type){if(o=n.done?m:d,s.arg===b)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=m,n.method="throw",n.arg=s.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(u(e)+" is not iterable")}return w.prototype=S,o(E,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=f(S,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,S):(t.__proto__=S,f(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(k.prototype),f(k.prototype,s,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(h(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),f(E,l,"Generator"),f(E,a,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function s(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function l(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){s(i,n,o,a,u,"next",t)}function u(t){s(i,n,o,a,u,"throw",t)}a(void 0)}))}}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,m(n.key),n)}}function h(t,e,r){return e=y(e),function(t,e){if(e&&("object"==u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,p()?Reflect.construct(e,r||[],y(t).constructor):e.apply(t,r))}function p(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(p=function(){return!!t})()}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}function d(t,e){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},d(t,e)}function v(t,e,r){return(e=m(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m(t){var e=function(t,e){if("object"!=u(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==u(e)?e:e+""}var b="dev"===r(85285).Vi?"1233174424614731786":"1070111026420391997",g=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),v(r=h(this,e,[t]),"sdkId","discord"),v(r,"discordSdk",void 0),v(r,"user",void 0),v(r,"accessToken",void 0),v(r,"speaking",void 0),v(r,"voiceState",void 0),r.discordSdk=new n.ho(b),r.speaking=new a.Z,r.voiceState=new a.Z,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(e,t),r=e,o=[{key:"init",value:(g=l(c().mark((function t(){var e,r,o,a,u,s=this;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(0,n.hN)([{prefix:"/com/googleapis/identitytoolkit",target:"identitytoolkit.googleapis.com"},{prefix:"/com/googleapis/securetoken",target:"securetoken.googleapis.com"},{prefix:"/com/amplitude/api2",target:"api2.amplitude.com"},{prefix:"/io/drift/assets",target:"assets.drift.io"},{prefix:"/com/unpkg",target:"unpkg.com"}]),t.next=3,this.discordSdk.ready();case 3:return t.next=5,this.discordSdk.commands.authorize({client_id:b,response_type:"code",state:"",prompt:"none",scope:["identify","rpc.voice.read"]});case 5:return e=t.sent,r=e.code,t.next=9,i.xs.discordAuth.authenticateSdk(r);case 9:return o=t.sent,a=o.access_token,t.next=13,this.discordSdk.commands.authenticate({access_token:a});case 13:return u=t.sent,this.user=u.user,this.accessToken=a,this.discordSdk.channelId&&(this.discordSdk.subscribe("SPEAKING_START",function(){var t=l(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.speaking.push({userId:e.user_id,speaking:!0});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),{channel_id:this.discordSdk.channelId}),this.discordSdk.subscribe("SPEAKING_STOP",function(){var t=l(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.speaking.push({userId:e.user_id,speaking:!1});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),{channel_id:this.discordSdk.channelId}),this.discordSdk.subscribe("VOICE_STATE_UPDATE",function(){var t=l(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.voiceState.push({userId:e.user.id,voiceState:e.voice_state});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),{channel_id:this.discordSdk.channelId})),t.next=19,this.discordSdk.commands.encourageHardwareAcceleration();case 19:case"end":return t.stop()}}),t,this)}))),function(){return g.apply(this,arguments)})},{key:"playAd",value:(m=l(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return");case 1:case"end":return t.stop()}}),t)}))),function(){return m.apply(this,arguments)})},{key:"rewardAd",value:(y=l(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",!1);case 1:case"end":return t.stop()}}),t)}))),function(){return y.apply(this,arguments)})},{key:"openInviteDialog",value:(p=l(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.discordSdk.commands.openInviteDialog();case 2:case"end":return t.stop()}}),t,this)}))),function(){return p.apply(this,arguments)})},{key:"getConnectionId",value:function(){return this.discordSdk.instanceId}},{key:"getCurrentUser",value:function(){return this.user}},{key:"getParticipantInfo",value:(s=l(c().mark((function t(){var e,r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.discordSdk.commands.getInstanceConnectedParticipants();case 2:return e=t.sent,r={},e.participants.forEach((function(t){r[t.id]=t})),t.abrupt("return",r);case 6:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"getAccessToken",value:function(){return this.accessToken}}],o&&f(r.prototype,o),u&&f(r,u),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,u,s,p,y,m,g}(o.z)},3173:(t,e,r)=>{r.d(e,{z:()=>h});var n=r(9332);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function u(){u=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var o=e&&e.prototype instanceof g?e:g,a=Object.create(o.prototype),u=new C(n||[]);return i(a,"_invoke",{value:T(t,r,u)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var y="suspendedStart",d="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function S(){}var x={};f(x,c,(function(){return this}));var O=Object.getPrototypeOf,P=O&&O(O(A([])));P&&P!==r&&n.call(P,c)&&(x=P);var E=S.prototype=g.prototype=Object.create(x);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(i,a,u,c){var s=p(t[i],t,a);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==o(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,u,c)}),(function(t){r("throw",t,u,c)})):e.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,c)}))}c(s.arg)}var a;i(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function T(e,r,n){var o=y;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=_(u,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===y)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var s=p(e,r,n);if("normal"===s.type){if(o=n.done?m:d,s.arg===b)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=m,n.method="throw",n.arg=s.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(o(e)+" is not iterable")}return w.prototype=S,i(E,"constructor",{value:S,configurable:!0}),i(S,"constructor",{value:w,configurable:!0}),w.displayName=f(S,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,S):(t.__proto__=S,f(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(k.prototype),f(k.prototype,s,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(h(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),f(E,l,"Generator"),f(E,c,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function c(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function s(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){c(i,n,o,a,u,"next",t)}function u(t){c(i,n,o,a,u,"throw",t)}a(void 0)}))}}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f(n.key),n)}}function f(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var h=function(){return t=function t(e){var r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=e,r=this,o=void 0,(n=f(n="sdkId"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o},e=[{key:"hasAdBlock",value:(p=s(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",!1);case 1:case"end":return t.stop()}}),t)}))),function(){return p.apply(this,arguments)})},{key:"pageLoaded",value:function(){(0,n.Z)()}},{key:"gameplayStart",value:(h=s(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(0,n.Z)();case 1:case"end":return t.stop()}}),t)}))),function(){return h.apply(this,arguments)})},{key:"gameplayStop",value:(c=s(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(0,n.Z)();case 1:case"end":return t.stop()}}),t)}))),function(){return c.apply(this,arguments)})},{key:"happyTime",value:function(){(0,n.Z)()}},{key:"is",value:function(){for(var t=this,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.some((function(e){return e===t.sdkId}))}},{key:"getUrlParam",value:(a=s(u().mark((function t(e){var r,n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new URLSearchParams(window.location.href),t.abrupt("return",null!==(r=n.get(e))&&void 0!==r?r:void 0);case 2:case"end":return t.stop()}}),t)}))),function(t){return a.apply(this,arguments)})},{key:"getShareableUrl",value:(o=s(u().mark((function t(e){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new URL(window.location.origin),e&&Object.entries(e).forEach((function(t){var e=i(t,2),n=e[0],o=e[1];r.searchParams.append(n,o)})),t.abrupt("return",r.toString());case 3:case"end":return t.stop()}}),t)}))),function(t){return o.apply(this,arguments)})},{key:"pauseGame",value:function(){var t;null===(t=this.config.three)||void 0===t||t.audioListener.setMasterVolume(0)}},{key:"resumeGame",value:function(){this.config.settings&&this.config.three&&this.config.three.audioListener.setMasterVolume(this.config.settings.audio.master*this.config.settings.audio.sfx)}},{key:"trackAdShownAttempt",value:function(t){var e;null===(e=this.config.tracking)||void 0===e||e.trackEvent("AdShownAttempt",{adType:t})}},{key:"trackAdShown",value:function(t){var e;null===(e=this.config.tracking)||void 0===e||e.trackEvent("AdShown",{adType:t})}}],e&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,o,a,c,h,p}()},40186:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s(n.key),n)}}function i(t,e,r){return e=u(e),function(t,e){if(e&&("object"==n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,a()?Reflect.construct(e,r||[],u(t).constructor):e.apply(t,r))}function a(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(a=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function c(t,e){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},c(t,e)}function s(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}r.d(e,{q:()=>l});var l=function(t){function e(){var t,r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var a=arguments.length,u=new Array(a),c=0;c<a;c++)u[c]=arguments[c];return t=i(this,e,[].concat(u)),r=t,o=0,(n=s(n="spectatorCameraType"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(e,t),r=e,n&&o(r.prototype,n),a&&o(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(r(1016).xs)},1016:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s(n.key),n)}}function i(t,e,r){return e=u(e),function(t,e){if(e&&("object"==n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,a()?Reflect.construct(e,r||[],u(t).constructor):e.apply(t,r))}function a(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(a=function(){return!!t})()}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function c(t,e){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},c(t,e)}function s(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}r.d(e,{xs:()=>x,AP:()=>w,zR:()=>S});var l=function(t){function e(t){var r,n,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=i(this,e)).type=t,n=r,a="map",(o=s(o="staticEntityId"))in n?Object.defineProperty(n,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[o]=a,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(e,t),r=e,(n=[{key:"update",value:function(t,e){}},{key:"collisionStarted",value:function(t,e){}},{key:"collisionStopped",value:function(t){}},{key:"fixedUpdate",value:function(){}},{key:"destroy",value:function(){}},{key:"getType",value:function(){return this.type}}])&&o(r.prototype,n),a&&o(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(r(82491).G),f=r(48418),h=r(85285),p=r(11590);function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function d(){d=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new C(n||[]);return o(a,"_invoke",{value:T(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function S(){}var x={};s(x,a,(function(){return this}));var O=Object.getPrototypeOf,P=O&&O(O(A([])));P&&P!==r&&n.call(P,a)&&(x=P);var E=S.prototype=g.prototype=Object.create(x);function j(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==y(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function T(e,r,n){var o=h;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=_(u,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?m:p,s.arg===b)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=m,n.method="throw",n.arg=s.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(y(e)+" is not iterable")}return w.prototype=S,o(E,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=s(S,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,S):(t.__proto__=S,s(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(k.prototype),s(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),s(E,c,"Generator"),s(E,a,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function v(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,g(n.key),n)}}function b(t,e,r){return(e=g(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g(t){var e=function(t,e){if("object"!=y(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==y(e)?e:e+""}var w=function(t){var e=t.entity.is_enabled();t.enabled&&!e?t.onDisable():!t.enabled&&e&&t.onEnable(),t.updateCount++,(t.enabled||t.updateCount%20==0)&&t.fixedUpdate()},S=function(t,e,r){(t.enabled||t.updateCount%20==0)&&t.update(e,r)},x=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),b(this,"entities",void 0),b(this,"collisions",void 0),b(this,"timeoutTracker",void 0),b(this,"memoizedEntities",new Map),this.entities={},this.collisions={},this.timeoutTracker=[]},e=[{key:"addEntity",value:function(t){this.entities[t.eid]=t}},{key:"removeEntity",value:function(t){this.entities[t]&&(this.entities[t].destroy(),delete this.entities[t])}},{key:"update",value:function(t,e){f.CO.sceneGraphUpdate(t,e,!1),f.Xx.update(t,e),h.qZ&&p.xo&&(0!==p.xo.index&&(p.R9.attributes.position.needsUpdate=!0),p.R9.setDrawRange(0,p.xo.index),p.xo.update())}},{key:"startPhysicsStep",value:function(t,e){f.CO.update(t,t,e,f.Ts.getCameraMatrecies())}},{key:"safeTimeout",value:function(t,e){var r=this,n=setTimeout((function(){r.timeoutTracker=r.timeoutTracker.filter((function(t){return t!==n})),t()}),e);return this.timeoutTracker.push(n),n}},{key:"fixedUpdate",value:function(t,e){this.checkCollisions(),f.Xx.fixedUpdate(t)}},{key:"checkCollisions",value:function(){for(var t=f.js.getNumCollisions(),e={},r=0;r<t;r++){var n=f.js.getEntityIdA(r),o=f.js.getEntityIdB(r),i=[n,o].sort().join("-");if(e[i]=!0,!this.collisions[i]){var a,u,c,s,l=this.entities[n],h=this.entities[o];l||(l=this.getMapEntity(f.js.getEntityTypeA(r))),h||(h=this.getMapEntity(f.js.getEntityTypeB(r)));var p={entityA:l,entityB:h};this.collisions[i]=p,l.enabled&&(null===(a=(u=l).collisionStarted)||void 0===a||a.call(u,h,f.js.getForce(r))),h.enabled&&(null===(c=(s=h).collisionStarted)||void 0===c||c.call(s,l,f.js.getForce(r)))}}for(var y in this.collisions){var d,v;if(!e[y]){var m=this.collisions[y],b=m.entityA,g=m.entityB;null===(d=b.collisionStopped)||void 0===d||d.call(b,g),null===(v=g.collisionStopped)||void 0===v||v.call(g,b),delete this.collisions[y]}}}},{key:"getMapEntity",value:function(t){if(this.memoizedEntities.has(t))return this.memoizedEntities.get(t);var e=new l(t);return this.memoizedEntities.set(t,e),e}},{key:"dispose",value:(n=d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Object.values(this.entities).forEach((function(t){return t.destroy()})),this.timeoutTracker.forEach((function(t){return clearTimeout(t)}));case 2:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){v(i,r,o,a,u,"next",t)}function u(t){v(i,r,o,a,u,"throw",t)}a(void 0)}))},function(){return o.apply(this,arguments)})}],e&&m(t.prototype,e),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}()},3771:(t,e,r)=>{r.d(e,{_:()=>_});var n=r(1016),o=r(82140),i=r(47056),a=r(48418);var u=r(87331),c=r(97774),s=r(50382),l=r(69294),f=r(39972);var h={set:function(t,e,r){if((0,f.Z)(t[e],r))return!0;switch(t.gameStarted=!0,e){case"ended":r?o.h.dispatch((0,u.C)({finalTime:t.time})):o.h.dispatch((0,u.C)(void 0));break;case"time":r>0?(t.lockCars=!1,o.h.dispatch((0,i.N)(!1))):(t.lockCars=!0,o.h.dispatch((0,i.N)(!0)));break;case"lapTimes":var n=r;n.length>0&&o.h.dispatch((0,i.gg)({lap:n.filter((function(t){return t>=0})).length,maxLaps:n.length}))}return Reflect.set(t,e,r),!0}},p=r(50100),y=r(21198),d=r(57761);function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function m(){m=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new C(n||[]);return o(a,"_invoke",{value:T(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",b={};function g(){}function w(){}function S(){}var x={};s(x,a,(function(){return this}));var O=Object.getPrototypeOf,P=O&&O(O(A([])));P&&P!==r&&n.call(P,a)&&(x=P);var E=S.prototype=g.prototype=Object.create(x);function j(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==v(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function T(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=_(u,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===b)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(v(e)+" is not iterable")}return w.prototype=S,o(E,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=s(S,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,S):(t.__proto__=S,s(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(k.prototype),s(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),s(E,c,"Generator"),s(E,a,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function b(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function g(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){b(i,n,o,a,u,"next",t)}function u(t){b(i,n,o,a,u,"throw",t)}a(void 0)}))}}function w(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,T(n.key),n)}}function S(t,e,r){return e=E(e),function(t,e){if(e&&("object"==v(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,x()?Reflect.construct(e,r||[],E(t).constructor):e.apply(t,r))}function x(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(x=function(){return!!t})()}function O(t,e,r,n){var o=P(E(1&n?t.prototype:t),e,r);return 2&n?function(t){return o.apply(r,t)}:o}function P(){return P="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=E(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},P.apply(null,arguments)}function E(t){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},E(t)}function j(t,e){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},j(t,e)}function k(t,e,r){return(e=T(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T(t){var e=function(t,e){if("object"!=v(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==v(e)?e:e+""}var _=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=S(this,e)).playerConfig=t,k(r,"camera",void 0),k(r,"player",void 0),k(r,"lastTime",void 0),k(r,"time",void 0),k(r,"timerElement",void 0),k(r,"done",void 0),k(r,"timeout",void 0),k(r,"network",void 0),k(r,"spawn",void 0),k(r,"ended",void 0),k(r,"loaded",void 0),k(r,"state",void 0),k(r,"closeResultsListener",void 0),r.camera=new s.Y,r.time=0,r.lastTime=0,r.timerElement=document.getElementById("timer"),r.done=!1,r.network=new l.h(r.entities,t),r.state=new Proxy({gameStarted:!1,lockCars:!0,ended:!1,time:-99999,lapTimes:[]},h),r.ended=!1,r.loaded=!1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&j(t,e)}(e,t),r=e,n=[{key:"init",value:(b=g(m().mark((function t(){var e,r,n=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.network.init();case 2:this.spawn=(0,p.g)(a.UI.getSpawn(0)),this.resetFromServerMessage(),a.UO.trackEvent("TimeTrialsGameStart",{map:a.uk.map,roomId:null!==(e=a.dB.region.roomCode)&&void 0!==e?e:"none"}),null===(r=a.Xx.map)||void 0===r||r.setPodiumVisibility(!1),this.closeResultsListener=a.dB.game.results.addListener((function(t){var e;a.UO.trackEvent("TimeTrialGameComplete",{map:a.uk.map,roomId:null!==(e=a.dB.region.roomCode)&&void 0!==e?e:"none",time:n.state.time,xpEarned:t.xpReward,completed:n.state.ended})})),setTimeout((function(){a.g2.fullReset(),a.g2.radio.initMapRadio(a.uk.map)}),2e3);case 8:case"end":return t.stop()}}),t,this)}))),function(){return b.apply(this,arguments)})},{key:"update",value:function(t,r){var n,u;this.network.update(t,r),O(e,"update",this,3)([t,r]),!this.loaded&&this.state.gameStarted&&(o.h.dispatch((0,i.SY)(-1)),this.loaded=!0),this.getPlayerCar(),this.player&&(0,d.L)(this.player)&&(null===(n=a.Xx.map)||void 0===n||n.setTarget(this.player),this.camera.setTarget(this.player)),this.state.ended&&this.setCamera((null===(u=a.Xx.map)||void 0===u?void 0:u.spectatorCameras)||new s.Y),a.qH.networked.reset&&this.sendReset(),this.camera.update(t,r),this.updateTimer(t),this.updateStartVisuals()}},{key:"getPlayerCar",value:function(){var t=c.u.getSessionHash();if(t){var e=a.uk.getServerId(t);this.player=this.entities[e],this.player||(this.player=Object.values(this.entities)[0])}}},{key:"updateStartVisuals",value:function(){this.state.time>-1e3&&this.time<0&&o.h.dispatch((0,i.$v)(0))}},{key:"startPhysicsStep",value:function(t,e){var r=this.state.lockCars||this.state.ended?a.qH.emptyInput():a.qH.cloneInput();this.network.startPhysicsStep(t,e,r)}},{key:"fixedUpdate",value:function(t,r){O(e,"fixedUpdate",this,3)([t,r]),this.network.fixedUpdate(t),this.ensureSkinsAreLoaded()}},{key:"updateTimer",value:function(t){if(this.timerElement){this.state.ended||(this.time+=t),this.lastTime!==this.state.time&&(this.lastTime>0&&this.state.time<this.lastTime&&this.resetFromServerMessage(),this.lastTime=this.state.time,this.time=this.state.time/1e3);var e=(r=this.time<=0?0:this.time,new Date(1e3*r).toISOString().substring(14,23));this.timerElement.innerText=e}var r}},{key:"resetFromServerMessage",value:function(){var t;this.time=0,this.lastTime=0,o.h.dispatch((0,i.$v)(void 0)),o.h.dispatch((0,u.C)(void 0));var e=this.spawn.origin,r=this.spawn.rotation;null===(t=this.player)||void 0===t||t.entity.setTransform(e.x,e.y,e.z,r.x,r.y,r.z,r.w),this.setCamera(new s.Y),this.ended=!1,a.CO.switchReconciliation(1)}},{key:"setCamera",value:function(t){this.camera=t,this.player&&this.camera.setTarget(this.player)}},{key:"checkEnded",value:function(){this.state.ended&&!this.ended&&(this.ended=!0,a.CO.switchReconciliation(0))}},{key:"sendReset",value:function(){a.dB.game.sendReset()}},{key:"ensureSkinsAreLoaded",value:function(){for(var t=0,e=Object.values(this.entities);t<e.length;t++){var r=e[t];r instanceof y.l&&r.loadSkinFromConfig()}}},{key:"dispose",value:(v=g(m().mark((function t(){var r,n;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.network.dispose();case 2:return t.next=4,O(e,"dispose",this,3)([]);case 4:null===(r=this.closeResultsListener)||void 0===r||r.call(this),this.camera.dispose(),a.UO.trackEvent("TimeTrialsGameEnd",{map:a.uk.map,roomId:null!==(n=a.dB.region.roomCode)&&void 0!==n?n:"none"});case 7:case"end":return t.stop()}}),t,this)}))),function(){return v.apply(this,arguments)})}],n&&w(r.prototype,n),f&&w(r,f),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,f,v,b}(n.xs)},82279:(t,e,r)=>{r.d(e,{o7:()=>l,d$:()=>f,qJ:()=>s});var n=r(82140),o=r(47056),i=r(39972);var a=r(96849),u=r(48418),c=r(71355),s=function(t){return t.disconnected&&!t.finished};function l(){return null===n.h||void 0===n.h||n.h.dispatch((0,o.$v)(void 0)),{lockResults:!1,players:{},maxLaps:0,roundTime:-99999999,lockCars:!1,gameStarted:!1,showResults:!1}}var f={set:function(t,e,r){if((0,i.Z)(t[e],r))return!0;var s=u.uk.getPlayerServerId();switch(e){case"players":var l=r,f=function(t,e,r){var n,o,i,a,u=null!==(n=null===(o=t[r])||void 0===o?void 0:o.finished)&&void 0!==n&&n,c=null!==(i=null===(a=e[r])||void 0===a?void 0:a.finished)&&void 0!==i&&i;if(u!==c)return c}(t.players,l,s);void 0!==f&&t.roundTime>0&&n.h.dispatch((0,a.iX)(f));var h=function(t,e,r){var n,o,i,a,u=null!==(n=null===(o=t[r])||void 0===o?void 0:o.lap)&&void 0!==n?n:void 0,c=null!==(i=null===(a=e[r])||void 0===a?void 0:a.lap)&&void 0!==i?i:void 0;if(u!==c)return c}(t.players,l,s);void 0!==h&&n.h.dispatch((0,o.gg)({lap:h}));var p=function(t,e,r){var n,o;if(void 0!==(null===(n=e[r])||void 0===n?void 0:n.placement)&&e[r].placement!==(null===(o=t[r])||void 0===o?void 0:o.placement))return e[r].placement}(t.players,l,s);void 0!==p&&n.h.dispatch((0,o.wq)(p+1));var y=Object.values(l);n.h.dispatch((0,a.wh)({playerIndex:y.findIndex((function(t){return t.serverId===s})),players:y}));break;case"maxLaps":n.h.dispatch((0,o.gg)({maxLaps:r}));break;case"roundTime":var d=r;if(d>0?n.h.dispatch((0,o.N)(!1)):d<0&&n.h.dispatch((0,o.N)(!0)),d>2e3?n.h.dispatch((0,o.$v)(void 0)):d>-500?n.h.dispatch((0,o.$v)(0)):d>-2500?n.h.dispatch((0,o.$v)(1)):d>-4500?n.h.dispatch((0,o.$v)(2)):d>-6500&&n.h.dispatch((0,o.$v)(3)),!u.g2.isPlaying()){var v,m=((null===(v=u.g2.currentSong)||void 0===v?void 0:v.audio[0].duration)||0)-c.A+d/1e3;m>=0&&u.g2.skipTo(m)}t.lockCars=!(d>0)}return Reflect.set(t,e,r),!0}}},87141:(t,e,r)=>{r.d(e,{v:()=>Ct});var n=r(21198),o=r(48418),i=r(82140),a=r(18973),u=r(69294),c=r(47056),s=r(82279);function l(t,e){var r,n,i;return null!==(n=null===(i=t[e=null!==(r=e)&&void 0!==r?r:o.uk.getPlayerServerId()])||void 0===i?void 0:i.finished)&&void 0!==n&&n}var f=r(40186),h=r(96849),p=r(30945),y=r(15013),d=r(9332),v=r(50382);function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,w(n.key),n)}}function g(t,e,r){return(e=w(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function w(t){var e=function(t,e){if("object"!=m(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==m(e)?e:e+""}var S=function(t){return t[t.GAME=0]="GAME",t[t.PODIUM=1]="PODIUM",t[t.SCENIC=2]="SCENIC",t}({}),x=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.entities=e,this.state=r,g(this,"camera",void 0),g(this,"type",void 0)},(e=[{key:"setCamera",value:function(t){this.camera.dispose(),this.camera=t;var e=this.getTarget();e&&this.camera.setTarget(e)}}])&&b(t.prototype,e),r&&b(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function O(t){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(t)}function P(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,L(n.key),n)}}function E(t,e,r){return e=k(e),function(t,e){if(e&&("object"==O(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,j()?Reflect.construct(e,r||[],k(t).constructor):e.apply(t,r))}function j(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(j=function(){return!!t})()}function k(t){return k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},k(t)}function T(t,e){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},T(t,e)}function _(t,e,r){return(e=L(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function L(t){var e=function(t,e){if("object"!=O(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=O(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==O(e)?e:e+""}var I=9e3,C=function(t){function e(t,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=E(this,e,[t,r])).entities=t,n.state=r,_(n,"camera",void 0),_(n,"type",S.GAME),_(n,"mapCameraTimer",void 0),_(n,"target",void 0),_(n,"spectatorCameraType",void 0),n.camera=new v.Y({skipLerp:!1}),n.mapCameraTimer=0,n.spectatorCameraType=0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&T(t,e)}(e,t),r=e,i=[{key:"update",value:function(t,e){if(this.state.roundTime<-2500){var r;if(this.state.roundTime<-2500&&this.state.roundTime>-9e3){var i,a;0===this.mapCameraTimer&&(this.mapCameraTimer=this.state.roundTime);var u=this.getTarget();u instanceof n.l&&(null===(i=o.Xx.map)||void 0===i||i.setTarget(u)),this.mapCameraTimer+=1e3*t;var c=(I+this.mapCameraTimer)/7e3;null===(a=o.Xx.map)||void 0===a||null===(a=a.mapCamera)||void 0===a||a.updateCompletion(c)}else{var s;this.mapCameraTimer=0,null===(s=o.Xx.map)||void 0===s||null===(s=s.mapCamera)||void 0===s||s.updateCompletion(0)}null===(r=o.Xx.map)||void 0===r||null===(r=r.mapCamera)||void 0===r||r.update(t,e)}else this.mapCameraTimer=0,this.camera.update(t,e)}},{key:"fixedUpdate",value:function(t){(0,d.Z)()}},{key:"setTarget",value:function(t){this.target=t;var e=this.getTarget();e&&this.camera.setTarget(e)}},{key:"getTarget",value:function(){if(this.target)return this.entities[this.target]}},{key:"hasTarget",value:function(){return!!this.getTarget()}},{key:"cycleCameras",value:function(){if(this.spectatorCameraType=(this.spectatorCameraType+1)%2,0===this.spectatorCameraType)this.setCamera(new v.Y);else if(1===this.spectatorCameraType){var t,e=null===(t=o.Xx.map)||void 0===t?void 0:t.spectatorCameras;e&&this.setCamera(e)}}},{key:"cycleTarget",value:function(t){for(var e=Object.values(this.entities).filter((function(t){return t instanceof n.l})),r=0;r<e.length;r++)if(e[r].eid===this.target){this.setTarget(e[(r+t+e.length)%e.length].eid);break}}},{key:"getTargetServerId",value:function(){var t;return null===(t=this.getTarget())||void 0===t?void 0:t.eid}},{key:"destroy",value:function(){this.camera.dispose()}}],i&&P(r.prototype,i),a&&P(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,a}(x),A=r(5071),M=r(83484);function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function N(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,W(n.key),n)}}function D(t,e,r){return e=G(e),function(t,e){if(e&&("object"==R(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,B()?Reflect.construct(e,r||[],G(t).constructor):e.apply(t,r))}function B(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(B=function(){return!!t})()}function F(){return F="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=G(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},F.apply(null,arguments)}function G(t){return G=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},G(t)}function U(t,e){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},U(t,e)}function z(t,e,r){return(e=W(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function W(t){var e=function(t,e){if("object"!=R(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==R(e)?e:e+""}var V=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),z(t=D(this,e),"targetPosition",void 0),z(t,"prevLookAt",void 0),z(t,"target",void 0),z(t,"lookAtOffset",void 0),z(t,"shouldSkip",void 0),z(t,"setTarget",(function(e,r){var n,o;t.lookAtOffset=r||new A.P(0,0,0),t.prevLookAt||(t.prevLookAt=null!==(n=null===(o=t.target)||void 0===o?void 0:o.worldPosition.clone().add(t.lookAtOffset))&&void 0!==n?n:new A.P(0,0,0)),t.target=e})),z(t,"getTarget",(function(){return t.target})),z(t,"dispose",d.Z),t.fov=55,t.lookAtOffset=new A.P(0,0,0),t.shouldSkip=!0,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&U(t,e)}(e,t),r=e,n=[{key:"update",value:function(t,r){if(this.target&&this.prevLookAt&&this.targetPosition){if(isNaN(this.target.worldPosition.length()))return;this.shouldSkip?this.position.copy(this.targetPosition):this.position.copy(this.position.lerp(this.targetPosition,.1));var n,o=this.target.worldPosition.clone().add(this.lookAtOffset);this.shouldSkip||this.prevLookAt.distanceTo(o)>150?(this.prevLookAt.copy(o),this.lookAtPosition.copy(o)):this.lookAtPosition.copy(null===(n=this.prevLookAt)||void 0===n?void 0:n.lerp(o,.1)),this.shouldSkip=!1}var i,a,u,c,s;(i=e,a="update",u=this,s=F(G(1&(c=3)?i.prototype:i),a,u),2&c?function(t){return s.apply(u,t)}:s)([t,r])}},{key:"setPosition",value:function(t){this.targetPosition=t}}],n&&N(r.prototype,n),o&&N(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(M.D),H=r(7479),q=r(19038),X=r(63463),K=r(47472);function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function J(){J=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==Y(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Y(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Z(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Q(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tt(n.key),n)}}function $(t,e,r){return(e=tt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tt(t){var e=function(t,e){if("object"!=Y(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Y(e)?e:e+""}var et=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.car=e,$(this,"license",void 0),$(this,"resolvedLicense",void 0),$(this,"textureLoader",new q.d)},e=[{key:"init",value:function(){}},{key:"showLicense",value:function(t){var e=this;this.license=new Promise((function(r){var n=o.uk.getDbId(t);if(!n||"-1"===n)return r(void 0);var i=o.xs.getDriversLicenceUrl(n);e.textureLoader.load(i,(function(t){t.isRenderTargetTexture&&(t.colorSpace=X.GUF),t.flipY=!1,t.needsUpdate=!0,o.Jb.models.license.then((function(n){var i=n.scene.clone(!0).children[0];i.traverse((function(e){var r;e instanceof K.K&&(null===(r=o.Xx.map)||void 0===r||r.registerDynamicMesh(e),"cardFace"===e.material.name&&(e.material=e.material.clone(),e.material.map=t),e.material.am,e.material.metalness=.2,e.material.needsUpdate=!0)})),e.car.add(i);var a=1.5;i.scale.set(a,a,a),i.position.set(0,4,0),i.lookAt(new A.P(10,5,-10)),i.updateMatrix(),i.addAnimation(new o.Iq.FloatAnimation(.2,.5)),i.addAnimation(new o.Iq.AppearAnimation(4,new o.Iq.Vector3(a,a,a))),r(i),e.resolvedLicense=i}))}),void 0,(function(){r(void 0)}))}))}},{key:"hasLicense",value:(n=J().mark((function t(){return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.license;case 2:return t.abrupt("return",!!t.sent);case 3:case"end":return t.stop()}}),t,this)})),i=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){Z(i,r,o,a,u,"next",t)}function u(t){Z(i,r,o,a,u,"throw",t)}a(void 0)}))},function(){return i.apply(this,arguments)})},{key:"hasLicenseResolve",value:function(){return!!this.resolvedLicense}},{key:"destroy",value:function(){var t,e=this;null===(t=this.license)||void 0===t||t.then((function(){e.resolvedLicense&&e.car.remove(e.resolvedLicense)}))}}],e&&Q(t.prototype,e),r&&Q(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i}(),rt={type:"podium",services:{static:r(84076).F,license:et,nametag:H.M}};function nt(t){return t.type===rt.type}var ot=r(44018),it=r(91361);function at(t){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},at(t)}function ut(){ut=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==at(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(at(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function ct(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function st(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ct(i,n,o,a,u,"next",t)}function u(t){ct(i,n,o,a,u,"throw",t)}a(void 0)}))}}function lt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vt(n.key),n)}}function ft(t,e,r){return e=pt(e),function(t,e){if(e&&("object"==at(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ht()?Reflect.construct(e,r||[],pt(t).constructor):e.apply(t,r))}function ht(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ht=function(){return!!t})()}function pt(t){return pt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pt(t)}function yt(t,e){return yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},yt(t,e)}function dt(t,e,r){return(e=vt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vt(t){var e=function(t,e){if("object"!=at(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=at(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==at(e)?e:e+""}var mt=function(t){function e(t,r){var n,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=ft(this,e,[t,r])).entities=t,a.state=r,dt(a,"camera",void 0),dt(a,"type",S.PODIUM),dt(a,"podiumEntities",void 0),dt(a,"target",void 0),dt(a,"targetServerId",void 0),dt(a,"cancelListener",void 0),dt(a,"updatePodiumPromise",void 0),a.camera=new V,a.podiumEntities={},null===(n=o.Xx.map)||void 0===n||n.setPodiumVisibility(!0),i.h.dispatch((0,h.JX)(!0)),o.Ts.audioListener.setMasterVolume(0),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yt(t,e)}(e,t),r=e,a=[{key:"update",value:function(t,e){this.updatePodium(),this.camera.update(t,e)}},{key:"fixedUpdate",value:function(t){(0,d.Z)()}},{key:"setTarget",value:(l=st(ut().mark((function t(e){var r,i,a,u,c;return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.updatePodium();case 2:if(void 0!==(i=this.getPodiumId(e))){t.next=5;break}return t.abrupt("return");case 5:if(void 0!==(a=this.entities[i])){t.next=8;break}return t.abrupt("return");case 8:if(void 0!==(u=null===(r=this.state.players[e])||void 0===r?void 0:r.placement)){t.next=11;break}return t.abrupt("return");case 11:this.targetServerId=e,this.target=i,c=o.UI.getPodiumCamera(u),a instanceof n.l&&nt(a)&&(this.camera.setTarget(a,void 0),this.camera.setPosition(new A.P(c.x(),c.y(),c.z())));case 15:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"crossCheckServerId",value:function(){void 0!==this.targetServerId&&this.targetServerId!==this.target&&this.setTarget(this.targetServerId)}},{key:"getTarget",value:function(){if(void 0!==this.target)return this.entities[this.target]}},{key:"hasTarget",value:function(){return void 0!==this.target&&void 0!==this.entities[this.target]}},{key:"getTargetServerId",value:function(){return this.targetServerId}},{key:"destroy",value:function(){var t,e;this.camera.dispose(),null===(t=this.cancelListener)||void 0===t||t.call(this),null===(e=o.Xx.map)||void 0===e||e.setPodiumVisibility(!1);for(var r=0,n=Object.values(this.podiumEntities);r<n.length;r++){var i,a=n[r];null===(i=this.entities[a])||void 0===i||i.destroy(),delete this.entities[a]}o.Ts.audioListener.setMasterVolume(o.Xd.audio.sfx*o.Xd.audio.master*it.B5)}},{key:"updatePodium",value:(s=st(ut().mark((function t(){var e=this;return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.updatePodiumPromise){t.next=3;break}return t.next=3,this.updatePodiumPromise;case 3:return this.updatePodiumPromise=Promise.all(Object.values(this.state.players).map(function(){var t=st(ut().mark((function t(r){return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.finished){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.addCarsToPodium(r.serverId);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),t.next=6,this.updatePodiumPromise;case 6:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"addCarsToPodium",value:(c=st(ut().mark((function t(e){var r,n,i,a,u,c;return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===(n=this.getPodiumId(e))||void 0===this.entities[n]){t.next=3;break}return t.abrupt("return");case 3:if(i=Object.values(this.state.players).find((function(t){return t.serverId===e}))){t.next=6;break}return t.abrupt("return");case 6:if(a=null===(r=o.Xx.map)||void 0===r?void 0:r.podiumSpawnPoints[i.placement]){t.next=10;break}return console.error("No podium spawn point found for placement",i.placement),t.abrupt("return");case 10:if((u=(0,ot.Gf)(rt)).entity.shouldIgnoreNetwork(!0),this.entities[u.eid]=u,this.podiumEntities[e]=u.eid,s=u.entity,l=a,s.setTransform(l.origin.x,l.origin.y,l.origin.z,l.rotation.x,l.rotation.y,l.rotation.z,l.rotation.w),null==(c=o.uk.getConfigForPlayer(i.serverId))||!c.car){t.next=21;break}return t.next=19,u.loadSkinFromInventoryItem(c.car);case 19:t.next=23;break;case 21:return t.next=23,u.loadSkinFromConfig();case 23:null!=c&&c.name&&u.services.nametag.setUsername(c.name);case 24:case"end":return t.stop()}var s,l}),t,this)}))),function(t){return c.apply(this,arguments)})},{key:"getPodiumId",value:function(t){return this.podiumEntities[t]}}],a&&lt(r.prototype,a),u&&lt(r,u),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,a,u,c,s,l}(x),bt=r(74650);function gt(t){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gt(t)}function wt(){wt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==gt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(gt(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function St(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function xt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){St(i,n,o,a,u,"next",t)}function u(t){St(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Ot(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,It(n.key),n)}}function Pt(t,e,r){return e=Tt(e),function(t,e){if(e&&("object"==gt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Et()?Reflect.construct(e,r||[],Tt(t).constructor):e.apply(t,r))}function Et(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Et=function(){return!!t})()}function jt(t,e,r,n){var o=kt(Tt(1&n?t.prototype:t),e,r);return 2&n?function(t){return o.apply(r,t)}:o}function kt(){return kt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Tt(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},kt.apply(null,arguments)}function Tt(t){return Tt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Tt(t)}function _t(t,e){return _t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_t(t,e)}function Lt(t,e,r){return(e=It(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function It(t){var e=function(t,e){if("object"!=gt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=gt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==gt(e)?e:e+""}var Ct=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Pt(this,e)).playerConfig=t,Lt(r,"player",void 0),Lt(r,"adTriggered",void 0),Lt(r,"adShown",void 0),Lt(r,"scene",void 0),Lt(r,"wasInGame",void 0),Lt(r,"network",void 0),Lt(r,"commKind",void 0),Lt(r,"loaded",void 0),Lt(r,"state",void 0),Lt(r,"closeEndGameListener",void 0),Lt(r,"closeResultsListener",void 0),r.adTriggered=!1,r.adShown=!1,r.wasInGame=!1,r.network=new u.h(r.entities,t),r.commKind=void 0,r.state=new Proxy((0,s.o7)(),s.d$),r.loaded=!1,r.scene=new C(r.entities,r.state),i.h.dispatch((0,h.JX)(!1)),i.h.dispatch((0,h.iX)(!1)),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_t(t,e)}(e,t),r=e,f=[{key:"init",value:(m=xt(wt().mark((function t(){var e,r,n,a,u=this;return wt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.uk.map,a=bt.O[n],o.g2.fullReset(),o.g2.queueSong(a),t.next=6,this.network.init();case 6:o.UO.trackEvent("GrandPrixGameStart",{map:o.uk.map,roomId:null!==(e=o.dB.region.roomCode)&&void 0!==e?e:"none"}),this.closeEndGameListener=o.dB.game.endGame.addListener(function(){var t=xt(wt().mark((function t(e){return wt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"ENDGAME"===e?(u.forceFinish(),u.showPodium()):u.clearEntities();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.closeResultsListener=o.dB.game.results.addListener(function(){var t=xt(wt().mark((function t(e){var r,n;return wt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o.UO.trackEvent("GrandPrixGameComplete",{gameId:null!==(r=o.dB.game.getLastGameId())&&void 0!==r?r:"none",map:o.uk.map,roomId:null!==(n=o.dB.region.roomCode)&&void 0!==n?n:"none",xpEarned:e.xpReward,placement:u.state.players[o.uk.getPlayerServerId()].placement});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.state.lockResults=!1,i.h.dispatch((0,h.iX)(!1)),null===(r=o.Xx.map)||void 0===r||r.setPodiumVisibility(!1);case 12:case"end":return t.stop()}}),t,this)}))),function(){return m.apply(this,arguments)})},{key:"setScene",value:function(t){if(this.scene.type!==t.type){var e=this.scene.getTargetServerId();e&&t.setTarget(e),this.scene.destroy(),this.scene=t}}},{key:"isSceneType",value:function(t){return this.scene.type===t}},{key:"showPodium",value:function(){this.setScene(new mt(this.entities,this.state))}},{key:"forceFinish",value:function(){var t=(0,y.Z)(this.state.players);for(var e in t)t[e].finished=!0;this.state.players=t}},{key:"clearEntities",value:function(){for(var t in this.entities)this.entities[t].destroy(),delete this.entities[t]}},{key:"update",value:function(t,r){this.scene.update(t,r),!this.loaded&&this.state.gameStarted&&(i.h.dispatch((0,c.SY)(-1)),this.loaded=!0),this.network.update(t,r),jt(e,"update",this,3)([t,r])}},{key:"startPhysicsStep",value:function(t,e){var r=this.state.lockCars?o.qH.emptyInput():o.qH.cloneInput();this.network.startPhysicsStep(t,e,r);var n=this.network.getCommunicationMethod();if(this.commKind!==n)switch(this.commKind=n,n){case p.Q.ACTIVE:this.setTarget(o.uk.getPlayerServerId());break;case p.Q.PASSIVE:this.ensureProperSpectatorTarget()}}},{key:"fixedUpdate",value:function(t,r){jt(e,"fixedUpdate",this,3)([t,r]),this.network.fixedUpdate(t),this.scene.fixedUpdate(r),l(this.state.players)&&!this.adTriggered&&(this.adTriggered=!0),this.ensureSkinsAreLoaded(),this.checkSwitchToPodium(),this.ensureProperSpectatorTarget()}},{key:"cycleTarget",value:function(t){this.commKind!==p.Q.ACTIVE&&this.scene instanceof C&&this.scene.cycleTarget(t)}},{key:"cycleCameras",value:function(){this.commKind!==p.Q.ACTIVE&&this.scene instanceof C&&this.scene.cycleCameras()}},{key:"ensureSkinsAreLoaded",value:function(){for(var t=0,e=Object.values(this.entities);t<e.length;t++){var r=e[t];r instanceof n.l&&!nt(r)&&r.loadSkinFromConfig()}}},{key:"ensureProperSpectatorTarget",value:function(){if(this.commKind===p.Q.PASSIVE&&!this.scene.hasTarget())for(var t=0,e=Object.values(this.entities);t<e.length;t++){var r=e[t];if(r instanceof n.l)return void this.setTarget(r.eid)}}},{key:"setTarget",value:function(t){var e,r;null!==(e=this.state.players[t])&&void 0!==e&&e.finished&&this.commKind===p.Q.PASSIVE?this.setScene(new mt(this.entities,this.state)):this.setScene(new C(this.entities,this.state)),i.h.dispatch((0,a.km)(t));var n=null===(r=o.uk.getConfigForPlayer(t))||void 0===r?void 0:r.name;n&&i.h.dispatch((0,a.b6)(n)),this.scene.setTarget(t)}},{key:"checkSwitchToPodium",value:function(){this.commKind===p.Q.PASSIVE&&!this.isUserInGame()&&l(this.state.players,this.scene.getTargetServerId())&&this.showPodium()}},{key:"updatePlayState",value:function(t){switch(t){case"PLAYING":this.network.updateCommunicationMethod(p.Q.ACTIVE);break;case"SPECTATING":this.network.updateCommunicationMethod(p.Q.PASSIVE)}}},{key:"isUserInGame",value:function(){return o.uk.getPlayerServerId()in this.state.players}},{key:"dispose",value:(v=xt(wt().mark((function t(){var r,n,a;return wt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.scene.destroy(),t.next=3,jt(e,"dispose",this,3)([]);case 3:return t.next=5,this.network.dispose();case 5:i.h.dispatch((0,h.oS)(!1)),null===(r=this.closeResultsListener)||void 0===r||r.call(this),null===(n=this.closeEndGameListener)||void 0===n||n.call(this),o.UO.trackEvent("GrandPrixGameEnd",{roomId:null!==(a=o.dB.region.roomCode)&&void 0!==a?a:"none",map:o.uk.map});case 9:case"end":return t.stop()}}),t,this)}))),function(){return v.apply(this,arguments)})}],f&&Ot(r.prototype,f),d&&Ot(r,d),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,f,d,v,m}(f.q)},30945:(t,e,r)=>{r.d(e,{Q:()=>n});var n=function(t){return t[t.ACTIVE=0]="ACTIVE",t[t.PASSIVE=1]="PASSIVE",t}({})},69294:(t,e,r)=>{r.d(e,{h:()=>z});var n=r(82140),o=r(47056),i=r(48418),a=r(1016),u=r(30945);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function s(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return l(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,p(n.key),n)}}function h(t,e,r){return(e=p(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p(t){var e=function(t,e){if("object"!=c(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==c(e)?e:e+""}var y=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.worldSnapshots=e,h(this,"totalSize",void 0),h(this,"maxSnapshots",void 0),this.totalSize=0,this.maxSnapshots=6,e.length>this.maxSnapshots&&e.shift();var r,n=s(e);try{for(n.s();!(r=n.n()).done;){var o=r.value;this.totalSize+=o.byteLength}}catch(t){n.e(t)}finally{n.f()}},(e=[{key:"injectWorldSnapshot",value:function(t){var e,r=t,n=s(this.worldSnapshots);try{for(n.s();!(e=n.n()).done;){var o=e.value;i.Iq.HEAP8.set(new Uint8Array(o.buffer),r),r+=o.byteLength}}catch(t){n.e(t)}finally{n.f()}}},{key:"getTotalSnapshotSize",value:function(){return this.totalSize}},{key:"getNumSnapshots",value:function(){return this.worldSnapshots.length}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function v(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return m(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,w(n.key),n)}}function g(t,e,r){return(e=w(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function w(t){var e=function(t,e){if("object"!=d(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==d(e)?e:e+""}var S=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.entities=e,this.delayBuffer=r,g(this,"input",{}),g(this,"kind",u.Q.ACTIVE),i.CO.switchReconciliation(1)},(e=[{key:"update",value:function(t,e){Object.values(this.entities).forEach((function(r){(0,a.zR)(r,t,e)}))}},{key:"startPhysicsStep",value:function(t,e,r,n){for(var o=void 0,a=[],u=0;u<e;u++){i.dB.game.addOutgoingEvent(t+u,r);var c=this.delayBuffer.get(t+u,r);0===u&&(o=c.frame),a.push.apply(a,v(c.input))}if(void 0!==o)if(n){var s=new y(n),l=i.CO.prepareNetworkUpdate(t,o,i.uk.getPlayerServerId(),e,a,s.getNumSnapshots(),s.getTotalSnapshotSize(),i.Ts.getCameraMatrecies());s.injectWorldSnapshot(l),i.CO.sendNetworkUpdate()}else i.CO.inputUpdate(t,o,e,a,i.Ts.getCameraMatrecies())}},{key:"fixedUpdate",value:function(t){Object.values(this.entities).forEach(a.AP)}}])&&b(t.prototype,e),r&&b(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),x=r(34874);function O(t){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(t)}function P(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,E(n.key),n)}}function E(t){var e=function(t,e){if("object"!=O(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=O(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==O(e)?e:e+""}var j=function(){return t=function t(e){var r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.entities=e,r=this,n="kind",o=u.Q.PASSIVE,(n=E(n))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,i.CO.switchReconciliation(1)},(e=[{key:"update",value:function(t,e){Object.values(this.entities).forEach((function(r){(0,a.zR)(r,t,e)}))}},{key:"startPhysicsStep",value:function(t,e,r,n){var o=(0,x.L)(e,r);if(n){var a=new y(n),u=i.CO.prepareNetworkUpdate(t,t,i.uk.getPlayerServerId(),e,o,a.getNumSnapshots(),a.getTotalSnapshotSize(),i.Ts.getCameraMatrecies());a.injectWorldSnapshot(u),i.CO.sendNetworkUpdate()}else i.CO.update(t,t,e,i.Ts.getCameraMatrecies())}},{key:"fixedUpdate",value:function(t){Object.values(this.entities).forEach(a.AP)}}])&&P(t.prototype,e),r&&P(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),k=r(27255);function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function _(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,I(n.key),n)}}function L(t,e,r){return(e=I(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I(t){var e=function(t,e){if("object"!=T(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==T(e)?e:e+""}var C=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),L(this,"inputBuffer",[]),L(this,"inputBufferMaxLength",5),L(this,"delta",void 0),L(this,"frameBuffer",[]),L(this,"resimBuffer",[]),this.delta=1/i.CO.getTickRate()},(e=[{key:"checkFrameDrift",value:function(){return i.Xd.network.dynamicInputDelay?void(this.inputBufferMaxLength=5):void(this.inputBufferMaxLength=i.Xd.network.customInputDelay)}},{key:"get",value:function(t,e){if(this.inputBuffer.unshift({frame:t,input:e}),this.checkFrameDrift(),this.inputBufferMaxLength>this.inputBuffer.length){var r=this.inputBuffer[this.inputBuffer.length-1];return{frame:r.frame,input:r.input}}this.inputBufferMaxLength<this.inputBuffer.length&&this.inputBuffer.pop();var n=this.inputBuffer.pop();return n||{frame:t,input:e}}}])&&_(t.prototype,e),r&&_(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),A=r(71881);function M(t){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(t)}function R(){R=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==M(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(M(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function N(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function D(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){N(i,n,o,a,u,"next",t)}function u(t){N(i,n,o,a,u,"throw",t)}a(void 0)}))}}function B(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,G(n.key),n)}}function F(t,e,r){return(e=G(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G(t){var e=function(t,e){if("object"!=M(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=M(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==M(e)?e:e+""}var U={gameId:"test18273198273981273",gameName:"test",key:"1234567890"},z=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.entities=e,this.playerConfig=r,F(this,"serverTimeDiffs",[]),F(this,"networkTarget",void 0),F(this,"spectatorTimeout",void 0),F(this,"networkPacketCounter",0),F(this,"networkExecuteRatio",1),F(this,"deltaBuffer",void 0),F(this,"highPing",void 0),F(this,"highPingDelay",0),F(this,"communicationHandler",void 0),F(this,"delayBuffer",void 0),F(this,"packetReceivedTimes",{}),this.deltaBuffer=[],this.delayBuffer=new C,this.highPing=!1,this.communicationHandler=this.updateCommunicationMethod(u.Q.PASSIVE),i.Sx.resume()},e=[{key:"init",value:(c=D(R().mark((function t(){var e;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.uk.initNetworkDeterminedMap();case 2:i.dB.game.run(),i.dB.game.connect(null!==(e=this.playerConfig)&&void 0!==e?e:U),n.h.dispatch((0,k.K4)(!1)),i.UI.setTestItem(A.$.COIN_ITEM);case 6:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"updateCommunicationMethod",value:function(t){switch(t){case u.Q.ACTIVE:n.h.dispatch((0,o.yR)("PLAYING")),this.communicationHandler=new S(this.entities,this.delayBuffer);break;case u.Q.PASSIVE:n.h.dispatch((0,o.yR)("SPECTATING")),this.communicationHandler=new j(this.entities)}return this.communicationHandler}},{key:"update",value:function(t,e){this.communicationHandler.update(t,e)}},{key:"startPhysicsStep",value:function(t,e,r){var n=this.getWorldUpdate(t);i.Xx.map||(n=void 0),this.communicationHandler.startPhysicsStep(t,e,r,n)}},{key:"getCommunicationMethod",value:function(){return this.communicationHandler.kind}},{key:"fixedUpdate",value:function(t){this.checkPingTimes(t);var e=this.entities[i.uk.getPlayerServerId()],r=e&&!e.entity.getIsPuppet();r&&this.communicationHandler.kind===u.Q.PASSIVE?this.updateCommunicationMethod(u.Q.ACTIVE):r||this.communicationHandler.kind!==u.Q.ACTIVE||this.updateCommunicationMethod(u.Q.PASSIVE),this.communicationHandler.fixedUpdate(t);var a=i.CO.getHighPingWarning();this.highPing!==a&&this.highPingDelay>60&&(n.h.dispatch((0,o.CH)(a)),this.highPing=a),this.highPingDelay++}},{key:"dispose",value:(a=D(R().mark((function t(){return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.dB.game.stop(),n.h.dispatch((0,o.CH)(!1)),this.spectatorTimeout&&clearTimeout(this.spectatorTimeout);case 3:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"getWorldUpdate",value:function(t){var e=i.dB.game.getWorldUpdates();if(0!==e.length)return this.setPingTime(t),e}},{key:"setPingTime",value:function(t){this.packetReceivedTimes[t]=(new Date).getTime()}},{key:"checkPingTimes",value:function(t){var e=this,r=this.packetReceivedTimes[t];if(r){var n=i.CO.getLastNetworkPackestReceived();-1!==n&&i.dB.game.calculateRTT(n,r)}Object.keys(this.packetReceivedTimes).forEach((function(r){var n=Number(r);n<=t&&delete e.packetReceivedTimes[n]}))}}],e&&B(t.prototype,e),r&&B(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,a,c}()},15233:(t,e,r)=>{r.d(e,{P:()=>kt});var n=r(1016),o=r(50382),i=r(82140),a=r(47056),u=r(48418),c=r(27255),s=r(44018),l=r(57761),f=r(45327),h=r(2013),p=r(50376),y=r(45635),d=r(58761);function v(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return m(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var b={required:[{name:"limbo-0",src:h,type:"model"}].concat(v(y.z.required)),optional:[d.K].concat(v(y.z.optional),[{name:"limbo-1",src:p,type:"model"}])},g=r(9986),w=r(39118),S=r(76223),x=r(5071);function O(t){u.Ts.scene.add(new w.M(16775119,.8*Math.PI));var e=new S.O(15261845,.6*Math.PI);e.castShadow=!0,e.shadow.autoUpdate=!1,e.shadow.needsUpdate=!1,e.target.position.set(0,0,0),e.position.set(-100,550,-150),e.shadow.mapSize.width=8192,e.shadow.mapSize.height=8192,e.shadow.camera.near=100,e.shadow.camera.far=1e3,e.shadow.camera.top=600,e.shadow.camera.bottom=-750,e.shadow.camera.left=-900,e.shadow.camera.right=600,e.shadow.bias=-1e-4,e.shadow.normalBias=.1,u.Ts.scene.add(e),t.addStaticLight({light:e,maxMapSize:8192});var r=new S.O(15261845,.6*Math.PI);r.castShadow=!0,r.shadow.autoUpdate=!1,r.shadow.needsUpdate=!1,r.shadow.mapSize.width=2048,r.shadow.mapSize.height=2048,r.shadow.camera.near=100,r.shadow.camera.far=1e3,r.shadow.camera.top=50,r.shadow.camera.bottom=-50,r.shadow.camera.left=-50,r.shadow.camera.right=50,r.shadow.bias=-.001,e.shadow.normalBias=.1,u.Ts.scene.add(r),t.addTrackingLight({light:r,maxMapSize:2048,offset:new x.P(-100,550,-150)})}function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function E(){E=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new C(n||[]);return o(a,"_invoke",{value:T(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(A([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function j(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==P(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function T(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=_(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(P(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},j(k.prototype),s(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function j(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function k(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){j(i,n,o,a,u,"next",t)}function u(t){j(i,n,o,a,u,"throw",t)}a(void 0)}))}}function T(t){return _.apply(this,arguments)}function _(){return _=k(E().mark((function t(e){var r,n,o,i,a,c,s=this;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.Jb.load(b);case 2:return u.Jb.textures.particleAtlas.then((function(t){s.particleSystem.setTextureAtlas(t,8,8),s.particleSystem.addToScene()})),t.next=5,u.Jb.textures.canyonSkybox;case 5:return r=t.sent,u.Ts.scene.background=r,t.next=9,u.Jb.models["limbo-0"];case 9:return n=t.sent,t.next=12,this.compileMap(n,{scale:1});case 12:return o=t.sent,i=o.collision,a=o.visual,(c=new g.r(this)).optimizeMap(a),this.staticEntities=c.staticEntities,u.Ts.scene.add(c),t.next=21,this.loadCollision(u.UI,i);case 21:u.Jb.models["limbo-1"].then(function(){var t=k(E().mark((function t(r){var n,o,i;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!s.isDestroyed){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,s.compileMap(r,{scale:1});case 4:return n=t.sent,o=n.collision,i=n.visual,c.optimizeMap(i,1),t.next=10,s.loadCollision(u.UI,o,!0);case 10:c.clearLoadingBarriers(),null==e||e();case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),O(this.shadowHandler);case 23:case"end":return t.stop()}}),t,this)}))),_.apply(this,arguments)}function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function I(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,B(n.key),n)}}function C(t,e,r){return e=N(e),function(t,e){if(e&&("object"==L(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,A()?Reflect.construct(e,r||[],N(t).constructor):e.apply(t,r))}function A(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(A=function(){return!!t})()}function M(t,e,r,n){var o=R(N(1&n?t.prototype:t),e,r);return 2&n?function(t){return o.apply(r,t)}:o}function R(){return R="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=N(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},R.apply(null,arguments)}function N(t){return N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},N(t)}function D(t,e){return D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},D(t,e)}function B(t){var e=function(t,e){if("object"!=L(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=L(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==L(e)?e:e+""}var F=function(t){function e(){var t,r,n,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=C(this,e,["limbo"]),r=t,n="init",o=T.bind(t),(n=B(n))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&D(t,e)}(e,t),r=e,(n=[{key:"update",value:function(t,r){M(e,"update",this,3)([t,r])}},{key:"fixedUpdate",value:function(t){M(e,"fixedUpdate",this,3)([t])}}])&&I(r.prototype,n),o&&I(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(f.D),G=r(69628),U=r(97774),z=r(85285),W=r(70368),V=r(59676),H=r(34874);function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}function X(){X=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==q(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(q(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function K(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Y(){return J.apply(this,arguments)}function J(){var t;return t=X().mark((function t(){var e;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!i.h.getState().global.networkInitialized){t.next=7;break}return t.next=4,u.xs.getCurrentUserProfile();case 4:return(e=t.sent)&&(i.h.dispatch((0,c.ck)(e)),u.xs.inventory.getUnreads()),t.abrupt("return",e);case 7:return t.abrupt("return",void 0);case 8:case"end":return t.stop()}}),t)})),J=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){K(i,n,o,a,u,"next",t)}function u(t){K(i,n,o,a,u,"throw",t)}a(void 0)}))},J.apply(this,arguments)}var Z=r(76022),Q=r(21198),$=r(69300),tt=r(71881),et=r(99648);function rt(t){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rt(t)}function nt(){nt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==rt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(rt(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function ot(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function it(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ot(i,n,o,a,u,"next",t)}function u(t){ot(i,n,o,a,u,"throw",t)}a(void 0)}))}}function at(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ct(n.key),n)}}function ut(t,e,r){return(e=ct(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ct(t){var e=function(t,e){if("object"!=rt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=rt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==rt(e)?e:e+""}var st=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.entities=e,ut(this,"player",void 0),ut(this,"playerStateGroup",void 0),ut(this,"networkListenerCancel",void 0),ut(this,"i",0),u.Sx.resume(),this.playerStateGroup=new u.Iq.PlayerStateGroup},e=[{key:"init",value:(o=it(nt().mark((function t(e){var r=this;return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.player=e,u.UI.setTestItem(tt.$.NITRO_ITEM),this.networkListenerCancel=u.dB.broadcast.physicsStateFlow.addListener((function(t){var e=(0,et.h)(new Uint8Array(t.buffer));r.playerStateGroup.addPlayerState(e,t.buffer.byteLength)})),u.CO.switchReconciliation(0);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"update",value:function(t,e){}},{key:"startPhysicsStep",value:function(t,e,r){this.sendNetworkUpdate(),this.sendPhysicsThreadUpdate(t,e,r)}},{key:"sendNetworkUpdate",value:function(){if(u.dB.broadcast.isConnected()&&this.i++%5==0){var t,e=null===(t=this.player)||void 0===t?void 0:t.entity.getPlayerStateViewer();if(!e)return;var r=e.getPtr(),n=r+e.getSize();u.dB.broadcast.sendPhysicsStateUpdate(u.Iq.HEAPU8.slice(r,n))}}},{key:"sendPhysicsThreadUpdate",value:function(t,e,r){var n=u.CO.prepareNetworkUpdate(t,0,u.uk.getPlayerServerId(),e,r,1,this.playerStateGroup.getWorldSnapshotSizeWithPacketHeader(),u.Ts.getCameraMatrecies());this.playerStateGroup.prepareWorldSnapshot(n,t),u.CO.sendNetworkUpdate()}},{key:"fixedUpdate",value:function(t){}},{key:"dispose",value:(n=it(nt().mark((function t(){var e;return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:u.Iq.destroy(this.playerStateGroup),null===(e=this.networkListenerCancel)||void 0===e||e.call(this);case 2:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}],e&&at(t.prototype,e),r&&at(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function lt(t){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lt(t)}function ft(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=pt(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function ht(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||pt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pt(t,e){if(t){if("string"==typeof t)return yt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?yt(t,e):void 0}}function yt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function dt(){dt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==lt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(lt(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function vt(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function mt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){vt(i,n,o,a,u,"next",t)}function u(t){vt(i,n,o,a,u,"throw",t)}a(void 0)}))}}function bt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jt(n.key),n)}}function gt(t,e,r){return e=Ot(e),function(t,e){if(e&&("object"==lt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,wt()?Reflect.construct(e,r||[],Ot(t).constructor):e.apply(t,r))}function wt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(wt=function(){return!!t})()}function St(t,e,r,n){var o=xt(Ot(1&n?t.prototype:t),e,r);return 2&n?function(t){return o.apply(r,t)}:o}function xt(){return xt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Ot(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},xt.apply(null,arguments)}function Ot(t){return Ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ot(t)}function Pt(t,e){return Pt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Pt(t,e)}function Et(t,e,r){return(e=jt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jt(t){var e=function(t,e){if("object"!=lt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=lt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==lt(e)?e:e+""}var kt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Et(t=gt(this,e),"camera",void 0),Et(t,"player",void 0),Et(t,"ball",void 0),Et(t,"tutorialMarkedComplete",void 0),Et(t,"initialLoadStateCanceler",void 0),Et(t,"roomListenerCancel",void 0),Et(t,"bucketListenerCancel",void 0),Et(t,"network",void 0),Et(t,"carConfiguredRecord",void 0),t.network=new st(t.entities),t.camera=new o.Y,t.tutorialMarkedComplete=!1,t.carConfiguredRecord={},t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pt(t,e)}(e,t),r=e,f=[{key:"init",value:(g=mt(dt().mark((function t(){var e=this;return dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.resetStatsUI(),t.next=3,Promise.all([this.preloadDefaultSkin(),u.Xx.setMap(new F,(function(){e.placeGrabableItems()}))]);case 3:this.player=(0,s.Gf)(l.k),this.player.entity.setPuppetState(!1),this.placeCar(),this.player.loadSkin(this.getDefaultSkin()),this.roomListenerCancel=u.dB.broadcast.roomFlow.addListener(this.roomUpdate.bind(this)),this.bucketListenerCancel=u.dB.broadcast.bucketFlow.addListener(this.loadSkinsFromBucketUpdate.bind(this)),this.camera instanceof o.Y&&this.camera.setTarget(this.player),this.refreshProfile(),u.UI.setTestItem(-1),i.h.dispatch((0,a.N)(!1)),u.Sx.resume(),u.gp.initialize(this.player),this.network.init(this.player),u.g2.radio.correctMenuRadio(),u.dB.refreshPlayerConfig(),setTimeout((function(){i.h.dispatch((0,c.K4)(!1)),i.h.dispatch((0,a.SY)(-1)),i.h.dispatch((0,c._D)(void 0))}),250);case 19:case"end":return t.stop()}}),t,this)}))),function(){return g.apply(this,arguments)})},{key:"placeCar",value:function(){var t,e=u.UI.getSpawn(8),r=e.getOrigin(),n=e.getRotation();null===(t=this.player)||void 0===t||t.entity.setTransform(r.x()+30*Math.random()-15,r.y()+3,r.z()+30*Math.random()-15,n.x(),n.y(),n.z(),n.w())}},{key:"refreshProfile",value:(b=mt(dt().mark((function t(){return dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Y());case 1:case"end":return t.stop()}}),t)}))),function(){return b.apply(this,arguments)})},{key:"update",value:function(t,r){var o;Object.values(this.entities).forEach((function(e){(0,n.zR)(e,t,r)})),St(e,"update",this,3)([t,r]),this.player&&(null===(o=u.Xx.map)||void 0===o||o.setTarget(this.player)),this.camera.update(t,r)}},{key:"placeGrabableItems",value:(m=mt(dt().mark((function t(){var e,r,n,o,i=this;return dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(Object.entries(this.entities).forEach((function(t){var e=ht(t,2),r=e[0],n=e[1];n.getType()!==V.Pn.COIN&&n.getType()!==V.Pn.ITEM_BOX||(n.destroy(),delete i.entities[parseInt(r)])})),e=[],r=0;r<u.UI.getNumItemBoxPositions();r++)n=(0,s.T5)(W.p.ItemBox),o=u.UI.getItemBoxPosition(r),n.entity.setTransform(o.x(),o.y(),o.z(),0,0,0,1),e.push(n.entity);case 3:case"end":return t.stop()}}),t,this)}))),function(){return m.apply(this,arguments)})},{key:"startPhysicsStep",value:function(t,e){var r=(0,H.L)(e,u.qH.cloneInput());this.network.startPhysicsStep(t,e,r)}},{key:"fixedUpdate",value:function(t,r){St(e,"fixedUpdate",this,3)([t,r]),Object.values(this.entities).forEach(n.AP),this.ensureCarsAreConfigured()}},{key:"ensureCarsAreConfigured",value:function(){for(var t=0,e=Object.values(this.entities);t<e.length;t++){var r=e[t];r!==this.player&&r instanceof Q.l&&(r.loadSkinFromConfig(),r.initialized&&!this.carConfiguredRecord[r.id]&&(this.carConfiguredRecord[r.id]=!0,r.makeMenuCar()))}}},{key:"loadSkinsFromBucketUpdate",value:function(t){for(var e=0,r=Object.values(t);e<r.length;e++){var n,o=ft(r[e]);try{for(o.s();!(n=o.n()).done;){var i=n.value;u.uk.setIds([{client:i.id,server:i.entityId}]),u.uk.setPlayerConfig(i.id,i.config);var a=i.entityId,c=this.entities[a];c instanceof Q.l&&i.config.car&&c.loadSkinFromInventoryItem(i.config.car)}}catch(t){o.e(t)}finally{o.f()}}}},{key:"resetStatsUI",value:function(){var t=document.getElementById("ping-counter"),e=document.getElementById("speedometer");t&&(t.textContent="-- ms"),e&&(e.textContent="---")}},{key:"roomUpdate",value:(v=mt(dt().mark((function t(e){var r,n;return dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((r=U.u.getSessionHash())&&void 0!==e.players[r]){t.next=3;break}return t.abrupt("return");case 3:if(!(0,z.GV)()){t.next=5;break}return t.abrupt("return",u.dB.broadcast.attemptToEnterGame());case 5:(n=e.players[r].config)&&this.handlePlayerConfigUpdates(n);case 7:case"end":return t.stop()}}),t,this)}))),function(t){return v.apply(this,arguments)})},{key:"handlePlayerConfigUpdates",value:(d=mt(dt().mark((function t(e){var r;return dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.car){t.next=4;break}return this.cacheCar(e.car),t.next=4,null===(r=this.player)||void 0===r?void 0:r.loadSkinFromInventoryItem(e.car);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return d.apply(this,arguments)})},{key:"cacheCar",value:function(t){localStorage.setItem("user-car-config",JSON.stringify(t))}},{key:"getCachedCar",value:function(){var t=localStorage.getItem("user-car-config");if(t)return JSON.parse(t)}},{key:"getDefaultSkin",value:function(){var t,e,r,n,o,i,a=this.getCachedCar();if(a)return(0,$.h)(a);var u,c=localStorage.getItem("defaultCar");return c&&(u=Z.FU[parseInt(c)]),{instanceId:"loader",modelId:null!==(t=null===(e=u)||void 0===e?void 0:e.model)&&void 0!==t?t:G.Model.CAVALLINO_288_GTO,wrap:{id:null!==(r=null===(n=u)||void 0===n?void 0:n.wrap)&&void 0!==r?r:G.Wrap.BLOODHOUND_RED,float:.3,pattern:1},tire:{id:null!==(o=null===(i=u)||void 0===i?void 0:i.tire)&&void 0!==o?o:G.Tire.CLASSIC,pattern:1,float:.3}}}},{key:"preloadDefaultSkin",value:(y=mt(dt().mark((function t(){var e;return dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.getDefaultSkin(),t.next=3,Promise.all([u.kz.car.preloadCar(e.modelId,e.wrap.id),u.kz.car.preloadTire(e.tire.id),u.kz.car.preLoadLicencePlate()]);case 3:case"end":return t.stop()}}),t,this)}))),function(){return y.apply(this,arguments)})},{key:"dispose",value:(p=mt(dt().mark((function t(){var r,n,o;return dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null===(r=this.initialLoadStateCanceler)||void 0===r||r.call(this),null===(n=this.roomListenerCancel)||void 0===n||n.call(this),null===(o=this.bucketListenerCancel)||void 0===o||o.call(this),this.camera.dispose(),t.next=6,St(e,"dispose",this,3)([]);case 6:case"end":return t.stop()}}),t,this)}))),function(){return p.apply(this,arguments)})}],f&&bt(r.prototype,f),h&&bt(r,h),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,f,h,p,y,d,v,m,b,g}(n.xs)},11590:(t,e,r)=>{r.d(e,{R9:()=>d,xo:()=>v,Gx:()=>b});var n=r(17414),o=r(69024),i=r(34999),a=r(74996),u=r(56359),c=r(85285),s=r(48418);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,y(n.key),n)}}function h(t,e,r){return e&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function p(t,e,r){return(e=y(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y(t){var e=function(t,e){if("object"!=l(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==l(e)?e:e+""}var d,v,m=h((function t(e,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.verticesArray=e,this.geometry=r,p(this,"enabled",void 0),p(this,"index",void 0),p(this,"debugDrawMode",void 0),p(this,"warnedOnce",void 0),p(this,"debugDrawer",void 0),p(this,"enable",(function(){n.enabled=!0})),p(this,"disable",(function(){n.enabled=!1})),p(this,"update",(function(){if(n.enabled){var t=n.debugDrawer.getIndex();n.index=t;for(var e=0;e<3*t;e++)n.verticesArray[e]=n.debugDrawer.getVertex(e);n.geometry.setDrawRange(0,3*t)}})),p(this,"reportErrorWarning",(function(t){console.log(t)})),p(this,"setDebugMode",(function(t){n.debugDrawMode=t})),p(this,"getDebugMode",(function(){return n.debugDrawMode})),p(this,"destroy",(function(){})),this.debugDrawMode=0,this.index=0,this.enabled=!0,this.warnedOnce=!1,this.debugDrawer=s.CO.proxyDebugDraw()})),b=function(){if(c.qZ){var t=new Float32Array(2e5);d=new n.u;var e=new o.Tl(t,3);d.setAttribute("position",e);var r=new i.n({color:new a.I("#ffffff")}),l=new u.e(d,r);l.frustumCulled=!0,s.Ts.scene.add(l),v=new m(t,d)}}},74009:(t,e,r)=>{var n,o,i;function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=a(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==a(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(e,{JL:()=>c,KV:()=>f,Pf:()=>l,Zc:()=>p,dB:()=>h,oI:()=>s});var c=function(t){return t[t.GAS=0]="GAS",t[t.BRAKE=1]="BRAKE",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT",t[t.DRIFT=4]="DRIFT",t[t.CAM_FORWARDS=5]="CAM_FORWARDS",t[t.CAM_BACKWARDS=6]="CAM_BACKWARDS",t[t.CAM_LEFT=7]="CAM_LEFT",t[t.CAM_RIGHT=8]="CAM_RIGHT",t[t.RESET=9]="RESET",t[t.CHAT=10]="CHAT",t[t.USE_ITEM=11]="USE_ITEM",t}({}),s=function(t){return t[t.GAS=0]="GAS",t[t.BRAKE=1]="BRAKE",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT",t[t.STEERING=4]="STEERING",t[t.DRIFT=5]="DRIFT",t[t.CAM_FORWARDS=6]="CAM_FORWARDS",t[t.CAM_BACKWARDS=7]="CAM_BACKWARDS",t[t.CAM_LEFT=8]="CAM_LEFT",t[t.CAM_RIGHT=9]="CAM_RIGHT",t[t.CAM=10]="CAM",t[t.RESET=11]="RESET",t[t.USE_ITEM=12]="USE_ITEM",t}({}),l=(s.GAS,s.BRAKE,s.LEFT,s.RIGHT,s.DRIFT,s.CAM_FORWARDS,s.CAM_BACKWARDS,s.CAM_LEFT,s.CAM_RIGHT,s.RESET,s.USE_ITEM,s.STEERING,s.CAM,{xbox:{axis:{0:[32,38,39,36,37,34,35],1:[42,48,49,46,47,44,45]},button:(n={},u(u(u(u(u(u(u(u(u(u(n,-1,[68,69]),0,[70,71]),1,[72,73]),2,[76,77]),3,[74,75]),4,[30,31]),5,[28,29]),6,[26,27]),7,[24,25]),8,[102,103]),u(u(u(u(u(u(u(n,9,[100,101]),10,[33]),11,[43]),12,[56,61]),13,[53,58]),14,[55,60]),15,[54,59]))},playstation:{axis:{0:[32,38,39,36,37,34,35],1:[42,48,49,46,47,44,45]},button:(o={},u(u(u(u(u(u(u(u(u(u(o,-1,[68,69]),0,[76,77]),1,[78,79]),2,[80,81]),3,[82,83]),4,[22,23]),5,[20,21]),6,[18,19]),7,[16,17]),8,[92,93]),u(u(u(u(u(u(u(o,9,[90,91]),10,[33]),11,[43]),12,[56,61]),13,[53,58]),14,[55,60]),15,[54,59]))},switch:{axis:{0:[32,38,39,36,37,34,35],1:[42,48,49,46,47,44,45]},button:(i={},u(u(u(u(u(u(u(u(u(u(i,-1,[68,69]),0,[72,73]),1,[70,71]),2,[74,75]),3,[76,77]),4,[30,31]),5,[28,29]),6,[26,27]),7,[24,25]),8,[98,99]),u(u(u(u(u(u(u(u(u(i,9,[96,97]),10,[33]),11,[43]),12,[56,61]),13,[53,58]),14,[55,60]),15,[54,59]),16,[86,87]),17,[88,89]))}}),f={xbox:[[{name:"LT",top:0,width:200,type:"button",index:6},{name:"LB",top:7,width:200,type:"button",index:4},{name:"LS",top:28,width:200,type:"button",index:10},{name:"Left Axis",top:32,width:180,type:"axis",index:0},{name:"Arrow Up",top:28,width:150,type:"button",index:12},{name:"Arrow Down",top:11,width:150,type:"button",index:13},{name:"Arrow Left",top:11,width:150,type:"button",index:14},{name:"Arrow Right",top:11,width:150,type:"button",index:15}],[{name:"RT",top:0,width:200,type:"button",float:"right",index:7},{name:"RB",top:7,width:200,type:"button",float:"right",index:5},{name:"X",top:12,width:190,type:"button",float:"right",index:2},{name:"Y",top:5,width:190,type:"button",float:"right",index:3},{name:"B",top:5,width:190,type:"button",float:"right",index:1},{name:"A",top:5,width:190,type:"button",float:"right",index:0},{name:"RS",top:36,width:150,type:"button",float:"right",index:11},{name:"Right Axis",top:54,width:170,type:"axis",float:"right",index:1}]],playstation:[],switch:[]},h=[{label:"Gas",index:c.GAS},{label:"Brake",index:c.BRAKE},{label:"Left",index:c.LEFT},{label:"Right",index:c.RIGHT},{label:"Drift",index:c.DRIFT},{label:"Use Item",index:c.USE_ITEM},{label:"Cam Forwards",index:c.CAM_FORWARDS},{label:"Cam Backwards",index:c.CAM_BACKWARDS},{label:"Cam Left",index:c.CAM_LEFT},{label:"Cam Right",index:c.CAM_RIGHT},{label:"Reset",index:c.RESET},{label:"Open Chat",index:c.CHAT}],p={Backquote:"`",Backslash:"\\",Backspace:"Backspace",BracketLeft:"[",BracketRight:"]",Comma:",",Digit0:"0",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Equal:"=",KeyA:"A",KeyB:"B",KeyC:"C",KeyD:"D",KeyE:"E",KeyF:"F",KeyG:"G",KeyH:"H",KeyI:"I",KeyJ:"J",KeyK:"K",KeyL:"L",KeyM:"M",KeyN:"N",KeyO:"O",KeyP:"P",KeyQ:"Q",KeyR:"R",KeyS:"S",KeyT:"T",KeyU:"U",KeyV:"V",KeyW:"W",KeyX:"X",KeyY:"Y",KeyZ:"Z",Minus:"-",Period:".",Quote:"'",Semicolon:";",Slash:"/",AltLeft:"Left Alt",AltRight:"Right Alt",CapsLock:"Caps Lock",ControlLeft:"Left Ctrl",ControlRight:"Right Ctrl",Enter:"Enter",MetaLeft:"Left Cmd ()",MetaRight:"Right Cmd () ",ShiftLeft:"Shift",ShiftRight:"Right Shift",Space:"Space",Tab:"Tab",Delete:"Delete",End:"End",Help:"Help",Home:"Home",Insert:"Insert",PageDown:"Page Down",PageUp:"Page Up",ArrowDown:"",ArrowLeft:"",ArrowRight:"",ArrowUp:"",NumLock:"Num Lock",Numpad0:"Numpad 0",Numpad1:"Numpad 1",Numpad2:"Numpad 2",Numpad3:"Numpad 3",Numpad4:"Numpad 4",Numpad5:"Numpad 5",Numpad6:"Numpad 6",Numpad7:"Numpad 7",Numpad8:"Numpad 8",Numpad9:"Numpad 9",NumpadAdd:"Numpad +",NumpadBackspace:"Numpad Backspace",NumpadClear:"Numpad Clear",NumpadClearEntry:"Numpad Clear Entry",NumpadComma:"Numpad Comma",NumpadDecimal:"Numpad Decimal",NumpadDivide:"Numpad /",NumpadEnter:"Numpad Enter",NumpadEqual:"Numpad =",NumpadHash:"Numpad #",NumpadMemoryAdd:"Numpad Memory Add",NumpadMemoryClear:"Numpad Memory Clear",NumpadMemoryRecall:"Numpad Memory Recall",NumpadMemoryStore:"Numpad Memory Store",NumpadMemorySubtract:"Numpad Memory Subtract",NumpadMultiply:"Numpad *",NumpadParenLeft:"Numpad (",NumpadParenRight:"Numpad )",NumpadStar:"Numpad *",NumpadSubtract:"Numpad -",Escape:"Escape",F1:"F1",F2:"F2",F3:"F3",F4:"F4",F5:"F5",F6:"F6",F7:"F7",F8:"F8",F9:"F9",F10:"F10",F11:"F11",F12:"F12",Fn:"Fn",FnLock:"Fn Lock",PrintScreen:"Print Screen",ScrollLock:"Scroll Lock",Pause:"Pause Break"}},34874:(t,e,r)=>{function n(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function i(t,e){for(var r=[],o=0;o<t;o++)r.push.apply(r,n(e));return r}r.d(e,{L:()=>i})},45327:(t,e,r)=>{r.d(e,{D:()=>Ge});var n=r(34999),o=r(5071),i=r(17414),a=r(78203),u=r(15393),c=r(74996),s=r(13268),l=r(63463),f=r(54494),h=r(48418),p=r(84290),y=r(41286),d=r(4322);function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function m(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return b(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function g(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,w(n.key),n)}}function w(t){var e=function(t,e){if("object"!=v(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==v(e)?e:e+""}function S(t,e,r){return e=O(e),function(t,e){if(e&&("object"==v(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,x()?Reflect.construct(e,r||[],O(t).constructor):e.apply(t,r))}function x(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(x=function(){return!!t})()}function O(t){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},O(t)}function P(t,e){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},P(t,e)}var E=function(t){function e(t,r){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=S(this,e,[new y.L,r,t.length])).buildInstancedGeometry(t[0].geometry),n.frustumCulled=!1,n.matrixAutoUpdate=!1;var o,i=0,a=m(t);try{for(a.s();!(o=a.n()).done;){var u=o.value;n.setMatrixAt(i++,u.matrix)}}catch(t){a.e(t)}finally{a.f()}return n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&P(t,e)}(e,t),r=e,(n=[{key:"buildInstancedGeometry",value:function(t){for(var e in this.geometry.index=t.index,t.attributes)t.attributes.hasOwnProperty(e)&&(this.geometry.attributes[e]=t.attributes[e])}},{key:"addMeshes",value:function(t){var e,r=this.count-t.length,n=m(t);try{for(n.s();!(e=n.n()).done;){var o=e.value;this.setMatrixAt(r++,o.matrix)}}catch(t){n.e(t)}finally{n.f()}this.count=r,this.instanceMatrix.needsUpdate=!0}}])&&g(r.prototype,n),o&&g(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(d.S),j=r(5421),k=r(47473);function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function _(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,M(n.key),n)}}function L(t,e,r){return e=C(e),function(t,e){if(e&&("object"==T(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,I()?Reflect.construct(e,r||[],C(t).constructor):e.apply(t,r))}function I(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(I=function(){return!!t})()}function C(t){return C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},C(t)}function A(t,e){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},A(t,e)}function M(t){var e=function(t,e){if("object"!=T(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==T(e)?e:e+""}var R=function(t){function e(){var t,r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,a=new Array(i),u=0;u<i;u++)a[u]=arguments[u];return t=L(this,e,[].concat(a)),r=t,o="shadow",(n=M(n="name"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&A(t,e)}(e,t),r=e,(n=[{key:"compile",value:function(t,e){e.lights_fragment_begin="\n/**\n * This is a template that can be used to light a material, it uses pluggable\n * RenderEquations (RE)for specific lighting scenarios.\n *\n * Instructions for use:\n * - Ensure that both RE_Direct, RE_IndirectDiffuse and RE_IndirectSpecular are defined\n * - If you have defined an RE_IndirectSpecular, you need to also provide a Material_LightProbeLOD. <---- ???\n * - Create a material parameter that is to be passed as the third parameter to your lighting functions.\n *\n * TODO:\n * - Add area light support.\n * - Add sphere light support.\n * - Add diffuse light probe (irradiance cubemap) support.\n */\n\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n\n#ifdef USE_CLEARCOAT\n\n\tgeometryClearcoatNormal = clearcoatNormal;\n\n#endif\n\n#ifdef USE_IRIDESCENCE\n\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\n\tif ( material.iridescenceThickness == 0.0 ) {\n\n\t\tmaterial.iridescence = 0.0;\n\n\t} else {\n\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\n\t}\n\n\tif ( material.iridescence > 0.0 ) {\n\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\n\t\t// Iridescence F0 approximation\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\n\t}\n\n#endif\n\nIncidentLight directLight;\n\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tspotLight = spotLights[ i ];\n\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\n\t\t// spot lights are ordered [shadows with maps, shadows without maps, maps without shadows, none]\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\n    DirectionalLight directionalLight;\n    #if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n    DirectionalLightShadow directionalLightShadow;\n    #endif\n\n    float combinedShadow = 1.0;\n\n\t\tvec3 shadowAmbient = vec3( 0.4 );\n\n    #pragma unroll_loop_start\n    for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n        directionalLight = directionalLights[ i ];\n\n        getDirectionalLightInfo( directionalLight, directLight );\n\n        #if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n        directionalLightShadow = directionalLightShadows[ i ];\n        combinedShadow *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n        #endif\n\n        directLight.color *= combinedShadow;\n\t\t\t\tdirectLight.color += (1.0 - combinedShadow) * shadowAmbient;\n\n        RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\n    }\n    #pragma unroll_loop_end\n\n#endif\n\n#if defined( RE_IndirectDiffuse )\n\n\tvec3 iblIrradiance = vec3( 0.0 );\n\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\n\t#if defined( USE_LIGHT_PROBES )\n\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\n\t#endif\n\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\n\t\t}\n\t\t#pragma unroll_loop_end\n\n\t#endif\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n\n#endif\n"}}])&&_(r.prototype,n),o&&_(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(r(90678).t);function N(t){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N(t)}function D(t){return function(t){if(Array.isArray(t))return B(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return B(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?B(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function F(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,U(n.key),n)}}function G(t,e,r){return(e=U(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function U(t){var e=function(t,e){if("object"!=N(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=N(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==N(e)?e:e+""}var z=G(G(G(G({},p.U.NONE,.5),p.U.LOW,.5),p.U.MEDIUM,.75),p.U.HIGH,1),W=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),G(this,"staticLights",[]),G(this,"trackingLights",[]),G(this,"dynamicObjects",[]),G(this,"staticObjects",[]),G(this,"shadowMaterialMod",void 0),this.shadowMaterialMod=new R},(e=[{key:"init",value:function(){this.updateShadowSettings(h.Xd.video.shadowQuality),this.renderStaticShadows()}},{key:"addStaticLight",value:function(t){this.staticLights.push(t),this.updateLightMapSize(t),this.renderStaticShadows()}},{key:"addTrackingLight",value:function(t){this.trackingLights.push(t),this.updateLightMapSize(t),t.light.target=h.Ts.camera}},{key:"addStaticObject",value:function(t){var e=this;(0,k.X)(t,(function(t){return e.addShadowMaterialMod(t)})),this.staticObjects.push(t)}},{key:"removeStaticObject",value:function(t){this.staticObjects=this.staticObjects.filter((function(e){return e!==t}))}},{key:"addDynamicObject",value:function(t){var e=this;(0,k.X)(t,(function(t){return e.addShadowMaterialMod(t)})),this.dynamicObjects.push(t)}},{key:"removeDynamicObject",value:function(t){this.dynamicObjects=this.dynamicObjects.filter((function(e){return e!==t}))}},{key:"forceUpdate",value:function(){this.renderStaticShadows()}},{key:"addShadowMaterialMod",value:function(t){var e=this;(0,j.h)(t.material,(function(t){t.shadowSide=l.ehD,t.addMod(e.shadowMaterialMod)}))}},{key:"updateShadowSettings",value:function(t){switch(t){case p.U.NONE:h.Ts.renderer.shadowMap.enabled=!1;break;case p.U.LOW:h.Ts.renderer.shadowMap.enabled=!0,h.Ts.renderer.shadowMap.type=l._MY;break;case p.U.MEDIUM:h.Ts.renderer.shadowMap.enabled=!0,h.Ts.renderer.shadowMap.type=l._iA;break;case p.U.HIGH:h.Ts.renderer.shadowMap.enabled=!0,h.Ts.renderer.shadowMap.type=l.ntZ}this.updateAllLights(),this.forceUpdateMaterials()}},{key:"renderStaticShadows",value:function(){this.staticObjects.forEach((function(t){(0,k.X)(t,(function(t){t.frustumCulled=!1}))})),this.staticLights.forEach((function(t){t.light.updateMatrixWorld(!0),t.light.shadow.needsUpdate=!0})),h.Ts.renderer.renderShadowMap(this.staticLights.map((function(t){return t.light})),this.staticObjects,h.Ts.camera),this.forceUpdateMaterials()}},{key:"forceUpdateMaterials",value:function(){this.staticObjects.forEach((function(t){(0,k.X)(t,(function(e){t instanceof E||(t.frustumCulled=!0),(0,j.h)(e.material,(function(t){return t.needsUpdate=!0}))}))})),this.dynamicObjects.forEach((function(t){(0,k.X)(t,(function(t){(0,j.h)(t.material,(function(t){return t.needsUpdate=!0}))}))}))}},{key:"updateAllLights",value:function(){for(var t=0,e=[].concat(D(this.staticLights),D(this.trackingLights));t<e.length;t++){var r=e[t];this.updateLightMapSize(r)}}},{key:"updateLightMapSize",value:function(t){var e=z[h.Xd.video.shadowQuality],r=s.tq?.25:1,n=Math.min(Math.floor(t.maxMapSize*e*r),h.Ts.renderer.capabilities.maxTextureSize);t.light.shadow.map=null,t.light.shadow.mapSize=new f.F(n,n)}},{key:"update",value:function(){this.dynamicObjects.forEach((function(t){(0,k.X)(t,(function(t){t.userData.frustumCulled=t.frustumCulled,t.frustumCulled=!1}))})),this.trackingLights.forEach((function(t){t.light.position.copy(h.Ts.camera.position).add(t.offset),t.light.updateMatrixWorld(!0),t.light.shadow.updateMatrices(t.light),t.light.shadow.needsUpdate=!0})),h.Ts.renderer.renderShadowMap(this.trackingLights.map((function(t){return t.light})),this.dynamicObjects,h.Ts.camera),this.dynamicObjects.forEach((function(t){(0,k.X)(t,(function(t){t.frustumCulled=t.userData.frustumCulled}))}))}}])&&F(t.prototype,e),r&&F(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),V=r(28952),H=r(85285),q=r(47898);function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function K(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$(n.key),n)}}function Y(t,e,r){return e=Z(e),function(t,e){if(e&&("object"==X(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,J()?Reflect.construct(e,r||[],Z(t).constructor):e.apply(t,r))}function J(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(J=function(){return!!t})()}function Z(t){return Z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Z(t)}function Q(t,e){return Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Q(t,e)}function $(t){var e=function(t,e){if("object"!=X(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=X(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==X(e)?e:e+""}var tt=function(t){function e(t){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n,o,i,a=t.material instanceof Array?t.material[0]:t.material;return r=Y(this,e,[new y.L,a,16]),n=r,i=[],(o=$(o="instanceReferences"))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,r.buildInstancedGeometry(t.geometry),r.expandBuffers(),r.frustumCulled=!1,r.castShadow=!0,r.receiveShadow=!0,r.matrixAutoUpdate=!1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Q(t,e)}(e,t),r=e,(n=[{key:"buildInstancedGeometry",value:function(t){for(var e in this.geometry.index=t.index,t.attributes)t.attributes.hasOwnProperty(e)&&(this.geometry.attributes[e]=t.attributes[e])}},{key:"expandBuffers",value:function(){var t=this.instanceMatrix.array.length/16*2;this.instanceMatrix=new q.l(new Float32Array(16*t),16),this.instanceColor=new q.l(new Float32Array(3*t).fill(1),3)}},{key:"addInstance",value:function(t){this.instanceReferences.push(t),this.instanceReferences.length>this.instanceMatrix.array.length/16&&this.expandBuffers()}},{key:"removeInstance",value:function(t){var e=this.instanceReferences.indexOf(t);-1!==e&&this.instanceReferences.splice(e,1)}},{key:"update",value:function(){for(var t=0,e=0;e<this.instanceReferences.length;e++)!1!==this.instanceReferences[e].userData.visible&&this.setMatrixAt(t++,this.instanceReferences[e].matrixWorld);this.count=t,this.instanceMatrix.needsUpdate=!0}}])&&K(r.prototype,n),o&&K(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(d.S);function et(t){return et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},et(t)}function rt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,nt(n.key),n)}}function nt(t){var e=function(t,e){if("object"!=et(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=et(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==et(e)?e:e+""}var ot=function(){return t=function t(){var e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,n={},(r=nt(r="instances"))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n},(e=[{key:"addMesh",value:function(t,e){var r;return void 0===this.instances[t]&&(this.instances[t]=new tt(e),this.instances[t].name=t,null===(r=h.Xx.map)||void 0===r||r.registerDynamicMesh(this.instances[t]),h.Ts.scene.add(this.instances[t])),this.instances[t].addInstance(e),this.instances[t]}},{key:"removeMesh",value:function(t,e){var r;void 0!==this.instances[t]&&(this.instances[t].removeInstance(e),0===this.instances[t].instanceReferences.length&&(h.Ts.scene.remove(this.instances[t]),null===(r=h.Xx.map)||void 0===r||r.unregisterDynamicMesh(this.instances[t]),delete this.instances[t]))}},{key:"update",value:function(){for(var t in this.instances)this.instances[t].update()}}])&&rt(t.prototype,e),r&&rt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),it=r(64195),at=r(93114),ut=r(69024),ct=r(61182),st=r(65730),lt=r(54576);function ft(t){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ft(t)}function ht(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bt(n.key),n)}}function pt(t,e,r){return e=dt(e),function(t,e){if(e&&("object"==ft(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,yt()?Reflect.construct(e,r||[],dt(t).constructor):e.apply(t,r))}function yt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(yt=function(){return!!t})()}function dt(t){return dt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},dt(t)}function vt(t,e){return vt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},vt(t,e)}function mt(t,e,r){return(e=bt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bt(t){var e=function(t,e){if("object"!=ft(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ft(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ft(e)?e:e+""}var gt=new i.u,wt=function(t){function e(t){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t.material instanceof Array?t.material[0]:t.material;return mt(r=pt(this,e,[new i.u,n.clone()]),"customDepthMaterial",void 0),mt(r,"batchedReferences",[]),mt(r,"batchedBoneMatrices",null),mt(r,"batchedBoneIndexAttribute",void 0),mt(r,"batchedBoneTexture",null),mt(r,"needsRecompute",!1),mt(r,"customUniforms",void 0),r.frustumCulled=!1,r.castShadow=!0,r.receiveShadow=!0,r.matrixAutoUpdate=!1,r.skeleton=new at.O([]),r.batchedBoneIndexAttribute=new ut.Tl(new Float32Array(0),1),r.customUniforms={batchedBoneTexture:{value:null}},r.customDepthMaterial=new ct.l({depthPacking:l.mSO}),r.initShader(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vt(t,e)}(e,t),r=e,(n=[{key:"initShader",value:function(){var t=this,e=this.material.onBeforeCompile.bind(this.material),r=function(r,n){for(var o in r.vertexShader=r.vertexShader.replace("#include <skinning_pars_vertex>","\n#ifdef USE_SKINNING\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\n#ifdef BATCHING\n  uniform highp sampler2D batchedBoneTexture;\n  attribute float batchedBoneIndex;\n#endif\n\n\tmat4 getBoneMatrix( const in float i ) {\n\n  #ifdef BATCHING\n\t\t\t\n    int y = int(batchedBoneIndex + i);\n    vec4 v1 = texelFetch(batchedBoneTexture, ivec2( 0, y ), 0);\n    vec4 v2 = texelFetch(batchedBoneTexture, ivec2( 1, y ), 0);\n    vec4 v3 = texelFetch(batchedBoneTexture, ivec2( 2, y ), 0);\n    vec4 v4 = texelFetch(batchedBoneTexture, ivec2( 3, y ), 0);\n    \n  #else\n\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\n\t\ty = dy * ( y + 0.5 );\n\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n  \n  #endif\n\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\n\t\treturn bone;\n\n\t}\n\n#endif\n"),t.customUniforms)r.uniforms[o]=t.customUniforms[o];e(r,n)};this.material.onBeforeCompile=r,this.customDepthMaterial.onBeforeCompile=r,this.material.defines=this.material.defines||{},this.material.defines.BATCHING="",this.material.defines.USE_SKINNING="",this.customDepthMaterial.defines=this.customDepthMaterial.defines||{},this.customDepthMaterial.defines.BATCHING="",this.customDepthMaterial.defines.USE_SKINNING=""}},{key:"addMesh",value:function(t){t instanceof it.T&&-1===this.batchedReferences.indexOf(t)&&(this.batchedReferences.push(t),this.needsRecompute=!0)}},{key:"removeMesh",value:function(t){var e=this.batchedReferences.indexOf(t);-1!==e&&(this.batchedReferences.splice(e,1),this.needsRecompute=!0)}},{key:"recomputeGeometry",value:function(){if(this.needsRecompute){var t=this.batchedReferences.map((function(t){return t.geometry.clone()}));0===t.length?this.geometry=gt.clone():(this.geometry=(0,lt.n4)(t),this.createBatchedBoneMatrices()),this.needsRecompute=!1}}},{key:"createBatchedBoneMatrices",value:function(){var t=new Float32Array(this.getVertexCount()),e=0,r=0;this.batchedReferences.forEach((function(n){for(var o=0;o<n.geometry.getAttribute("position").count;o++)t[r++]=e;e+=n.skeleton.bones.length})),this.batchedBoneMatrices=new Float32Array(16*e),this.batchedBoneTexture=new st.I(this.batchedBoneMatrices,4,e,l.wk1,l.VzW),this.customUniforms.batchedBoneTexture.value=this.batchedBoneTexture,this.batchedBoneIndexAttribute=new ut.Tl(t,1),this.geometry.setAttribute("batchedBoneIndex",this.batchedBoneIndexAttribute)}},{key:"getVertexCount",value:function(){return this.batchedReferences.reduce((function(t,e){return t+e.geometry.getAttribute("position").count}),0)}},{key:"updateBoneMatrices",value:function(){var t=this;if(null===this.batchedBoneMatrices&&this.createBatchedBoneMatrices(),0!==this.batchedReferences.length){var e=0;this.batchedReferences.forEach((function(r){r instanceof it.T&&(r.skeleton.update(),r.bindMatrixInverse.copy(r.matrixWorld).invert(),!1===r.userData.visible&&r.skeleton.boneMatrices.fill(0),t.batchedBoneMatrices.set(r.skeleton.boneMatrices,e),e+=r.skeleton.boneMatrices.length)})),this.batchedBoneTexture.needsUpdate=!0}}},{key:"update",value:function(){this.recomputeGeometry(),this.updateBoneMatrices()}},{key:"destroy",value:function(){}}])&&ht(r.prototype,n),o&&ht(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(it.T),St=r(97939),xt=r(97526),Ot=r(47472),Pt=r(62517),Et=r(74613),jt=r(3204),kt=r(69073);function Tt(t,e){return t.z-e.z}function _t(t,e){return e.z-t.z}class Lt{constructor(){this.index=0,this.pool=[],this.list=[]}push(t,e,r){const n=this.pool,o=this.list;this.index>=n.length&&n.push({start:-1,count:-1,z:-1,index:-1});const i=n[this.index];o.push(i),this.index++,i.start=t.start,i.count=t.count,i.z=e,i.index=r}reset(){this.list.length=0,this.index=0}}const It=new xt.y,Ct=new xt.y,At=new xt.y,Mt=new c.I(1,1,1),Rt=new xt.y,Nt=new kt.i,Dt=new Et.Z,Bt=new jt.a,Ft=new o.P,Gt=new o.P,Ut=new o.P,zt=new Lt,Wt=new Ot.K,Vt=[];function Ht(t,e,r=0){const n=e.itemSize;if(t.isInterleavedBufferAttribute||t.array.constructor!==e.array.constructor){const o=t.count;for(let i=0;i<o;i++)for(let o=0;o<n;o++)e.setComponent(i+r,o,t.getComponent(i,o))}else e.array.set(t.array,r*n);e.needsUpdate=!0}class qt extends Ot.K{get maxInstanceCount(){return this._maxInstanceCount}constructor(t,e,r=2*e,n){super(new i.u,n),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawInfos=new Map,this._activeInstances=[],this._instanceId=0,this._drawIndex=0,this._drawRanges=new Map,this._reservedRanges=new Map,this._bounds=new Map,this._geometriesToDelete=[],this._instancesToDelete=[],this._needsUpdateDrawInfos=!1,this._needsUpdateGeometry=!1,this._maxInstanceCount=t,this._maxVertexCount=e,this._maxIndexCount=r,this._geometryInitialized=!1,this._geometryCount=0,this._geometryLastId=0,this._multiDrawCounts=new Int32Array(t),this._multiDrawStarts=new Int32Array(t),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let t=Math.sqrt(4*this._maxInstanceCount);t=4*Math.ceil(t/4),t=Math.max(t,4);const e=new Float32Array(t*t*4),r=new st.I(e,t,t,l.wk1,l.VzW);this._matricesTexture=r}_initIndirectTexture(){let t=Math.sqrt(this._maxInstanceCount);t=Math.ceil(t);const e=new Uint32Array(t*t),r=new st.I(e,t,t,l.D9w,l.JQ4);this._indirectTexture=r}_initColorsTexture(){let t=Math.sqrt(this._maxIndexCount);t=Math.ceil(t);const e=new Float32Array(t*t*4).fill(1),r=new st.I(e,t,t,l.wk1,l.VzW);r.colorSpace=Pt.ep.workingColorSpace,this._colorsTexture=r}_initializeGeometry(t){const e=this.geometry,r=this._maxVertexCount,n=this._maxIndexCount;if(!1===this._geometryInitialized){for(const n in t.attributes){const o=t.getAttribute(n),{array:i,itemSize:a,normalized:u}=o,c=new i.constructor(r*a),s=new ut.Tl(c,a,u);e.setAttribute(n,s)}if(null!==t.getIndex()){const t=r>65535?new Uint32Array(n):new Uint16Array(n);e.setIndex(new ut.Tl(t,1))}this._geometryInitialized=!0}}_validateGeometry(t){const e=this.geometry;if(Boolean(t.getIndex())!==Boolean(e.getIndex()))throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const r in e.attributes){if(!t.hasAttribute(r))throw new Error(`BatchedMesh: Added geometry missing "${r}". All geometries must have consistent attributes.`);const n=t.getAttribute(r),o=e.getAttribute(r);if(n.itemSize!==o.itemSize||n.normalized!==o.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(t){return this.customSort=t,this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Et.Z);const t=this.boundingBox,e=this._drawInfos,r=this._activeInstances;t.makeEmpty();for(let n=0;n<r.length;n++){const o=e.get(r[n]);if(!1===o.active)continue;const i=o.geometryId,a=o.instanceId;this.getMatrixAt(a,It),this.getBoundingBoxAt(i,Dt).applyMatrix4(It),t.union(Dt)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new jt.a);const t=this.boundingSphere,e=this._drawInfos,r=this._activeInstances;t.makeEmpty();for(let n=0,o=r.length;n<o;n++){const o=e.get(r[n]);if(!1===o.active)continue;const i=o.geometryId,a=o.instanceId;this.getMatrixAt(a,It),this.getBoundingSphereAt(i,Bt).applyMatrix4(It),t.union(Bt)}}addInstance(t){if(this._drawInfos.size>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.",this._drawInfos.size,this._maxInstanceCount);const e=this._instanceId,r=this._drawIndex,n={visible:!0,active:!0,geometryId:t,instanceId:e,drawIndex:r};this._instanceId++,this._drawIndex++,this._activeInstances.push(e),this._drawInfos.set(e,n);const o=this._matricesTexture,i=o.image.data;At.toArray(i,16*r),o.needsUpdate=!0;const a=this._colorsTexture;return a&&(Mt.toArray(a.image.data,4*r),a.needsUpdate=!0),this._visibilityChanged=!0,e}addGeometry(t,e=-1,r=-1){if(this._initializeGeometry(t),this._validateGeometry(t),this._drawInfos.size>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.");const n={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let o=null;const i=this._reservedRanges,a=this._drawRanges,u=this._bounds;0!==this._geometryCount&&(o=[...i][i.size-1][1]),n.vertexCount=-1===e?t.getAttribute("position").count:e,n.vertexStart=null===o?0:o.vertexStart+o.vertexCount;const c=t.getIndex(),s=null!==c;if(s&&(n.indexCount=-1===r?c.count:r,n.indexStart=null===o?0:o.indexStart+o.indexCount),-1!==n.indexStart&&n.indexStart+n.indexCount>this._maxIndexCount||n.vertexStart+n.vertexCount>this._maxVertexCount)throw n.indexStart+n.indexCount>this._maxIndexCount?new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size (index). "+(n.indexStart+n.indexCount)+" > "+this._maxIndexCount):new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size (vertex). "+(n.vertexStart+n.vertexCount)+" > "+this._maxVertexCount);const l=this._geometryLastId;return this._geometryLastId++,this._geometryCount++,i.set(l,n),a.set(l,{start:s?n.indexStart:n.vertexStart,count:-1}),u.set(l,{boxInitialized:!1,box:new Et.Z,sphereInitialized:!1,sphere:new jt.a}),this.setGeometryAt(l,t),l}setGeometryAt(t,e){if(!1===this._reservedRanges.has(t))throw new Error("BatchedMesh: No geometry found with this ID");this._validateGeometry(e);const r=this.geometry,n=null!==r.getIndex(),o=r.getIndex(),i=e.getIndex(),a=this._reservedRanges.get(t);if(n&&i.count>a.indexCount||e.attributes.position.count>a.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const u=a.vertexStart,c=a.vertexCount;for(const t in r.attributes){const n=e.getAttribute(t),o=r.getAttribute(t);Ht(n,o,u);const i=n.itemSize;for(let t=n.count,e=c;t<e;t++){const e=u+t;for(let t=0;t<i;t++)o.setComponent(e,t,0)}o.needsUpdate=!0,o.addUpdateRange(u*i,c*i)}if(n){const t=a.indexStart;for(let e=0;e<i.count;e++)o.setX(t+e,u+i.getX(e));for(let e=i.count,r=a.indexCount;e<r;e++)o.setX(t+e,u);o.needsUpdate=!0,o.addUpdateRange(t,a.indexCount)}const s=this._bounds.get(t);null!==e.boundingBox?(s.box.copy(e.boundingBox),s.boxInitialized=!0):s.boxInitialized=!1,null!==e.boundingSphere?(s.sphere.copy(e.boundingSphere),s.sphereInitialized=!0):s.sphereInitialized=!1;const l=this._drawRanges.get(t),f=e.getAttribute("position");return l.count=n?i.count:f.count,this._visibilityChanged=!0,t}deleteGeometry(t){return this._reservedRanges.has(t)&&(this._geometriesToDelete.push(t),this._drawInfos.forEach((e=>{e.geometryId===t&&(e.active=!1,this._instancesToDelete.push(e.instanceId))})),this._visibilityChanged=!0),this}deleteInstance(t){const e=this._drawInfos.get(t);return void 0===e||!1===e.active||(e.active=!1,this._instancesToDelete.push(t),this._visibilityChanged=!0),this}optimize(){if(this._geometriesToDelete.length){for(let t=0;t<this._geometriesToDelete.length;t++)this._reservedRanges.delete(this._geometriesToDelete[t]),this._drawRanges.delete(this._geometriesToDelete[t]),this._bounds.delete(this._geometriesToDelete[t]),this._geometryCount--;this._geometriesToDelete.length=0,this._visibilityChanged=!0,this._needsUpdateGeometry=!0,this._optimizeGeometry()}this._instancesToDelete.length&&(this._activeInstances=this._activeInstances.filter((t=>!this._instancesToDelete.includes(t))),this._instancesToDelete.forEach((t=>{this._drawInfos.delete(t)})),this._instancesToDelete.length=0,this._needsUpdateDrawInfos=!0,this._optimizeMatricesAndColors())}_optimizeGeometry(){if(this._needsUpdateGeometry){const t=this._reservedRanges,e=this._drawRanges,r=this.geometry,n=null!==r.getIndex(),o=r.getIndex();let i=0,a=0;t.forEach(((t,u)=>{const c=e.get(u),s=t.vertexStart,l=t.vertexCount;for(const t in r.attributes){const e=r.getAttribute(t),n=e.itemSize;e.array.copyWithin(i*n,s*n,(s+l)*n),e.needsUpdate=!0}if(t.vertexStart=i,i+=l,n||(c.start=t.vertexStart),n){const e=t.indexStart,r=t.indexCount;for(let n=0;n<r;n++){const r=e+n,i=o.getX(r)-s+t.vertexStart;o.setX(r,i)}o.array.copyWithin(a,e,e+r),t.indexStart=a,a+=r,c.start=t.indexStart}}));for(const t in r.attributes){const e=r.getAttribute(t),n=e.itemSize;e.array.fill(0,i*n),e.needsUpdate=!0}n&&(o.array.fill(0,a),o.needsUpdate=!0),this._needsUpdateGeometry=!1}}_optimizeMatricesAndColors(){if(this._needsUpdateDrawInfos){const t=this._colorsTexture,e=this._matricesTexture,r=e.image.data;let n=0;this._drawInfos.forEach((e=>{r.copyWithin(16*n,16*e.drawIndex,16*e.drawIndex+16),t&&t.image.data.copyWithin(4*n,4*e.drawIndex,4*e.drawIndex+4),e.drawIndex=n,n++})),this._drawIndex=n,e.needsUpdate=!0,t&&(t.needsUpdate=!0),this._needsUpdateDrawInfos=!1}}getBoundingBoxAt(t,e){if(!1===this._drawRanges.has(t))return null;const r=this._bounds.get(t),n=r.box,o=this.geometry;if(!1===r.boxInitialized){n.makeEmpty();const e=o.index,i=o.attributes.position,a=this._drawRanges.get(t);for(let t=a.start,r=a.start+a.count;t<r;t++){let r=t;e&&(r=e.getX(r)),n.expandByPoint(Ft.fromBufferAttribute(i,r))}r.boxInitialized=!0}return e.copy(n),e}getBoundingSphereAt(t,e){if(!1===this._drawRanges.has(t))return null;const r=this._bounds.get(t),n=r.sphere,o=this.geometry;if(!1===r.sphereInitialized){n.makeEmpty(),this.getBoundingBoxAt(t,Dt),Dt.getCenter(n.center);const e=o.index,i=o.attributes.position,a=this._drawRanges.get(t);let u=0;for(let t=a.start,r=a.start+a.count;t<r;t++){let r=t;e&&(r=e.getX(r)),Ft.fromBufferAttribute(i,r),u=Math.max(u,n.center.distanceToSquared(Ft))}n.radius=Math.sqrt(u),r.sphereInitialized=!0}return e.copy(n),e}setMatrixAt(t,e){const r=this._drawInfos.get(t);if(void 0===r||!1===r.active)return this;const n=this._matricesTexture,o=this._matricesTexture.image.data;return e.toArray(o,16*r.drawIndex),n.needsUpdate=!0,this}getMatrixAt(t,e){const r=this._drawInfos.get(t);if(void 0===r||!1===r.active)return this;const n=this._matricesTexture.image.data;return e.fromArray(n,16*r.drawIndex)}setColorAt(t,e){const r=this._drawInfos.get(t);if(void 0===r||!1===r.active)return this;null===this._colorsTexture&&this._initColorsTexture();const n=this._colorsTexture,o=this._colorsTexture.image.data;return e.toArray(o,4*r.drawIndex),n.needsUpdate=!0,this}getColorAt(t,e){const r=this._drawInfos.get(t);if(void 0===r||!1===r.active)return this;const n=this._colorsTexture.image.data;return e.fromArray(n,4*r.drawIndex)}setVisibleAt(t,e){const r=this._drawInfos.get(t);return void 0===r||!1===r.active||r.visible===e||(r.visible=e,this._visibilityChanged=!0),this}getVisibleAt(t){const e=this._drawInfos.get(t);return void 0!==e&&!1!==e.active&&e.visible}raycast(t,e){const r=this._activeInstances,n=this._drawInfos,o=this._drawRanges,i=this.matrixWorld,a=this.geometry;Wt.material=this.material,Wt.geometry.index=a.index,Wt.geometry.attributes=a.attributes,null===Wt.geometry.boundingBox&&(Wt.geometry.boundingBox=new Et.Z),null===Wt.geometry.boundingSphere&&(Wt.geometry.boundingSphere=new jt.a);for(let a=0,u=r.length;a<u;a++){const u=n.get(r[a]);if(void 0===u||!u.visible||!u.active)continue;const c=u.geometryId,s=u.instanceId,l=o.get(c);Wt.geometry.setDrawRange(l.start,l.count),this.getMatrixAt(s,Wt.matrixWorld).premultiply(i),this.getBoundingBoxAt(c,Wt.geometry.boundingBox),this.getBoundingSphereAt(c,Wt.geometry.boundingSphere),Wt.raycast(t,Vt);for(let t=0,r=Vt.length;t<r;t++){const r=Vt[t];r.object=this,r.batchId=a,e.push(r)}Vt.length=0}Wt.material=null,Wt.geometry.index=null,Wt.geometry.attributes={},Wt.geometry.setDrawRange(0,1/0)}copy(t){return super.copy(t),this.geometry=t.geometry.clone(),this.perObjectFrustumCulled=t.perObjectFrustumCulled,this.sortObjects=t.sortObjects,this.boundingBox=null!==t.boundingBox?t.boundingBox.clone():null,this.boundingSphere=null!==t.boundingSphere?t.boundingSphere.clone():null,this._bounds.clear(),this._drawRanges.clear(),this._reservedRanges.clear(),this._drawInfos.clear(),t._drawRanges.forEach(((t,e)=>{this._drawRanges.set(e,{...t})})),t._reservedRanges.forEach(((t,e)=>{this._reservedRanges.set(e,{...t})})),t._bounds.forEach(((t,e)=>{this._bounds.set(e,{boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})})),t._drawInfos.forEach(((t,e)=>{this._drawInfos.set(e,{...t})})),this._activeInstances=[...t._activeInstances],this._drawIndex=t._drawIndex,this._instanceId=t._instanceId,this._maxInstanceCount=t._maxInstanceCount,this._maxVertexCount=t._maxVertexCount,this._maxIndexCount=t._maxIndexCount,this._geometryInitialized=t._geometryInitialized,this._geometryCount=t._geometryCount,this._geometryLastId=t._geometryLastId,this._multiDrawCounts=t._multiDrawCounts.slice(),this._multiDrawStarts=t._multiDrawStarts.slice(),this._matricesTexture=t._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),null!==this._colorsTexture&&(this._colorsTexture=t._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,null!==this._colorsTexture&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(t,e,r,n,o){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const i=n.getIndex(),a=null===i?1:i.array.BYTES_PER_ELEMENT,u=this._drawInfos,c=this._activeInstances,s=this._multiDrawStarts,l=this._multiDrawCounts,f=this._drawRanges,h=this.perObjectFrustumCulled,p=this._indirectTexture,y=p.image.data;h&&(Rt.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse).multiply(this.matrixWorld),Nt.setFromProjectionMatrix(Rt,t.coordinateSystem));let d=0;if(this.sortObjects){Ct.copy(this.matrixWorld).invert(),Ft.setFromMatrixPosition(r.matrixWorld).applyMatrix4(Ct),Gt.set(0,0,-1).transformDirection(r.matrixWorld).transformDirection(Ct);for(let t=0,e=c.length;t<e;t++){const e=u.get(c[t]);if(e&&e.visible&&e.active){const r=e.geometryId,n=e.instanceId,o=f.get(r);this.getMatrixAt(n,It),this.getBoundingSphereAt(r,Bt).applyMatrix4(It);let i=!1;if(h&&(i=!Nt.intersectsSphere(Bt)),!i){const e=Ut.subVectors(Bt.center,Ft).dot(Gt);zt.push(o,e,t)}}}const t=zt.list,e=this.customSort;null===e?t.sort(o.transparent?_t:Tt):e.call(this,t,r);for(let e=0,r=t.length;e<r;e++){const r=t[e];s[d]=r.start*a,l[d]=r.count,y[d]=r.index,d++}zt.reset()}else for(let t=0,e=c.length;t<e;t++){const e=u.get(c[t]);if(e&&e.visible&&e.active){const r=e.geometryId,n=e.instanceId;let o=!1;if(h&&(this.getMatrixAt(n,It),this.getBoundingSphereAt(r,Bt).applyMatrix4(It),o=!Nt.intersectsSphere(Bt)),!o){const e=f.get(r);s[d]=e.start*a,l[d]=e.count,y[d]=t,d++}}}p.needsUpdate=!0,this._multiDrawCount=d,this._visibilityChanged=!1}onBeforeShadow(t,e,r,n,o,i){this.onBeforeRender(t,null,n,o,i)}}function Xt(t){return Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xt(t)}function Kt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Yt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Kt(Object(r),!0).forEach((function(e){Zt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Kt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Jt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Qt(n.key),n)}}function Zt(t,e,r){return(e=Qt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qt(t){var e=function(t,e){if("object"!=Xt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Xt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Xt(e)?e:e+""}var $t=["f","p"],te=function(){return t=function t(e,r,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Zt(this,"instanceIdToMesh",{}),Zt(this,"geoIdToMeshes",{}),Zt(this,"mesh",void 0),Zt(this,"canDelete",!1),Zt(this,"needsOptimization",!1),Zt(this,"geoDeleteThisFrame",!1),Zt(this,"geoAddThisFrame",!1),this.mesh=new qt(r,n,o,e),this.mesh.name="StaticBatchedMesh-".concat(e.name),this.mesh.castShadow=!0,this.mesh.receiveShadow=!0,this.mesh.matrixAutoUpdate=!1,this.mesh.sortObjects=!1,this.mesh.material.defines=Yt(Yt({},this.mesh.material.defines),{},{USE_BATCHING:""})},(e=[{key:"addMesh",value:function(t,e){void 0===e&&(this.geoAddThisFrame=!0,this.convertUniformsToAttributes(t),e=this.mesh.addGeometry(t.geometry),this.geoIdToMeshes[e]=[]);var r=this.mesh.addInstance(e);return this.instanceIdToMesh[r]=t,this.geoIdToMeshes[e].push(t),this.mesh.setMatrixAt(r,t.matrixWorld),this.mesh.material.needsUpdate=!0,e}},{key:"convertUniformsToAttributes",value:function(t){var e=t.material.uniforms;e&&$t.forEach((function(r){var n=e[r];if(n){var o=new Int32Array(t.geometry.getAttribute("position").count).fill(1e6*n.value),i=new ut.Tl(o,1);t.geometry.setAttribute(r,i)}}))}},{key:"removeMesh",value:function(t){var e=this;this.needsOptimization=!0;var r=Object.keys(this.instanceIdToMesh).find((function(r){return e.instanceIdToMesh[r]===t}));if(void 0!==r){var n=parseInt(r);this.mesh.deleteInstance(n),delete this.instanceIdToMesh[n];var o=Object.keys(this.geoIdToMeshes).find((function(r){return e.geoIdToMeshes[r].includes(t)}));if(void 0!==o){var i=parseInt(o);this.geoIdToMeshes[i]=this.geoIdToMeshes[i].filter((function(e){return e!==t})),0===this.geoIdToMeshes[i].length&&(this.geoDeleteThisFrame=!0,this.mesh.deleteGeometry(i),delete this.geoIdToMeshes[i]),0===Object.keys(this.instanceIdToMesh).length&&(this.canDelete=!0)}}}},{key:"update",value:function(){!this.needsOptimization||this.geoDeleteThisFrame||this.geoAddThisFrame||(this.mesh.optimize(),this.needsOptimization=!1),this.geoDeleteThisFrame=!1,this.geoAddThisFrame=!1}},{key:"destroy",value:function(){}}])&&Jt(t.prototype,e),r&&Jt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function ee(t){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(t)}function re(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ne(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ne(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function oe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,le(n.key),n)}}function ie(t,e,r){return e=ce(e),function(t,e){if(e&&("object"==ee(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ae()?Reflect.construct(e,r||[],ce(t).constructor):e.apply(t,r))}function ae(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ae=function(){return!!t})()}function ue(){return ue="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=ce(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},ue.apply(null,arguments)}function ce(t){return ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ce(t)}function se(t,e){return se=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},se(t,e)}function le(t){var e=function(t,e){if("object"!=ee(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ee(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ee(e)?e:e+""}var fe=function(t){function e(t){var r,n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=ie(this,e,[t,400,1e5,18e4]),n=r,i=[],(o=le(o="batchedReferencesArr"))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,r.mesh.name="DynamicBatchedMesh-".concat(t.name),r.mesh.frustumCulled=!1,r.mesh.sortObjects=!1,r.mesh.perObjectFrustumCulled=!1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&se(t,e)}(e,t),r=e,n=[{key:"update",value:function(){var t,r,n,o,i;(t=e,r="update",n=this,i=ue(ce(1&(o=3)?t.prototype:t),r,n),2&o?function(t){return i.apply(n,t)}:i)([]);for(var a=0,u=Object.entries(this.instanceIdToMesh);a<u.length;a++){var c=re(u[a],2),s=c[0],l=c[1],f=parseInt(s);this.mesh.setMatrixAt(f,l.matrixWorld),this.mesh.setVisibleAt(f,l.userData.visible)}}}],n&&oe(r.prototype,n),o&&oe(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(te);function he(t){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},he(t)}function pe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,de(n.key),n)}}function ye(t,e,r){return(e=de(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function de(t){var e=function(t,e){if("object"!=he(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=he(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==he(e)?e:e+""}var ve=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.map=e,ye(this,"materialToBatchedMesh",{}),ye(this,"objIdMap",{}),ye(this,"skinnedMeshes",{})},(e=[{key:"createStaticBatchedMesh",value:function(t,e,r,n){this.removeBatchedMeshByMaterial(t),this.materialToBatchedMesh[t.name]=new te(t,e,r,n),this.map.registerStaticMesh(this.materialToBatchedMesh[t.name].mesh),h.Ts.scene.add(this.materialToBatchedMesh[t.name].mesh)}},{key:"createDynamicBatchedMesh",value:function(t){this.materialToBatchedMesh[t.name]=new fe(t),this.map.registerDynamicMesh(this.materialToBatchedMesh[t.name].mesh),h.Ts.scene.add(this.materialToBatchedMesh[t.name].mesh)}},{key:"addMesh",value:function(t,e){var r=this;e instanceof it.T?this.addSkinnedMesh(t,e):(0,St.hj)(e.material,(function(n){var o;void 0===r.materialToBatchedMesh[n.name]&&r.createDynamicBatchedMesh(n);var i=null===(o=r.objIdMap[t])||void 0===o?void 0:o.geoId,a=r.materialToBatchedMesh[n.name].addMesh(e,i);void 0===i&&(r.objIdMap[t]={material:n.name,geoId:a,referenceCount:0}),r.objIdMap[t].referenceCount++}))}},{key:"removeBatchedMeshByMaterial",value:function(t){var e=this;void 0!==this.materialToBatchedMesh[t.name]&&(Object.keys(this.objIdMap).forEach((function(r){e.objIdMap[r].material===t.name&&delete e.objIdMap[r]})),h.Ts.scene.remove(this.materialToBatchedMesh[t.name].mesh),this.materialToBatchedMesh[t.name].destroy(),this.map.unregisterStaticMesh(this.materialToBatchedMesh[t.name].mesh),delete this.materialToBatchedMesh[t.name])}},{key:"removeMesh",value:function(t,e){if(e instanceof it.T)this.removeSkinnedMesh(t,e);else{var r=this.objIdMap[t];if(void 0!==r){var n=this.materialToBatchedMesh[r.material];n.removeMesh(e),n.canDelete&&(this.map.unregisterDynamicMesh(n.mesh),h.Ts.scene.remove(n.mesh),delete this.materialToBatchedMesh[r.material]),r.referenceCount--,r.referenceCount<=0&&delete this.objIdMap[t]}}}},{key:"addSkinnedMesh",value:function(t,e){void 0===this.skinnedMeshes[t]&&(this.skinnedMeshes[t]=new wt(e),this.map.registerDynamicMesh(this.skinnedMeshes[t]),h.Ts.scene.add(this.skinnedMeshes[t])),this.skinnedMeshes[t].addMesh(e)}},{key:"removeSkinnedMesh",value:function(t,e){void 0!==this.skinnedMeshes[t]&&(this.skinnedMeshes[t].removeMesh(e),0===this.skinnedMeshes[t].batchedReferences.length&&(this.map.unregisterDynamicMesh(this.skinnedMeshes[t]),h.Ts.scene.remove(this.skinnedMeshes[t]),delete this.skinnedMeshes[t]))}},{key:"update",value:function(){for(var t in this.materialToBatchedMesh)this.materialToBatchedMesh[t].update();for(var e in this.skinnedMeshes)this.skinnedMeshes[e].update()}}])&&pe(t.prototype,e),r&&pe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),me=r(1674);function be(t){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},be(t)}function ge(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Se(n.key),n)}}function we(t,e,r){return(e=Se(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Se(t){var e=function(t,e){if("object"!=be(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=be(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==be(e)?e:e+""}var xe=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),we(this,"additiveHandler",void 0),we(this,"normalHandler",void 0),this.additiveHandler=new me.ld({maxParticleHandlers:300}),this.normalHandler=new me.ld({blendingMode:l.bdR}),this.additiveHandler.renderOrder=2,this.normalHandler.renderOrder=1},(e=[{key:"addToScene",value:function(){h.Ts.scene.add(this.normalHandler),h.Ts.scene.add(this.additiveHandler)}},{key:"removeFromScene",value:function(){h.Ts.scene.remove(this.normalHandler),h.Ts.scene.remove(this.additiveHandler)}},{key:"setTextureAtlas",value:function(t,e,r){this.additiveHandler.setTextureAtlas(t,e,r),this.normalHandler.setTextureAtlas(t,e,r)}},{key:"fixedUpdate",value:function(){this.additiveHandler.fixedUpdate(),this.normalHandler.fixedUpdate()}},{key:"update",value:function(t){var e=h.Ts.camera.zoom*h.Xd.video.renderScale*.1;this.normalHandler.setPointMultiplier(e),this.normalHandler.update(t),this.additiveHandler.setPointMultiplier(e),this.additiveHandler.update(t)}}])&&ge(t.prototype,e),r&&ge(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),Oe=r(74653),Pe=r(59676),Ee=r(58345);function je(t){return je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},je(t)}function ke(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Te(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Te(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function Te(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ie(n.key),n)}}function Le(t,e,r){return(e=Ie(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ie(t){var e=function(t,e){if("object"!=je(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=je(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==je(e)?e:e+""}var Ce=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Le(this,"driftMaterials",[]),Le(this,"legacyMaterials",[])},(e=[{key:"registerMaterial",value:function(t){var e=this;(0,St.hj)(t,(function(t){t instanceof St.qn?(e.driftMaterials.push(t),h.Xd.video.advancedMaterialFxEnabled?t.enableAdvancedFx():t.disableAdvancedFx()):t instanceof Ee.F&&(e.legacyMaterials.push(t),e.updateAdvancedFxForLegacyMaterial(t,h.Xd.video.advancedMaterialFxEnabled))}))}},{key:"unregisterMaterial",value:function(t){var e=this;(0,St.hj)(t,(function(t){if(t instanceof St.qn){var r=e.driftMaterials.indexOf(t);-1!==r&&e.driftMaterials.splice(r,1)}else{var n=e.legacyMaterials.indexOf(t);-1!==n&&e.legacyMaterials.splice(n,1)}}))}},{key:"updateAdvancedMaterialFx",value:function(t){var e,r=ke(this.driftMaterials);try{for(r.s();!(e=r.n()).done;){var n=e.value;t?n.enableAdvancedFx():n.disableAdvancedFx()}}catch(t){r.e(t)}finally{r.f()}var o,i=ke(this.legacyMaterials);try{for(i.s();!(o=i.n()).done;){var a=o.value;this.updateAdvancedFxForLegacyMaterial(a,t)}}catch(t){i.e(t)}finally{i.f()}}},{key:"updateAdvancedFxForLegacyMaterial",value:function(t,e){var r;e?(t.defines||(t.defines={}),t.defines.ADVANCED_MATERIAL_FX=""):null===(r=t.defines)||void 0===r||delete r.ADVANCED_MATERIAL_FX}},{key:"update",value:function(t){var e,r=ke(this.driftMaterials);try{for(r.s();!(e=r.n()).done;)e.value.update(t)}catch(t){r.e(t)}finally{r.f()}}}])&&_e(t.prototype,e),r&&_e(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Ae(t){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ae(t)}function Me(){Me=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function m(){}function b(){}function g(){}var w={};s(w,a,(function(){return this}));var S=Object.getPrototypeOf,x=S&&S(S(I([])));x&&x!==r&&n.call(x,a)&&(w=x);var O=g.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==Ae(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=d,n.method="throw",n.arg=s.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Ae(e)+" is not iterable")}return b.prototype=g,o(O,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},P(E.prototype),s(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(O),s(O,c,"Generator"),s(O,a,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Re(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Ne(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Re(i,n,o,a,u,"next",t)}function u(t){Re(i,n,o,a,u,"throw",t)}a(void 0)}))}}function De(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Fe(n.key),n)}}function Be(t,e,r){return(e=Fe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fe(t){var e=function(t,e){if("object"!=Ae(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ae(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ae(e)?e:e+""}var Ge=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=e,Be(this,"mapCamera",void 0),Be(this,"spectatorCameras",void 0),Be(this,"staticEntities",[]),Be(this,"podiumSpawnPoints",[]),Be(this,"fogHandler",void 0),Be(this,"shadowHandler",void 0),Be(this,"materialHandler",void 0),Be(this,"particleSystem",void 0),Be(this,"instancedMeshHandler",void 0),Be(this,"batchedMeshHandler",void 0),Be(this,"target",void 0),Be(this,"debugLines",void 0),Be(this,"debugPoints",void 0),Be(this,"isDestroyed",void 0),Be(this,"init",void 0),this.shadowHandler=new W,this.materialHandler=new Ce,this.particleSystem=new xe,this.instancedMeshHandler=new ot,this.batchedMeshHandler=new ve(this),this.debugLines=[],this.debugPoints=[],this.isDestroyed=!1},e=[{key:"loadCollision",value:(l=Ne(Me().mark((function t(e,r){var n,o=arguments;return Me().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>2&&void 0!==o[2]&&o[2],e.loadCollision(r,r.length,n),t.next=4,(0,V.e)(e);case 4:H.qZ&&this.debugDrawBestPath(),h.yu.completeWork(3);case 6:case"end":return t.stop()}}),t,this)}))),function(t,e){return l.apply(this,arguments)})},{key:"ready",value:function(){this.shadowHandler.init()}},{key:"update",value:function(t,e){var r;this.staticEntities.forEach((function(r){return r.update(t,e)})),this.instancedMeshHandler.update(),this.batchedMeshHandler.update(),this.particleSystem.update(t),null===(r=this.fogHandler)||void 0===r||r.update(t),this.materialHandler.update(t),this.shadowHandler.update()}},{key:"registerStaticMesh",value:function(t){var e;this.shadowHandler.addStaticObject(t),null===(e=this.fogHandler)||void 0===e||e.addFogObject(t),this.materialHandler.registerMaterial(t.material)}},{key:"unregisterStaticMesh",value:function(t){this.shadowHandler.removeStaticObject(t),this.materialHandler.unregisterMaterial(t.material)}},{key:"registerDynamicMesh",value:function(t){var e;this.shadowHandler.addDynamicObject(t),null===(e=this.fogHandler)||void 0===e||e.addFogObject(t),this.materialHandler.registerMaterial(t.material)}},{key:"unregisterDynamicMesh",value:function(t){this.shadowHandler.removeDynamicObject(t),this.materialHandler.unregisterMaterial(t.material)}},{key:"registerAdditiveParticleHandler",value:function(t){this.particleSystem.additiveHandler.addHandler(t)}},{key:"registerNormalParticleHandler",value:function(t){this.particleSystem.normalHandler.addHandler(t)}},{key:"compileMap",value:(s=Ne(Me().mark((function t(e,r){var n;return Me().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,Pe.rW)(e,r);case 2:return n=t.sent,h.yu.completeWork(8),t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)}))),function(t,e){return s.apply(this,arguments)})},{key:"setTarget",value:function(t){var e,r;this.target=t,null===(e=this.spectatorCameras)||void 0===e||e.setTarget(t),null===(r=this.mapCamera)||void 0===r||r.setTarget(t)}},{key:"fixedUpdate",value:function(t){this.staticEntities.forEach((function(t){t.fixedUpdate&&t.fixedUpdate()})),this.particleSystem.fixedUpdate()}},{key:"debugDrawBestPath",value:function(){for(var t=h.UI.getNumCheckpoints(),e=0;e<t;e++)this.debugDrawCheckpointLine(h.UI.getCheckpoint(e))}},{key:"debugDrawCheckpointLine",value:function(t){for(var e=t.getNumPoints(),r=new n.n({color:255}),u=new n.n({color:16711680}),c=new n.n({color:65280}),s=[],l=[],f=[],p=0;p<e;p++){var y=t.getPoint(p),d=t.getLeftPoint(p),v=t.getRightPoint(p);s.push(new o.P(y.x(),y.y(),y.z())),l.push(new o.P(d.x(),d.y(),d.z())),f.push(new o.P(v.x(),v.y(),v.z()))}var m=(new i.u).setFromPoints(s),b=new a.x(m,r);this.debugLines.push(b),h.Ts.scene.add(b);var g=(new i.u).setFromPoints(l),w=new a.x(g,u);this.debugLines.push(w),h.Ts.scene.add(w);var S=(new i.u).setFromPoints(f),x=new a.x(S,c);this.debugLines.push(x),h.Ts.scene.add(x),this.debugDrawPoint(t.getC1(),void 0,"#00ff00"),this.debugDrawPoint(t.getC2(),void 0,"#00ff00"),this.debugDrawPoint(t.getT1(),t.getC1(),"#ff0000"),this.debugDrawPoint(t.getT2(),t.getC2(),"#0000ff")}},{key:"debugDrawPoint",value:function(t,e,r){var n=void 0===e?new o.P(0,0,0):new o.P(e.x(),e.y(),e.z()),i=new o.P(t.x(),t.y(),t.z());e&&(i=i.multiplyScalar(.1));var a=new u.t(new o.P(0,0,0),i.add(n),10,new c.I(r||16711680));this.debugPoints.push(a),h.Ts.scene.add(a)}},{key:"setPodiumVisibility",value:function(t){this.staticEntities.forEach((function(e){e instanceof Oe.T&&(e.visible=t)}))}},{key:"dispose",value:function(){var t;h.Ts.scene.background=null,h.Ts.scene.environment=null,this.staticEntities.forEach((function(t){t.destroy&&t.destroy()})),this.particleSystem.removeFromScene(),null===(t=this.fogHandler)||void 0===t||t.dispose(),this.debugLines.forEach((function(t){return h.Ts.scene.remove(t)})),this.debugPoints.forEach((function(t){return h.Ts.scene.remove(t)})),this.isDestroyed=!0}}],e&&De(t.prototype,e),r&&De(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,s,l}()},45635:(t,e,r)=>{r.d(e,{z:()=>tt});const n=r.p+"892a644dd76e59da700a.jpg";var o=r(46884),i=r(56585);const a=r.p+"ca71629f045a4828c85a.svg";var u=r(83362),c=r(84454),s=r(48607),l=r(84816),f=r(65527),h=r(31748),p=r(83714),y=r(38684),d=r(85333),v=r(23631),m=r(74604),b=r(94701),g=r(78302),w=r(75607),S=r(90397),x=r(58680),O=r(31261),P=r(45265),E=r(12318),j=r(31063),k=r(58558),T=r(2192),_=r(80445),L=r(80837),I=r(35909),C=r(51847),A=r(82924),M=r(71403),R=r(79760),N=r(98255),D=r(72081),B=r(90167),F=r(70562),G=r(19235),U=r(29061),z=r(1577),W=r(3047),V=r(97385),H=r(87336),q=r(2920),X=r(1037),K=r(69626),Y=r(70633),J=r(96053),Z=r(90206),Q=r(74104),$=r(18820),tt={required:[{name:"fiveTone",src:n,type:"texture"},{name:"particleAtlas",src:i,type:"texture"}],optional:[{name:"missile",src:m,type:"model"},{name:"megaMissile",src:b,type:"model"},{name:"crate",src:g,type:"model"},{name:"soccerBall",src:w,type:"model"},{name:"coin",src:S,type:"model"},{name:"itemBox",src:x,type:"model"},{name:"plate",src:o,type:"texture"},{name:"boostpad",src:u,type:"texture"},{name:"carEngine",src:E,type:"positionalAudio"},{name:"carCollision",src:j,type:"positionalAudio"},{name:"tireSkid",src:T,type:"positionalAudio"},{name:"charge1",src:_,type:"audio"},{name:"charge2",src:L,type:"audio"},{name:"charge3",src:I,type:"audio"},{name:"sparks",src:A,type:"positionalAudio"},{name:"boost",src:k,type:"positionalAudio"},{name:"missileExplosion",src:B,type:"positionalAudio"},{name:"missileFly",src:F,type:"positionalAudio"},{name:"missileLauncherOpen",src:G,type:"audio"},{name:"missileLauncherClose",src:U,type:"audio"},{name:"missileLaunch",src:W,type:"positionalAudio"},{name:"missileTarget",src:z,type:"audio"},{name:"itemBoxCollision",src:V,type:"audio"},{name:"itemBoxSpin",src:H,type:"audio"},{name:"coinCollision",src:q,type:"positionalAudio"},{name:"ballCollision",src:X,type:"positionalAudio"},{name:"coinPickup",src:K,type:"audio"},{name:"crateUnlock",src:r(66515),type:"audio"},{name:"crateUnlockLaunch",src:r(37866),type:"audio"},{name:"crateLanding",src:r(57643),type:"audio"},{name:"crateOpen",src:r(30199),type:"audio"},{name:"button",src:M,type:"audio"},{name:"buttonCancel",src:R,type:"audio"},{name:"click1",src:Y,type:"audio"},{name:"clickDown",src:J,type:"audio"},{name:"clickUp",src:Z,type:"audio"},{name:"xpGain",src:Q,type:"audio"},{name:"levelUp",src:$,type:"audio"},{name:"countdown",src:N,type:"audio"},{name:"countdownGo",src:D,type:"audio"},{name:"bounce",src:C,type:"audio"},{name:"exclamation",src:a,type:"texture"},{name:"license",src:O,type:"model"},{name:"standard_crate",src:P,type:"model"},{name:"coinIcon",src:c,type:"texture"},{name:"crateIcon",src:s,type:"texture"},{name:"nitroIcon",src:l,type:"texture"},{name:"fireNitroIcon",src:f,type:"texture"},{name:"nitro2Icon",src:h,type:"texture"},{name:"nitro3Icon",src:p,type:"texture"},{name:"missileIcon",src:y,type:"texture"},{name:"missile2Icon",src:d,type:"texture"},{name:"megaMissileIcon",src:v,type:"texture"}]}},9986:(t,e,r)=>{r.d(e,{e:()=>ve,r:()=>be});var n=r(47472),o=r(63463),i=r(17116),a=r(48418),u=r(97939),c=r(42890),s=r(6871),l=r(74996),f=r(82491),h=r(59676);function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,g(n.key),n)}}function d(t,e,r){return e=m(e),function(t,e){if(e&&("object"==p(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,v()?Reflect.construct(e,r||[],m(t).constructor):e.apply(t,r))}function v(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(v=function(){return!!t})()}function m(t){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},m(t)}function b(t,e){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},b(t,e)}function g(t){var e=function(t,e){if("object"!=p(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==p(e)?e:e+""}var w=function(t){function e(t){var r,n,i,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=d(this,e,[t,new s.j({uniforms:{color:{value:new l.I(15912352)}},vertexShader:"\n  varying vec2 vUv;\n    \n  void main() {\n    // we flip the y coordinate so it makes more sense coming in from blender\n    vUv = vec2(uv.x, 1.0 - uv.y);\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  }\n",fragmentShader:"\n  uniform vec3 color;\n  varying vec2 vUv;\n\n  void main() {\n    float alpha = mix(0.0, 0.4, vUv.y);\n    gl_FragColor = vec4(color, alpha);\n  }\n",transparent:!0,depthWrite:!1,side:o.Wl3})]),n=r,a="ray",(i=g(i="staticEntityId"))in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a,r.castShadow=!1,r.receiveShadow=!1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e)}(e,t),r=e,(n=[{key:"getType",value:function(){return h.Pn.WORLD_OBJ}}])&&y(r.prototype,n),i&&y(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(f.M),S=r(74653);function x(t){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x(t)}function O(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,T(n.key),n)}}function P(t,e,r){return e=j(e),function(t,e){if(e&&("object"==x(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,E()?Reflect.construct(e,r||[],j(t).constructor):e.apply(t,r))}function E(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(E=function(){return!!t})()}function j(t){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},j(t)}function k(t,e){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},k(t,e)}function T(t){var e=function(t,e){if("object"!=x(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=x(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==x(e)?e:e+""}var _=function(t){function e(){var t,r,n,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=P(this,e,[{defines:{USE_ENVMAP:""},uniforms:{_color:{value:new l.I(2571328)},_offset:{value:1},_b:{value:.8},_a:{value:12},_lineAlpha:{value:.1},_cameraPosition:{value:a.Ts.camera.position},_envMap:{value:a.Ts.scene.background},_envMapRatio:{value:.9}},vertexShader:"\nvarying vec2 vUv;\nvarying vec3 vViewDirection;\n\nuniform vec3 _cameraPosition;\n\n#include <skinning_pars_vertex>\n\nvoid main() {\n  #include <beginnormal_vertex>\n  #include <skinbase_vertex>\n  #include <skinnormal_vertex>\n  #include <begin_vertex>\n  #include <morphtarget_vertex>\n  #include <skinning_vertex>\n  #include <displacementmap_vertex>\n  #include <worldpos_vertex>\n  #include <clipping_planes_vertex>\n\n  vec4 viewPosition = modelViewMatrix * vec4(transformed, 1.0);\n  vViewDirection = normalize(-viewPosition.xyz);\n  vUv = uv;\n\n  gl_Position = projectionMatrix * viewPosition;\n}\n",fragmentShader:"\nvarying vec3 vViewDirection;\nvarying vec2 vUv;\n\nuniform vec3 _cameraPosition;\nuniform samplerCube _envMap;\nuniform float _envMapRatio;\nuniform vec3 _color;\nuniform float _offset;\nuniform float _b;\nuniform float _a;\nuniform float _lineAlpha;\n\nvoid main() {\n    vec2 adjustedUv = fract(vUv) + vViewDirection.xy;\n    float lineInput = abs(adjustedUv.r + adjustedUv.g) - _offset;\n    float lineStep1 = step(0.5, lineInput);\n    float lineStep2 = step(0.2, sin(pow(lineInput, _b) * _a));\n    float lineEffect = clamp(-lineStep1 + lineStep2, 0.0, 1.0) * _lineAlpha;\n    vec3 reflectedDirection = reflect(normalize(vViewDirection), normalize(vec3(-vViewDirection.x, vViewDirection.yz)));\n    vec4 envColor = textureCube(_envMap, reflectedDirection);\n    vec3 finalColor = mix(envColor.rgb, _color, _envMapRatio) + vec3(lineEffect);\n    gl_FragColor = vec4(finalColor, 1.0);\n}\n"}]),r=t,o="StaticToonGlassMaterial",(n=T(n="name"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&k(t,e)}(e,t),r=e,n&&O(r.prototype,n),o&&O(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(s.j);function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function I(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,N(n.key),n)}}function C(t,e,r){return e=M(e),function(t,e){if(e&&("object"==L(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,A()?Reflect.construct(e,r||[],M(t).constructor):e.apply(t,r))}function A(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(A=function(){return!!t})()}function M(t){return M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},M(t)}function R(t,e){return R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},R(t,e)}function N(t){var e=function(t,e){if("object"!=L(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=L(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==L(e)?e:e+""}var D=function(t){function e(t){var r,n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=C(this,e,[t,new _]),n=r,i="glass",(o=N(o="staticEntityId"))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&R(t,e)}(e,t),r=e,(n=[{key:"getType",value:function(){return h.Pn.WORLD_OBJ}}])&&I(r.prototype,n),o&&I(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(f.M);function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function F(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function G(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?F(Object(r),!0).forEach((function(e){q(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function U(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,X(n.key),n)}}function z(t,e,r){return e=V(e),function(t,e){if(e&&("object"==B(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,W()?Reflect.construct(e,r||[],V(t).constructor):e.apply(t,r))}function W(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(W=function(){return!!t})()}function V(t){return V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},V(t)}function H(t,e){return H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},H(t,e)}function q(t,e,r){return(e=X(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function X(t){var e=function(t,e){if("object"!=B(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=B(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==B(e)?e:e+""}var K=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),q(t=z(this,e),"name","BoostpadMaterial"),q(t,"vertexShader","\n  varying vec2 vUv;\n\n  #include <fog_pars_vertex>\n    \n  void main() {\n    #include <batching_vertex>\n\n    #include <begin_vertex>\n\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\n    #include <worldpos_vertex>\n    #include <fog_vertex>\n  }\n"),q(t,"fragmentShader","\n  uniform sampler2D boostpadTexture;\n  uniform float time;\n  uniform float scrollSpeed;\n  \n  varying vec2 vUv;\n\n  #include <fog_pars_fragment>\n\n  void main() {\n    vec2 scrollUV = vec2(vUv.x, mod(vUv.y * 2.0 - time * scrollSpeed, 1.0));\n\n    // Producing a consistent rainbow effect based on time and UVs\n    float phase = vUv.y * 2.0 * 3.14159; // Multiply by 2PI for a full cycle over [0,1]\n    float red = sin(time + phase) * 0.5 + 0.5;\n    float green = sin(time + phase + 2.0) * 0.5 + 0.5;\n    float blue = sin(time + phase + 4.0) * 0.5 + 0.5;\n    vec3 rainbowColor = vec3(red, green, blue);\n    vec3 tonedColor = mix(rainbowColor, vec3(0.5, 0.5, 0.5), 0.6);\n\n    // Sample the texture\n    vec4 texColor = texture2D(boostpadTexture, scrollUV);\n\n    // Modulate texture color with the rainbow effect\n    gl_FragColor = vec4(texColor.rgb * tonedColor, texColor.a);\n\n    #include <fog_fragment>\n  }\n"),t.defines=G(G({},t.defines),{},{USE_UV:""}),t.uniforms=G(G({},t.uniforms),{},{time:{value:0},scrollSpeed:{value:1},boostpadTexture:{value:null}}),a.Jb.textures.boostpad.then((function(e){e.wrapS=o.rpg,e.wrapT=o.rpg,e.minFilter=o.wem,e.magFilter=o.wem,t.uniforms.boostpadTexture.value=e,t.needsUpdate=!0})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&H(t,e)}(e,t),r=e,(n=[{key:"update",value:function(t){this.uniforms.time.value+=t}}])&&U(r.prototype,n),i&&U(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(u.qn);function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function J(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,et(n.key),n)}}function Z(t,e,r){return e=$(e),function(t,e){if(e&&("object"==Y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Q()?Reflect.construct(e,r||[],$(t).constructor):e.apply(t,r))}function Q(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Q=function(){return!!t})()}function $(t){return $=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$(t)}function tt(t,e){return tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},tt(t,e)}function et(t){var e=function(t,e){if("object"!=Y(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Y(e)?e:e+""}var rt=function(t){function e(t){var r,n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=Z(this,e,[t,new K]),n=r,i="boostvisuals",(o=et(o="staticEntityId"))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tt(t,e)}(e,t),r=e,(n=[{key:"getType",value:function(){return h.Pn.WORLD_OBJ}}])&&J(r.prototype,n),o&&J(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(f.M),nt=r(69024);function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function it(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lt(n.key),n)}}function at(t,e,r){return e=ct(e),function(t,e){if(e&&("object"==ot(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ut()?Reflect.construct(e,r||[],ct(t).constructor):e.apply(t,r))}function ut(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ut=function(){return!!t})()}function ct(t){return ct=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ct(t)}function st(t,e){return st=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},st(t,e)}function lt(t){var e=function(t,e){if("object"!=ot(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ot(e)?e:e+""}var ft=function(t){function e(t){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n,i,a,u=new s.j({uniforms:{time:{value:0},scrollSpeed:{value:-6}},vertexShader:"\n  attribute vec3 color;\n\n  varying vec2 vUv;\n  varying vec3 vColor;\n    \n  void main() {\n    vUv = uv;\n    vColor = color;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  }\n",fragmentShader:"\n  uniform float time;\n  uniform float scrollSpeed;\n\n  varying vec2 vUv;\n  varying vec3 vColor;\n\n  void main() {\n    // Calculate distance from the center\n    vec2 center = vec2(0.5, 0.5);\n    float dist = distance(vUv, center);\n\n    // Create a wave effect based on distance from the center\n    float wave = sin(10.0 * 3.14159 * dist - time * scrollSpeed);\n    float attenuatedWave = smoothstep(0.1, 0.5, wave);\n\n    // Change the green hue based on the wave\n    vec3 tonedColor = mix(vColor * attenuatedWave, vColor * 0.5, 0.5);\n\n    gl_FragColor = vec4(tonedColor, 1.0);\n  }\n",side:o.ehD});r=at(this,e,[t,u]),n=r,a="bouncevisuals",(i=lt(i="staticEntityId"))in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a;var c=r.geometry.attributes.position.count,l=new Float32Array(3*c),f=0;t.forEach((function(t){for(var e=t.userData,n=t.geometry.attributes.position.count,o=void 0!==(null==e?void 0:e.bounceType)?parseInt(e.bounceType):0,i=r.getBounceColor(o),a=0;a<n;a++)l[3*f]=i.r,l[3*f+1]=i.g,l[3*f+2]=i.b,f++}));var h=new nt.Tl(l,3);return r.geometry.setAttribute("color",h),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&st(t,e)}(e,t),r=e,(n=[{key:"update",value:function(t){this.material.uniforms.time.value+=t}},{key:"getBounceColor",value:function(t){if(0==t)return new l.I(4587342);if(1==t)return new l.I(16729413);throw new Error("Invalid bouncepad type: "+t)}},{key:"getType",value:function(){return h.Pn.WORLD_OBJ}}])&&it(r.prototype,n),i&&it(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(f.M);function ht(t){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(t)}function pt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bt(n.key),n)}}function yt(t,e,r){return e=vt(e),function(t,e){if(e&&("object"==ht(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,dt()?Reflect.construct(e,r||[],vt(t).constructor):e.apply(t,r))}function dt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(dt=function(){return!!t})()}function vt(t){return vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vt(t)}function mt(t,e){return mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},mt(t,e)}function bt(t){var e=function(t,e){if("object"!=ht(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ht(e)?e:e+""}var gt=function(t){function e(t){var r,n,i,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=yt(this,e,[t,new s.j({uniforms:{time:{value:0},scrollSpeed:{value:1}},vertexShader:"\n  varying vec2 vUv;\n    \n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  }\n",fragmentShader:"\n  uniform float time;\n  uniform float scrollSpeed;\n  \n  varying vec2 vUv;\n\n  void main() {\n    // Producing a consistent rainbow effect based on time and UVs\n    float phase = vUv.y * 2.0 * 3.14159; // Multiply by 2PI for a full cycle over [0,1]\n    float red = sin(time + phase) * 0.5 + 0.5;\n    float green = sin(time + phase + 2.0) * 0.5 + 0.5;\n    float blue = sin(time + phase + 4.0) * 0.5 + 0.5;\n    vec3 rainbowColor = vec3(red, green, blue);\n    vec3 tonedColor = mix(rainbowColor, vec3(0.5, 0.5, 0.5), 0.6);\n\n\n    // Modulate texture color with the rainbow effect\n    gl_FragColor = vec4(tonedColor, 1.0);\n  }\n",side:o.ehD})]),n=r,a="rainbow",(i=bt(i="staticEntityId"))in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mt(t,e)}(e,t),r=e,(n=[{key:"update",value:function(t){this.material.uniforms.time.value+=t}},{key:"getType",value:function(){return h.Pn.WORLD_OBJ}}])&&pt(r.prototype,n),i&&pt(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(f.M);function wt(t){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wt(t)}function St(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jt(n.key),n)}}function xt(t,e,r){return e=Pt(e),function(t,e){if(e&&("object"==wt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ot()?Reflect.construct(e,r||[],Pt(t).constructor):e.apply(t,r))}function Ot(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ot=function(){return!!t})()}function Pt(t){return Pt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pt(t)}function Et(t,e){return Et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Et(t,e)}function jt(t){var e=function(t,e){if("object"!=wt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=wt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==wt(e)?e:e+""}var kt=function(t){function e(t){var r,n,i,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=xt(this,e,[t,new s.j({uniforms:{time:{value:0},scrollSpeed:{value:.01}},vertexShader:"\n  varying vec2 vUv;\n    \n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  }\n",fragmentShader:"\nuniform float time;\nuniform float scrollSpeed;\n\nvarying vec2 vUv;\n\nvoid main() {\n  // Create diagonal bands by combining x and y, add scrolling\n  float diagonal1 = vUv.x + time * scrollSpeed;\n  float diagonal2 = vUv.y - time * scrollSpeed;\n\n  // Generate bands with sharp transitions for both diagonals\n  float bandPattern1 = step(0.1, fract(diagonal1 * 20.0));\n  float bandPattern2 = step(0.1, fract(diagonal2 * 20.0));\n\n  // Combine the two patterns to create a crosshatch effect\n  float crossHatchPattern = min(bandPattern1, bandPattern2);\n\n  // Use bands to mix between rainbow colors and white\n  float phase = diagonal1 * 3.14159 * 2.0; // Full cycle phase\n  float red = sin(phase) * 0.5 + 0.5;\n  float green = sin(phase + 2.0) * 0.5 + 0.5;\n  float blue = sin(phase + 4.0) * 0.5 + 0.5;\n  vec3 rainbowColor = vec3(red, green, blue);\n  vec3 whitewashedColor = mix(vec3(1.0, 1.0, 1.0), rainbowColor, 0.6);\n\n  // Mix with white based on crosshatch pattern\n  vec3 color = mix(whitewashedColor, vec3(1.0), crossHatchPattern) * 0.7;\n\n  gl_FragColor = vec4(color, 1.0);\n}\n",side:o.ehD})]),n=r,a="loadingbarrier",(i=jt(i="staticEntityId"))in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Et(t,e)}(e,t),r=e,(n=[{key:"update",value:function(t){this.material.uniforms.time.value+=t}},{key:"getType",value:function(){return h.Pn.WORLD_OBJ}}])&&St(r.prototype,n),i&&St(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(f.M);function Tt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return _t(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_t(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var Lt={ocean:c.I,ray:w,podiumobj:S.T,glass:D,boostvisuals:rt,bouncevisuals:ft,rainbow:gt,loadingbarrier:kt};function It(t){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},It(t)}function Ct(t){return function(t){if(Array.isArray(t))return Nt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Rt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function At(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Rt(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function Mt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||Rt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rt(t,e){if(t){if("string"==typeof t)return Nt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Nt(t,e):void 0}}function Nt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Dt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Bt(n.key),n)}}function Bt(t){var e=function(t,e){if("object"!=It(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=It(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==It(e)?e:e+""}var Ft=function(){return t=function t(e){var r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.processor=e,r=this,o={},(n=Bt(n="staticEntityMap"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o},(e=[{key:"identifyStaticEntity",value:function(t){var e,r=function(t){if(t instanceof n.K){var e=t.name.toLowerCase();return Object.keys(Lt).find((function(t){return e.includes(t)}))}}(t);return!!(r&&t instanceof n.K)&&(void 0===this.staticEntityMap[r]&&(this.staticEntityMap[r]=[]),null===(e=this.staticEntityMap[r])||void 0===e||e.push(t),!0)}},{key:"createStaticEntities",value:function(){for(var t,e,r=0,n=Object.entries(this.staticEntityMap);r<n.length;r++){var o,i=Mt(n[r],2),a=i[0],u=i[1],c=At(this.processor.staticEntities);try{for(c.s();!(o=c.n()).done;){var s=o.value;if(a===s.staticEntityId){s.addMeshes(u),delete this.staticEntityMap[a];break}}}catch(t){c.e(t)}finally{c.f()}}var l,f,h=(l=this.staticEntityMap,f=[],Object.entries(l).forEach((function(t){var e=Tt(t,2),r=e[0],n=e[1],o=new(0,Lt[r])(n);f.push(o)})),f);(t=this.processor.staticEntities).push.apply(t,Ct(h)),(e=this.processor).add.apply(e,Ct(h))}}])&&Dt(t.prototype,e),r&&Dt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Gt(t){return Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gt(t)}function Ut(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function zt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ut(Object(r),!0).forEach((function(e){Kt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ut(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Wt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Yt(n.key),n)}}function Vt(t,e,r){return e=qt(e),function(t,e){if(e&&("object"==Gt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ht()?Reflect.construct(e,r||[],qt(t).constructor):e.apply(t,r))}function Ht(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ht=function(){return!!t})()}function qt(t){return qt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qt(t)}function Xt(t,e){return Xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xt(t,e)}function Kt(t,e,r){return(e=Yt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yt(t){var e=function(t,e){if("object"!=Gt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Gt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Gt(e)?e:e+""}var Jt="\n#define TOON\n\nvarying vec3 vViewPosition;\nvarying vec3 vWorldPosition;\n\nuniform float time;\nuniform float windStrength;\nuniform float windFrequency;\n\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\n".concat(u.p_,"\n\nvoid main() {\n  #include <uv_vertex>\n  #include <color_vertex>\n  #include <batching_vertex>\n\n  #include <beginnormal_vertex>\n  #include <skinbase_vertex>\n  #include <skinnormal_vertex>\n  #include <defaultnormal_vertex>\n  #include <normal_vertex>\n\n  #include <begin_vertex>\n\n  // Apply batchingMatrix\n  vec4 batchedPos = batchingMatrix * vec4(position, 1.0);\n\n  // Wind effect\n  float noise = fbm(batchedPos.xyz * 0.5 + vec3(0.0, time * windFrequency, 0.0));\n  float sway = sin(time * windFrequency + batchedPos.x * 0.5 + batchedPos.z * 0.5) * windStrength * noise;\n\n  // Calculate view direction\n  vec3 viewDir = normalize(batchedPos.xyz - cameraPosition);\n\n  // Compute an arbitrary up vector; careful if viewDir aligns with (0,1,0)\n  vec3 up = vec3(0.0, 1.0, 0.0);\n  if (abs(dot(viewDir, up)) > 0.995) {\n      up = vec3(1.0, 0.0, 0.0);  // Use a different up vector if view direction is vertical\n  }\n\n  // Create the right and adjusted up vector for the billboard\n  vec3 right = normalize(cross(up, viewDir));\n  vec3 adjustedUp = cross(viewDir, right);\n\n  // Adjust vertex positions based on uv coordinates\n  vec3 localPos = batchedPos.xyz + (uv.x - 0.5) * 3.0 * right + (uv.y - 0.5) * 3.0 * adjustedUp + sway * right;\n  vec4 mvPosition = modelViewMatrix * vec4(localPos, 1.0);\n\n  // Transform the local position to clip space\n  gl_Position = projectionMatrix * mvPosition;\n\n  vViewPosition = - mvPosition.xyz;\n  vWorldPosition = (modelMatrix * vec4(localPos, 1.0)).xyz;\n\n  #include <worldpos_vertex>\n  #include <shadowmap_vertex>\n  #include <fog_vertex>\n}\n"),Zt="\n#define TOON\n\nuniform vec3 diffuse;\nuniform float opacity;\n\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <lightmap_pars_fragment>\n\n".concat(u.bw,"\n\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n\n").concat(u.TU,"\n\nvoid main() { \n  vec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\n\t#include <logdepthbuf_fragment>\n  #include <color_fragment>\n\n  vec4 sampledDiffuseColor = texture2D( map, vUv );\n  diffuseColor *= sampledDiffuseColor;\n\n  // this works because the texture is black and white\n  if ( sampledDiffuseColor.r < 0.5 ) discard;\n\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\n  // accumulation\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n  vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}\n"),Qt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Kt(t=Vt(this,e),"name","FoliageMaterial"),Kt(t,"vertexShader",Jt),Kt(t,"fragmentShader",Zt),Kt(t,"side",o.ehD),Kt(t,"map",null),t.vertexColors=!0,a.Jb.textures.leaves.then((function(e){t.map=e})),t.defines=zt(zt({},t.defines),{},{USE_UV:""}),t.uniforms=zt(zt({},t.uniforms),{},{time:{value:0},windStrength:{value:.5},windFrequency:{value:.5}}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xt(t,e)}(e,t),r=e,(n=[{key:"update",value:function(t){this.uniforms.time.value+=t}}])&&Wt(r.prototype,n),i&&Wt(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(u.qn);function $t(t){return $t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$t(t)}function te(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=re(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function ee(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||re(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(t,e){if(t){if("string"==typeof t)return ne(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ne(t,e):void 0}}function ne(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function oe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ie(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ye(n.key),n)}}function ae(t,e,r){return e&&ie(t.prototype,e),r&&ie(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ue(t,e,r){return e=le(e),function(t,e){if(e&&("object"==$t(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ce()?Reflect.construct(e,r||[],le(t).constructor):e.apply(t,r))}function ce(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ce=function(){return!!t})()}function se(){return se="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=le(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},se.apply(null,arguments)}function le(t){return le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},le(t)}function fe(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&he(t,e)}function he(t,e){return he=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},he(t,e)}function pe(t,e,r){return(e=ye(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ye(t){var e=function(t,e){if("object"!=$t(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=$t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==$t(e)?e:e+""}var de=["uv","color","position","normal"],ve=function(t){function e(t){var r;return oe(this,e),(r=ue(this,e)).map=t,pe(r,"staticEntityUtil",void 0),pe(r,"staticEntities",[]),pe(r,"instanceMap",{}),pe(r,"materialDataMap",{}),r.staticEntityUtil=new Ft(r),r}return fe(e,t),ae(e,[{key:"optimizeMap",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.firstPass(t,e),this.createBatchedMeshes(),this.populateBatchedMeshes(),this.staticEntityUtil.createStaticEntities(),a.yu.completeWork(5)}},{key:"firstPass",value:function(t,e){var r=this;t.scene.updateMatrixWorld(),t.scene.traverse((function(o){if(!r.staticEntityUtil.identifyStaticEntity(o)&&o instanceof n.K){var i=o.clone();i.material=r.adjustMaterial(i);var a="Static".concat(i.material.name,"-").concat(i.material.side);i.material.name=a,Object.keys(i.geometry.attributes).forEach((function(t){de.includes(t)||i.geometry.deleteAttribute(t)})),r.materialDataMap[a]||(r.materialDataMap[a]={material:i.material,instanceCount:0,vertexCount:0,indexCount:0});var u=r.materialDataMap[a];u.instanceCount+=1;var c=t.parser.associations.get(o);if(void 0!==(null==c?void 0:c.meshes)&&void 0!==(null==c?void 0:c.primitives)){var s,l="".concat(e,"-").concat(c.meshes,"-").concat(c.primitives,"-").concat(a);if(!r.instanceMap[l])r.instanceMap[l]=[],u.vertexCount+=o.geometry.attributes.position.count,u.indexCount+=(null===(s=o.geometry.index)||void 0===s?void 0:s.count)||0;r.instanceMap[l].push(i)}}}))}},{key:"createBatchedMeshes",value:function(){for(var t=0,e=Object.keys(this.materialDataMap);t<e.length;t++){var r=e[t],n=this.materialDataMap[r],o=n.material,i=n.indexCount,a=n.instanceCount,u=n.vertexCount;this.map.batchedMeshHandler.createStaticBatchedMesh(o,a,u,i)}}},{key:"populateBatchedMeshes",value:function(){for(var t=0,e=Object.entries(this.instanceMap);t<e.length;t++){var r,n=ee(e[t],2),o=n[0],i=te(n[1]);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.map.batchedMeshHandler.addMesh(o,a)}}catch(t){i.e(t)}finally{i.f()}}}},{key:"adjustMaterial",value:function(t){var e=t.material.clone();return"vertexColors"===t.material.name?e=new u.db(a.Ts):"unlitVertexColors"===t.material.name?e=new u.As:"foliage"===t.material.name?e=new Qt:"glass"===t.material.name?((0,u.U1)(t),e=new u.db(a.Ts)):"boostpad"===t.material.name?e=new K:"gem"===t.material.name?e=new u.xm:"metallic"===t.material.name&&(e=new u.UG),me(t)?e.side=o.ehD:e.side=o.Wl3,e.metalness=0,e.roughness=1,e.map&&(e.map.anisotropy=16),e}},{key:"add",value:function(){for(var t,r,o,i,a,u=this,c=arguments.length,s=new Array(c),l=0;l<c;l++)s[l]=arguments[l];return s.forEach((function(t){t instanceof n.K&&u.map.registerStaticMesh(t)})),(t=e,r="add",o=this,a=se(le(1&(i=3)?t.prototype:t),r,o),2&i?function(t){return a.apply(o,t)}:a)(s)}},{key:"clearLoadingBarriers",value:function(){var t=this;this.staticEntities.forEach((function(e){"loadingbarrier"===e.staticEntityId&&(t.remove(e),t.staticEntities=t.staticEntities.filter((function(t){return t!==e})))}))}}])}(i.Z),me=function(t){var e,r;return t.userData.doubleSide||(null===(e=t.parent)||void 0===e?void 0:e.userData.doubleSide)||(null===(r=t.parent)||void 0===r||null===(r=r.parent)||void 0===r?void 0:r.userData.doubleSide)},be=function(t){function e(){return oe(this,e),ue(this,e,arguments)}return fe(e,t),ae(e,[{key:"adjustMaterial",value:function(){return new u.db(a.Ts)}}])}(ve)},86795:(t,e,r)=>{r.d(e,{K:()=>u});var n=r(17414),o=r(67875),i=r(5071),a=r(69024);var u=function(t){return function(t,e){var r=new n.u,u=0,c=0;t.forEach((function(t){if(!t.index)throw new Error("Geometry must have an index");u+=t.attributes.position.count,c+=t.index.count}));var s=new Float32Array(3*u),l=new Float32Array(3*u),f=new Uint32Array(c),h=new Float32Array(2*u),p=new Float32Array(4*u),y=0,d=0,v=0,m=0;return t.forEach((function(t,r){if(!t.index)throw new Error("Geometry must have an index");for(var n=e[r],a=t.attributes.position,u=t.attributes.normal,c=t.index,b=t.attributes.uv,g=t.attributes.color,w=(new o.V).getNormalMatrix(n),S=0;S<a.count;S++){var x=(new i.P).fromBufferAttribute(a,S);x.applyMatrix4(n),s[3*y]=x.x,s[3*y+1]=x.y,s[3*y+2]=x.z;var O=(new i.P).fromBufferAttribute(u,S);O.applyMatrix3(w).normalize(),l[3*y]=O.x,l[3*y+1]=O.y,l[3*y+2]=O.z,h[2*v]=b.array[2*S],h[2*v+1]=b.array[2*S+1],g&&(p[4*m]=g.array[4*S],p[4*m+1]=g.array[4*S+1],p[4*m+2]=g.array[4*S+2],p[4*m+3]=g.array[4*S+3]),y++,v++,m++}for(var P=(new o.V).setFromMatrix4(n).determinant()<0,E=y-a.count,j=0;j<c.count;j+=3)P?(f[d]=c.array[j+2]+E,f[d+1]=c.array[j+1]+E,f[d+2]=c.array[j]+E):(f[d]=c.array[j]+E,f[d+1]=c.array[j+1]+E,f[d+2]=c.array[j+2]+E),d+=3})),r.setAttribute("position",new a.Tl(s,3)),r.setAttribute("normal",new a.Tl(l,3)),r.setAttribute("uv",new a.Tl(h,2)),p.length>0&&r.setAttribute("color",new a.Tl(p,4,!0)),r.setIndex(new a.Tl(f,1)),r}(t.map((function(t){return t.geometry})),t.map((function(t){return t.matrixWorld})))}},73649:(t,e,r)=>{r.d(e,{t:()=>o});var n=r(48418),o=function(t){var e;n.Xd.video.advancedMaterialFxEnabled=t,null===(e=n.Xx.map)||void 0===e||e.materialHandler.updateAdvancedMaterialFx(t)}},11778:(t,e,r)=>{r.d(e,{M:()=>o});var n=r(48418),o=function(t){n.Xd.video.antialiasingEnabled=t,n.Ts.postProcessing.toggleEffect("smaa",t)}},61221:(t,e,r)=>{r.d(e,{o:()=>o});var n=r(48418),o=function(t){var e;n.Xd.video.shadowQuality=t;var r=null===(e=n.Xx.map)||void 0===e?void 0:e.shadowHandler;r&&(r.updateShadowSettings(t),r.renderStaticShadows())}},96026:(t,e,r)=>{r.d(e,{C:()=>a});var n=r(17902),o=r(82140),i=r(48418),a=function(t){i.Xd.video.speedLinesEnabled=t,o.h.dispatch((0,n.Qu)(t))}},56051:(t,e,r)=>{r.d(e,{o:()=>h});var n=r(48418),o=r(73649),i=r(11778),a=r(61221),u=r(96026),c=r(84290),s={preset:c.L.LOW,renderScale:.8,antialiasingEnabled:!1,shadowQuality:c.U.NONE,advancedMaterialFxEnabled:!1,speedLinesEnabled:!1},l={preset:c.L.MEDIUM,renderScale:.9,antialiasingEnabled:!1,shadowQuality:c.U.NONE,advancedMaterialFxEnabled:!1,speedLinesEnabled:!1},f={preset:c.L.HIGH,renderScale:1,antialiasingEnabled:!0,shadowQuality:c.U.HIGH,advancedMaterialFxEnabled:!0,speedLinesEnabled:!0},h=function(t){var e;switch(t){case c.L.LOW:e=s;break;case c.L.MEDIUM:e=l;break;case c.L.HIGH:e=f}e&&(n.Xd.video.preset=t,(0,a.o)(e.shadowQuality),(0,i.M)(e.antialiasingEnabled),(0,o.t)(e.advancedMaterialFxEnabled),(0,u.C)(e.speedLinesEnabled),n.Ts.updateRenderScale(e.renderScale))}},79355:(t,e,r)=>{r.d(e,{I:()=>o,z:()=>i});var n=r(74009),o={keyBinds:[["KeyW","ArrowUp"],["KeyS","ArrowDown"],["KeyA","ArrowLeft"],["KeyD","ArrowRight"],["Space",""],["",""],["",""],["",""],["",""],["KeyR",""],["Enter","KeyT"],["ShiftLeft",""]],controllerBinds:{button:{0:n.oI.BRAKE,1:n.oI.GAS,2:n.oI.RESET,4:n.oI.USE_ITEM,5:n.oI.DRIFT,6:n.oI.USE_ITEM,7:n.oI.DRIFT,12:n.oI.CAM_FORWARDS,13:n.oI.CAM_BACKWARDS,14:n.oI.CAM_LEFT,15:n.oI.CAM_RIGHT},axis:{0:n.oI.STEERING,1:n.oI.CAM}}},i={keyBinds:[["KeyW",""],["KeyS",""],["KeyA",""],["KeyD",""],["Space",""],["ArrowUp",""],["ArrowDown",""],["ArrowLeft",""],["ArrowRight",""],["KeyR",""],["Enter","KeyT"],["ShiftLeft",""]],controllerBinds:{button:{0:n.oI.DRIFT,2:n.oI.USE_ITEM,3:n.oI.RESET,4:n.oI.BRAKE,5:n.oI.GAS,6:n.oI.BRAKE,7:n.oI.GAS,12:n.oI.CAM_FORWARDS,13:n.oI.CAM_BACKWARDS,14:n.oI.CAM_LEFT,15:n.oI.CAM_RIGHT},axis:{0:n.oI.STEERING,1:n.oI.CAM}}}},84290:(t,e,r)=>{r.d(e,{L:()=>o,U:()=>n});var n=function(t){return t.NONE="none",t.LOW="low",t.MEDIUM="medium",t.HIGH="high",t}({}),o=function(t){return t.LOW="low",t.MEDIUM="medium",t.HIGH="high",t.CUSTOM="custom",t}({})},44165:(t,e,r)=>{r.d(e,{w:()=>h,y:()=>p});var n=r(48418),o=r(85958);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,u(n.key),n)}}function u(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}var c=function(){return t=function t(){var e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,n=void 0,(r=u(r="hostNameCache"))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,this.hostNameCache={}},(e=[{key:"parse",value:function(t){if(this.hostNameCache[t])return this.hostNameCache[t];var e;if(t.includes("://")){var r=new URL(t),n=this.replaceHost(r.hostname);r.hostname=n.newHost,r.pathname=n.path+r.pathname,e=r.href}else{var o=this.replaceHost(t);e=o.newHost+o.path}return this.hostNameCache[t]=e,e}},{key:"replaceHost",value:function(t){var e=t.split(".").reverse().join("/");return{newHost:"".concat(o.N,".discordsays.com/"),path:e}}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f(n.key),n)}}function f(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:e+""}var h=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},(e=[{key:"parse",value:function(t){return t}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function p(){return"discord"===n.Jv.id?new c:new h}},73002:(t,e,r)=>{r.d(e,{h:()=>T,O:()=>k});var n=r(78457),o=r(85285),i=r(48418);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return c(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,l(n.key),n)}}function l(t){var e=function(t,e){if("object"!=a(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==a(e)?e:e+""}var f=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},(e=[{key:"getRegionPings",value:function(){var t=i.tO.get(this.getStorageName());return t?JSON.parse(t):[]}},{key:"setRegionPings",value:function(t){var e,r=this.getRegionPings(),n=u(t);try{var o=function(){var t=e.value,n=r.find((function(e){return e.region===t.region}));n?n.ping=t.ping:r.push(t)};for(n.s();!(e=n.n()).done;)o()}catch(t){n.e(t)}finally{n.f()}i.tO.set(this.getStorageName(),JSON.stringify(t))}},{key:"getStorageName",value:function(){return"region-pings-".concat("2.5.15")}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return y(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function d(){d=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new C(n||[]);return o(a,"_invoke",{value:T(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function S(){}var x={};s(x,a,(function(){return this}));var O=Object.getPrototypeOf,P=O&&O(O(A([])));P&&P!==r&&n.call(P,a)&&(x=P);var E=S.prototype=g.prototype=Object.create(x);function j(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==h(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function T(e,r,n){var o=p;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=_(u,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?m:y,s.arg===b)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=m,n.method="throw",n.arg=s.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(h(e)+" is not iterable")}return w.prototype=S,o(E,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=s(S,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,S):(t.__proto__=S,s(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(k.prototype),s(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),s(E,c,"Generator"),s(E,a,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function v(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function m(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){v(i,n,o,a,u,"next",t)}function u(t){v(i,n,o,a,u,"throw",t)}a(void 0)}))}}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,x(n.key),n)}}function w(t,e,r){return e&&g(t.prototype,e),r&&g(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function S(t,e,r){return(e=x(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x(t){var e=function(t,e){if("object"!=h(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==h(e)?e:e+""}var O=o.eL?{dev:"region.drift.ngrok.app",stg:"region-staging.drift.io"}:{stg:"region-staging.drift.io"},P={dev:O,staging:O,prod:{use:"region-us-east.drift.io",ned:"region-netherlands.drift.io",sgp:"region-singapore.drift.io"}},E="https:",j=o.Vi,k=function(){return w((function t(){b(this,t),S(this,"regions",P[j]),S(this,"pingAttempts",void 0),S(this,"region",void 0),S(this,"ignoreRoomCode",void 0),S(this,"pingStorage",void 0),S(this,"roomCode",void 0),this.pingStorage=new f,this.ignoreRoomCode=!1,this.pingAttempts=3}),[{key:"getConnectionInfo",value:(u=m(d().mark((function t(e){var r,n;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getUrlRoomCode();case 2:if(!(r=t.sent)){t.next=9;break}e=null!==(n=e)&&void 0!==n?n:r.substring(0,3),this.roomCode=r.substring(3,9),""===this.roomCode&&(this.roomCode=void 0),t.next=13;break;case 9:if(e){t.next=13;break}return t.next=12,this.getClosestRegion();case 12:e=t.sent;case 13:if(e&&this.regions[e]){t.next=18;break}return t.next=16,this.getClosestRegion();case 16:e=t.sent,this.roomCode=void 0;case 18:return t.next=20,this.getSessionRegion(e);case 20:return this.region=t.sent,t.abrupt("return",{host:T.getRegionHost(this.region),roomCode:this.roomCode,region:this.region});case 22:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"roomCodeChanged",value:function(){return void 0===this.roomCode}},{key:"clearRoomCode",value:function(){this.roomCode=void 0;var t=new URL(window.location.href);t.searchParams.delete("room"),window.history.replaceState({},"room_code",t.toString()),i.Jv.is("poki")&&(this.ignoreRoomCode=!0)}},{key:"getRegion",value:function(){return this.region}},{key:"setSessionRegion",value:(a=m(d().mark((function t(e){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!i.vs.is("discord")){t.next=3;break}return t.next=3,i.xs.game.getSessionRegion(i.vs.getConnectionId(),e,!0);case 3:case"end":return t.stop()}}),t)}))),function(t){return a.apply(this,arguments)})},{key:"getUrlRoomCode",value:(r=m(d().mark((function t(){var e,r,n;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.ignoreRoomCode){t.next=2;break}return t.abrupt("return",void 0);case 2:return t.next=4,i.vs.getUrlParam("room");case 4:if(!(r=t.sent)){t.next=7;break}return t.abrupt("return",r);case 7:return n=new URL(window.location.href),t.abrupt("return",null!==(e=n.searchParams.get("room"))&&void 0!==e?e:void 0);case 9:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"getSessionRegion",value:(e=m(d().mark((function t(e){var r;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!i.vs.is("discord")){t.next=7;break}return t.next=3,i.xs.game.getSessionRegion(i.vs.getConnectionId(),e);case 3:if(!(r=t.sent)){t.next=7;break}if(!this.regions[r]){t.next=7;break}return t.abrupt("return",r);case 7:return t.abrupt("return",e);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"getClosestRegion",value:(t=m(d().mark((function t(){var e,r,a,u,c,s,l=this;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=Object.entries(this.regions).map(function(){var t=m(d().mark((function t(e){var r,a,u,c,s,f,h,y;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=p(e,2),a=r[0],u=r[1],!o.eL||"stg"!==a){t.next=3;break}return t.abrupt("return",null);case 3:c=0,s=0,f=0;case 6:if(!(f<l.pingAttempts)){t.next=22;break}return t.prev=7,h=performance.now(),t.next=11,n.Z.get("".concat(E,"//").concat(i.f6.parse(u),"/"),{timeout:3e3});case 11:y=performance.now(),c+=y-h,s++,t.next=19;break;case 16:t.prev=16,t.t0=t.catch(7),console.error("Ping Failed for ".concat(a),t.t0);case 19:f++,t.next=6;break;case 22:if(0!==s){t.next=24;break}return t.abrupt("return",null);case 24:return t.abrupt("return",{region:a,ping:c/s});case 25:case"end":return t.stop()}}),t,null,[[7,16]])})));return function(e){return t.apply(this,arguments)}}()),!((r=this.pingStorage.getRegionPings()).length>0)){t.next=8;break}return Promise.all(e).then((function(t){var e=t.filter((function(t){return null!==t}));l.pingStorage.setRegionPings(e)})),a=r.reduce((function(t,e){return!t||e.ping<t.ping?e:t})),t.abrupt("return",a.region);case 8:return t.next=10,Promise.all(e);case 10:if(u=t.sent,0!==(c=u.filter((function(t){return null!==t}))).length){t.next=14;break}throw new Error("No regions available");case 14:return s=c.reduce((function(t,e){return!t||e.ping<t.ping?e:t})),this.pingStorage.setRegionPings(c),t.abrupt("return",s.region);case 17:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})}]);var t,e,r,a,u}(),T=function(){return w((function t(){b(this,t)}),null,[{key:"getRegionPath",value:function(t){var e=null!=t?t:Object.keys(this.regions)[0];return"".concat(E,"//").concat(this.getRegionHost(e))}},{key:"getRegionHost",value:function(t){var e=null!=t?t:Object.keys(this.regions)[0],r=this.regions[e];if(!r)throw new Error("Region ".concat(e," not found"));return i.f6.parse(r)}}])}();S(T,"regions",P[j])},50100:(t,e,r)=>{r.d(e,{g:()=>i});var n=r(5071),o=r(94407);function i(t,e){return e||(e={origin:new n.P,rotation:new o._}),e.origin.set(t.getOrigin().x(),t.getOrigin().y(),t.getOrigin().z()),e.rotation.set(t.getRotation().x(),t.getRotation().y(),t.getRotation().z(),t.getRotation().w()),e}},56633:(t,e,r)=>{r.d(e,{S:()=>wt});var n=r(62517),o=r(63463),i=r(73467),a=r(19040),u=r(34587),c=r(48418);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,d(n.key),n)}}function f(t,e,r){return e=p(e),function(t,e){if(e&&("object"==s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,h()?Reflect.construct(e,r||[],p(t).constructor):e.apply(t,r))}function h(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(h=function(){return!!t})()}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function y(t,e){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},y(t,e)}function d(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:e+""}var v=function(t){function e(t){var r,n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=f(this,e,[t.camera]),n=r,i=[],(o=d(o="_effects"))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,r._effects.push({id:"smaa",value:new u.fY({preset:u.F9.ULTRA}),enabled:c.Xd.video.antialiasingEnabled}),r._effects.push({id:"tone-mapping",value:new u.M4({mode:u.hm.REINHARD}),enabled:!0}),r._effects.push({id:"color-adjustments",value:new u.at({brightness:.18,contrast:.03}),enabled:!0}),r.updateEffects(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e)}(e,t),r=e,(n=[{key:"toggleEffect",value:function(t,e){var r=this._effects.find((function(e){return e.id===t}));r&&(r.enabled=null!=e?e:!r.enabled,this.updateEffects())}},{key:"updateEffects",value:function(){var t=this._effects.filter((function(t){return t.enabled})).map((function(t){return t.value}));this.setEffects(t),this.dispose(),this.recompile()}}])&&l(r.prototype,n),o&&l(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(u.H5),m=r(74996),b=r(69073),g=r(97526),w=r(5071),S=r(97933),x=r(80002),O=r(72781),P=r(60233),E=r(91077),j=r(23969),k=r(89046),T=r(51465),_=r(23103),L=r(78752),I=r(89299),C=r(51119),A=r(12536),M=r(97986),R=r(30508),N=r(22023),D=r(74784),B=r(64101),F=r(33062),G=r(78206),U=r(53196),z=r(54494),W=r(6871),V=r(17414),H=r(69024),q=r(47472),X=r(61182),K=r(56588),Y=r(22308);function J(t,e,r){let n=new b.i;const i=new z.F,a=new z.F,u=new S.L,c=[],s=[],l={},f=r.maxTextureSize,h={0:o._Li,1:o.Wl3,2:o.ehD},p=new W.j({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new z.F},radius:{value:4}},vertexShader:Y.u,fragmentShader:Y.D}),y=p.clone();y.defines.HORIZONTAL_PASS=1;const d=new V.u;d.setAttribute("position",new H.Tl(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const v=new q.K(d,p),m=this;function g(r,n){const o=e.update(v);p.uniforms.shadow_pass.value=r.map.texture,p.uniforms.resolution.value=r.mapSize,p.uniforms.radius.value=r.radius,t.setRenderTarget(r.mapPass),t.clear(),t.renderBufferDirect(n,null,o,p,v,null),y.uniforms.shadow_pass.value=r.mapPass.texture,y.uniforms.resolution.value=r.mapSize,y.uniforms.radius.value=r.radius,t.setRenderTarget(r.map),t.clear(),t.renderBufferDirect(n,null,o,y,v,null)}function w(t,e,r){const n=t|e<<1|r<<2;let i=c[n];return void 0===i&&(i=new X.l({depthPacking:o.mSO}),c[n]=i),i}function x(t,e,r){const n=t|e<<1|r<<2;let o=s[n];return void 0===o&&(o=new K.L({morphTargets:t,skinning:e}),s[n]=o),o}function O(e,r,n,i,a,u,c){let s=null,f=w,p=e.customDepthMaterial;if(!0===i.isPointLight&&(f=x,p=e.customDistanceMaterial),void 0===p){let t=!1;!0===n.morphTargets&&(t=r.morphAttributes&&r.morphAttributes.position&&r.morphAttributes.position.length>0);s=f(t,!0,!0===e.isInstancedMesh)}else s=p;if(t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){const t=s.uuid,e=n.uuid;let r=l[t];void 0===r&&(r={},l[t]=r);let o=r[e];void 0===o&&(o=s.clone(),r[e]=o),s=o}return s.visible=n.visible,s.wireframe=n.wireframe,c===o.dwk?s.side=null!==n.shadowSide?n.shadowSide:n.side:s.side=null!==n.shadowSide?n.shadowSide:h[n.side],s.clipShadows=n.clipShadows,s.clippingPlanes=n.clippingPlanes,s.clipIntersection=n.clipIntersection,s.wireframeLinewidth=n.wireframeLinewidth,s.linewidth=n.linewidth,!0===i.isPointLight&&!0===s.isMeshDistanceMaterial&&(s.referencePosition.setFromMatrixPosition(i.matrixWorld),s.nearDistance=a,s.farDistance=u),s}function P(r,i,a,u,c){if(!1===r.visible)return;if(r.layers.test(i.layers)&&(r.isMesh||r.isLine||r.isPoints)&&(r.castShadow||r.receiveShadow&&c===o.dwk)&&(!r.frustumCulled||n.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,r.matrixWorld);const n=e.update(r),o=r.material;if(Array.isArray(o)){const e=n.groups;for(let i=0,s=e.length;i<s;i++){const s=e[i],l=o[s.materialIndex];if(l&&l.visible){const e=O(r,n,l,u,a.near,a.far,c);t.renderBufferDirect(a,null,n,e,r,s)}}}else if(o.visible){const e=O(r,n,o,u,a.near,a.far,c);t.renderBufferDirect(a,null,n,e,r,null)}}const s=r.children;for(let t=0,e=s.length;t<e;t++)P(s[t],i,a,u,c)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=o._iA,this.render=function(e,r,c){if(!1===m.enabled)return;if(!1===m.autoUpdate&&!1===m.needsUpdate)return;if(0===e.length)return;const s=t.getRenderTarget(),l=t.getActiveCubeFace(),h=t.getActiveMipmapLevel(),p=t.state;p.setBlending(o.jFi),p.buffers.color.setClear(1,1,1,1),p.buffers.depth.setTest(!0),p.setScissorTest(!1);for(let s=0,l=e.length;s<l;s++){const l=e[s],h=l.shadow;if(void 0===h){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===h.autoUpdate&&!1===h.needsUpdate)continue;i.copy(h.mapSize);const y=h.getFrameExtents();if(i.multiply(y),a.copy(h.mapSize),(i.x>f||i.y>f)&&(i.x>f&&(a.x=Math.floor(f/y.x),i.x=a.x*y.x,h.mapSize.x=a.x),i.y>f&&(a.y=Math.floor(f/y.y),i.y=a.y*y.y,h.mapSize.y=a.y)),null===h.map&&!h.isPointLightShadow&&this.type===o.dwk){const t={minFilter:o.wem,magFilter:o.wem,format:o.wk1};h.map=new U.d(i.x,i.y,t),h.map.texture.name=l.name+".shadowMap",h.mapPass=new U.d(i.x,i.y,t),h.camera.updateProjectionMatrix()}if(null===h.map){const t={minFilter:o.TyD,magFilter:o.TyD,format:o.wk1};h.map=new U.d(i.x,i.y,t),h.map.texture.name=l.name+".shadowMap",h.camera.updateProjectionMatrix()}t.setRenderTarget(h.map),t.clear();const d=h.getViewportCount();for(let t=0;t<d;t++){const e=h.getViewport(t);u.set(a.x*e.x,a.y*e.y,a.x*e.z,a.y*e.w),p.viewport(u),h.updateMatrices(l,t),n=h.getFrustum();for(let t=0;t<r.length;t++)P(r[t],c,h.camera,l,this.type)}h.isPointLightShadow||this.type!==o.dwk||g(h,c),h.needsUpdate=!1}m.needsUpdate=!1,t.setRenderTarget(s,l,h)}}var Z=r(11198),Q=r(2075),$=r(80472),tt=r(52960),et=r(29361),rt=r(71238),nt=r(27619),ot=r(63116);class it{constructor(t={}){const{canvas:e=(0,ot.O5)(),context:r=null,depth:i=!0,stencil:a=!1,alpha:u=!1,antialias:c=!1,premultipliedAlpha:s=!0,preserveDrawingBuffer:l=!1,powerPreference:f="default",failIfMajorPerformanceCaveat:h=!1}=t;let p;if(this.isWebGLRenderer=!0,null!==r){if("undefined"!=typeof WebGLRenderingContext&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");p=r.getContextAttributes().alpha}else p=u;const y=new Uint32Array(4),d=new Int32Array(4);let v=null,z=null;const W=[],V=[];this.domElement=e,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=o.KI_,this.toneMapping=o.uL9,this.toneMappingExposure=1;const H=this;let q=!1,X=0,K=0,Y=null,it=-1,at=null;const ut=new S.L,ct=new S.L;let st=null;const lt=new m.I(0);let ft=0,ht=e.width,pt=e.height,yt=1,dt=null,vt=null;const mt=new S.L(0,0,ht,pt),bt=new S.L(0,0,ht,pt);let gt=!1;const wt=new b.i;let St=!1,xt=!1;const Ot=new g.y,Pt=new w.P,Et=new S.L,jt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let kt=!1;function Tt(){return null===Y?yt:1}let _t,Lt,It,Ct,At,Mt,Rt,Nt,Dt,Bt,Ft,Gt,Ut,zt,Wt,Vt,Ht,qt,Xt,Kt,Yt,Jt,Zt,Qt,$t=r;function te(t,r){return e.getContext(t,r)}try{const t={alpha:!0,depth:i,stencil:a,antialias:c,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:f,failIfMajorPerformanceCaveat:h};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${o.UZH}`),e.addEventListener("webglcontextlost",ne,!1),e.addEventListener("webglcontextrestored",oe,!1),e.addEventListener("webglcontextcreationerror",ie,!1),null===$t){const e="webgl2";if($t=te(e,t),null===$t)throw te(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}function ee(){_t=new I.P($t),_t.init(),Jt=new tt.f($t,_t),Lt=new k.G($t,_t,t,Jt),It=new Z.m($t),Ct=new M.I($t),At=new B.Z,Mt=new Q.w($t,_t,It,At,Lt,Jt,Ct),Rt=new _.S(H),Nt=new L.W(H),Dt=new O.b($t),Zt=new E.s($t,Dt),Bt=new C.Y($t,Dt,Ct,Zt),Ft=new N.E($t,Bt,Dt,Ct),Xt=new R.i($t,Lt,Mt),Vt=new T.h(At),Gt=new D.Z(H,Rt,Nt,_t,Lt,Zt,Vt),Ut=new rt.J(H,At),zt=new F.M,Wt=new G.Q(_t),qt=new P.a(H,Rt,Nt,It,Ft,p,s),Ht=new J(H,Ft,Lt),Qt=new nt.C($t,Ct,Lt,It),Kt=new j.w($t,_t,Ct),Yt=new A.x($t,_t,Ct),Ct.programs=Gt.programs,H.capabilities=Lt,H.extensions=_t,H.properties=At,H.renderLists=zt,H.shadowMap=Ht,H.state=It,H.info=Ct}ee();const re=new et.M(H,$t);function ne(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),q=!0}function oe(){console.log("THREE.WebGLRenderer: Context Restored."),q=!1;const t=Ct.autoReset,e=Ht.enabled,r=Ht.autoUpdate,n=Ht.needsUpdate,o=Ht.type;ee(),Ct.autoReset=t,Ht.enabled=e,Ht.autoUpdate=r,Ht.needsUpdate=n,Ht.type=o}function ie(t){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",t.statusMessage)}function ae(t){const e=t.target;e.removeEventListener("dispose",ae),function(t){(function(t){const e=At.get(t).programs;void 0!==e&&(e.forEach((function(t){Gt.releaseProgram(t)})),t.isShaderMaterial&&Gt.releaseShaderCache(t))})(t),At.remove(t)}(e)}function ue(t,e,r){!0===t.transparent&&t.side===o.ehD&&!1===t.forceSinglePass?(t.side=o._Li,t.needsUpdate=!0,me(t,e,r),t.side=o.Wl3,t.needsUpdate=!0,me(t,e,r),t.side=o.ehD):me(t,e,r)}this.xr=re,this.getContext=function(){return $t},this.getContextAttributes=function(){return $t.getContextAttributes()},this.forceContextLoss=function(){const t=_t.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=_t.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return yt},this.setPixelRatio=function(t){void 0!==t&&(yt=t,this.setSize(ht,pt,!1))},this.getSize=function(t){return t.set(ht,pt)},this.setSize=function(t,r,n=!0){re.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(ht=t,pt=r,e.width=Math.floor(t*yt),e.height=Math.floor(r*yt),!0===n&&(e.style.width=t+"px",e.style.height=r+"px"),this.setViewport(0,0,t,r))},this.getDrawingBufferSize=function(t){return t.set(ht*yt,pt*yt).floor()},this.setDrawingBufferSize=function(t,r,n){ht=t,pt=r,yt=n,e.width=Math.floor(t*n),e.height=Math.floor(r*n),this.setViewport(0,0,t,r)},this.getCurrentViewport=function(t){return t.copy(ut)},this.getViewport=function(t){return t.copy(mt)},this.setViewport=function(t,e,r,n){t.isVector4?mt.set(t.x,t.y,t.z,t.w):mt.set(t,e,r,n),It.viewport(ut.copy(mt).multiplyScalar(yt).round())},this.getScissor=function(t){return t.copy(bt)},this.setScissor=function(t,e,r,n){t.isVector4?bt.set(t.x,t.y,t.z,t.w):bt.set(t,e,r,n),It.scissor(ct.copy(bt).multiplyScalar(yt).round())},this.getScissorTest=function(){return gt},this.setScissorTest=function(t){It.setScissorTest(gt=t)},this.setOpaqueSort=function(t){dt=t},this.setTransparentSort=function(t){vt=t},this.getClearColor=function(t){return t.copy(qt.getClearColor())},this.setClearColor=function(){qt.setClearColor.apply(qt,arguments)},this.getClearAlpha=function(){return qt.getClearAlpha()},this.setClearAlpha=function(){qt.setClearAlpha.apply(qt,arguments)},this.clear=function(t=!0,e=!0,r=!0){let n=0;if(t){let t=!1;if(null!==Y){const e=Y.texture.format;t=e===o.E2K||e===o.CtA||e===o.D9w}if(t){const t=Y.texture.type,e=t===o.ywz||t===o.JQ4||t===o.LsT||t===o.wJv||t===o.k0A||t===o.irR,r=qt.getClearColor(),n=qt.getClearAlpha(),i=r.r,a=r.g,u=r.b;e?(y[0]=i,y[1]=a,y[2]=u,y[3]=n,$t.clearBufferuiv($t.COLOR,0,y)):(d[0]=i,d[1]=a,d[2]=u,d[3]=n,$t.clearBufferiv($t.COLOR,0,d))}else n|=$t.COLOR_BUFFER_BIT}e&&(n|=$t.DEPTH_BUFFER_BIT),r&&(n|=$t.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),$t.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",ne,!1),e.removeEventListener("webglcontextrestored",oe,!1),e.removeEventListener("webglcontextcreationerror",ie,!1),zt.dispose(),Wt.dispose(),At.dispose(),Rt.dispose(),Nt.dispose(),Ft.dispose(),Zt.dispose(),Qt.dispose(),Gt.dispose(),re.dispose(),re.removeEventListener("sessionstart",se),re.removeEventListener("sessionend",le),fe.stop()},this.renderBufferDirect=function(t,e,r,n,i,a){null===e&&(e=jt);const u=i.isMesh&&i.matrixWorld.determinant()<0,c=function(t,e,r,n,i){!0!==e.isScene&&(e=jt);Mt.resetTextureUnits();const a=e.fog,u=n.isMeshStandardMaterial?e.environment:null,c=null===Y?H.outputColorSpace:!0===Y.isXRRenderTarget?Y.texture.colorSpace:o.GUF,s=(n.isMeshStandardMaterial?Nt:Rt).get(n.envMap||u),l=!0===n.vertexColors&&!!r.attributes.color&&4===r.attributes.color.itemSize,f=!!r.attributes.tangent&&(!!n.normalMap||n.anisotropy>0),h=!!r.morphAttributes.position,p=!!r.morphAttributes.normal,y=!!r.morphAttributes.color;let d=o.uL9;n.toneMapped&&(null!==Y&&!0!==Y.isXRRenderTarget||(d=H.toneMapping));const v=r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color,m=void 0!==v?v.length:0,b=At.get(n),g=z.state.lights;if(!0===St&&(!0===xt||t!==at)){const e=t===at&&n.id===it;Vt.setState(n,t,e)}let w=!1;n.version===b.__version?b.needsLights&&b.lightsStateVersion!==g.state.version||b.outputColorSpace!==c||i.isBatchedMesh&&!1===b.batching?w=!0:i.isBatchedMesh||!0!==b.batching?i.isBatchedMesh&&!0===b.batchingColor&&null===i.colorTexture||i.isBatchedMesh&&!1===b.batchingColor&&null!==i.colorTexture||i.isInstancedMesh&&!1===b.instancing?w=!0:i.isInstancedMesh||!0!==b.instancing?i.isSkinnedMesh&&!1===b.skinning?w=!0:i.isSkinnedMesh||!0!==b.skinning?i.isInstancedMesh&&!0===b.instancingColor&&null===i.instanceColor||i.isInstancedMesh&&!1===b.instancingColor&&null!==i.instanceColor||i.isInstancedMesh&&!0===b.instancingMorph&&null===i.morphTexture||i.isInstancedMesh&&!1===b.instancingMorph&&null!==i.morphTexture||b.envMap!==s||!0===n.fog&&b.fog!==a?w=!0:void 0===b.numClippingPlanes||b.numClippingPlanes===Vt.numPlanes&&b.numIntersection===Vt.numIntersection?(b.vertexAlphas!==l||b.vertexTangents!==f||b.morphTargets!==h||b.morphNormals!==p||b.morphColors!==y||b.toneMapping!==d||b.morphTargetsCount!==m)&&(w=!0):w=!0:w=!0:w=!0:w=!0:(w=!0,b.__version=n.version);let S=b.currentProgram;!0===w&&(S=me(n,e,i));let x=!1,O=!1,P=!1;const E=S.getUniforms(),j=b.uniforms;It.useProgram(S.program)&&(x=!0,O=!0,P=!0);n.id!==it&&(it=n.id,O=!0);if(x||at!==t){E.setValue($t,"projectionMatrix",t.projectionMatrix),E.setValue($t,"viewMatrix",t.matrixWorldInverse);const e=E.map.cameraPosition;void 0!==e&&e.setValue($t,Pt.setFromMatrixPosition(t.matrixWorld)),Lt.logarithmicDepthBuffer&&E.setValue($t,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&E.setValue($t,"isOrthographic",!0===t.isOrthographicCamera),at!==t&&(at=t,O=!0,P=!0)}if(i.isSkinnedMesh){E.setOptional($t,i,"bindMatrix"),E.setOptional($t,i,"bindMatrixInverse");const t=i.skeleton;t&&(null===t.boneTexture&&t.computeBoneTexture(),E.setValue($t,"boneTexture",t.boneTexture,Mt))}i.isBatchedMesh&&(E.setOptional($t,i,"batchingTexture"),E.setValue($t,"batchingTexture",i._matricesTexture,Mt),E.setOptional($t,i,"batchingIdTexture"),E.setValue($t,"batchingIdTexture",i._indirectTexture,Mt),E.setOptional($t,i,"batchingColorTexture"),null!==i._colorsTexture&&E.setValue($t,"batchingColorTexture",i._colorsTexture,Mt));const k=r.morphAttributes;void 0===k.position&&void 0===k.normal&&void 0===k.color||Xt.update(i,r,S);(O||b.receiveShadow!==i.receiveShadow)&&(b.receiveShadow=i.receiveShadow,E.setValue($t,"receiveShadow",i.receiveShadow));n.isMeshGouraudMaterial&&null!==n.envMap&&(j.envMap.value=s,j.flipEnvMap.value=s.isCubeTexture&&!1===s.isRenderTargetTexture?-1:1);n.isMeshStandardMaterial&&null===n.envMap&&null!==e.environment&&(j.envMapIntensity.value=e.environmentIntensity);O&&(E.setValue($t,"toneMappingExposure",H.toneMappingExposure),b.needsLights&&(_=P,(T=j).ambientLightColor.needsUpdate=_,T.lightProbe.needsUpdate=_,T.directionalLights.needsUpdate=_,T.directionalLightShadows.needsUpdate=_,T.pointLights.needsUpdate=_,T.pointLightShadows.needsUpdate=_,T.spotLights.needsUpdate=_,T.spotLightShadows.needsUpdate=_,T.rectAreaLights.needsUpdate=_,T.hemisphereLights.needsUpdate=_),a&&!0===n.fog&&Ut.refreshFogUniforms(j,a),Ut.refreshMaterialUniforms(j,n,yt,pt,z.state.transmissionRenderTarget[t.id]),$.y.upload($t,be(b),j,Mt));var T,_;n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&($.y.upload($t,be(b),j,Mt),n.uniformsNeedUpdate=!1);n.isSpriteMaterial&&E.setValue($t,"center",i.center);if(E.setValue($t,"modelViewMatrix",i.modelViewMatrix),E.setValue($t,"normalMatrix",i.normalMatrix),E.setValue($t,"modelMatrix",i.matrixWorld),n.isShaderMaterial||n.isRawShaderMaterial){const t=n.uniformsGroups;for(let e=0,r=t.length;e<r;e++){const r=t[e];Qt.update(r,S),Qt.bind(r,S)}}return S}(t,e,r,n,i);It.setMaterial(n,u);let s=r.index,l=1;if(!0===n.wireframe){if(s=Bt.getWireframeAttribute(r),void 0===s)return;l=2}const f=r.drawRange,h=r.attributes.position;let p=f.start*l,y=(f.start+f.count)*l;null!==a&&(p=Math.max(p,a.start*l),y=Math.min(y,(a.start+a.count)*l)),null!==s?(p=Math.max(p,0),y=Math.min(y,s.count)):null!=h&&(p=Math.max(p,0),y=Math.min(y,h.count));const d=y-p;if(d<0||d===1/0)return;let v;Zt.setup(i,n,c,r,s);let m=Kt;if(null!==s&&(v=Dt.get(s),m=Yt,m.setIndex(v)),i.isMesh)!0===n.wireframe?(It.setLineWidth(n.wireframeLinewidth*Tt()),m.setMode($t.LINES)):m.setMode($t.TRIANGLES);else if(i.isLine){let t=n.linewidth;void 0===t&&(t=1),It.setLineWidth(t*Tt()),i.isLineSegments?m.setMode($t.LINES):i.isLineLoop?m.setMode($t.LINE_LOOP):m.setMode($t.LINE_STRIP)}else i.isPoints?m.setMode($t.POINTS):i.isSprite&&m.setMode($t.TRIANGLES);if(i.isBatchedMesh)if(null!==i._multiDrawInstances)m.renderMultiDrawInstances(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount,i._multiDrawInstances);else if(_t.get("WEBGL_multi_draw"))m.renderMultiDraw(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount);else{const t=i._multiDrawStarts,e=i._multiDrawCounts,r=i._multiDrawCount,o=s?Dt.get(s).bytesPerElement:1,a=At.get(n).currentProgram.getUniforms();for(let n=0;n<r;n++)a.setValue($t,"_gl_DrawID",n),m.render(t[n]/o,e[n])}else if(i.isInstancedMesh)m.renderInstances(p,d,i.count);else if(r.isInstancedBufferGeometry){const t=void 0!==r._maxInstanceCount?r._maxInstanceCount:1/0,e=Math.min(r.instanceCount,t);m.renderInstances(p,d,e)}else m.render(p,d)},this.compile=function(t,e,r=null){null===r&&(r=t),z=Wt.get(r),z.init(e),V.push(z),r.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(z.pushLight(t),t.castShadow&&z.pushShadow(t))})),t!==r&&t.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(z.pushLight(t),t.castShadow&&z.pushShadow(t))})),z.setupLights();const n=new Set;return t.traverse((function(t){const e=t.material;if(e)if(Array.isArray(e))for(let o=0;o<e.length;o++){const i=e[o];ue(i,r,t),n.add(i)}else ue(e,r,t),n.add(e)})),V.pop(),z=null,n},this.compileAsync=function(t,e,r=null){const n=this.compile(t,e,r);return new Promise((e=>{function r(){n.forEach((function(t){At.get(t).currentProgram.isReady()&&n.delete(t)})),0!==n.size?setTimeout(r,10):e(t)}null!==_t.get("KHR_parallel_shader_compile")?r():setTimeout(r,10)}))};let ce=null;function se(){fe.stop()}function le(){fe.start()}const fe=new x.C;function he(t,e,r,n){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)r=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)z.pushLight(t),t.castShadow&&z.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||wt.intersectsSprite(t)){n&&Et.setFromMatrixPosition(t.matrixWorld).applyMatrix4(Ot);const e=Ft.update(t),o=t.material;o.visible&&v.push(t,e,o,r,Et.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(!t.frustumCulled||wt.intersectsObject(t))){const e=Ft.update(t),o=t.material;if(n&&(void 0!==t.boundingSphere?(null===t.boundingSphere&&t.computeBoundingSphere(),Et.copy(t.boundingSphere.center)):(null===e.boundingSphere&&e.computeBoundingSphere(),Et.copy(e.boundingSphere.center)),Et.applyMatrix4(t.matrixWorld).applyMatrix4(Ot)),Array.isArray(o)){const n=e.groups;for(let i=0,a=n.length;i<a;i++){const a=n[i],u=o[a.materialIndex];u&&u.visible&&v.push(t,e,u,r,Et.z,a)}}else o.visible&&v.push(t,e,o,r,Et.z,null)}const o=t.children;for(let t=0,i=o.length;t<i;t++)he(o[t],e,r,n)}function pe(t,e,r,n){const o=t.opaque,i=t.transmissive,a=t.transparent;z.setupLightsView(r),!0===St&&Vt.setGlobalState(H.clippingPlanes,r),n&&It.viewport(ut.copy(n)),o.length>0&&de(o,e,r),i.length>0&&de(i,e,r),a.length>0&&de(a,e,r),It.buffers.depth.setTest(!0),It.buffers.depth.setMask(!0),It.buffers.color.setMask(!0),It.setPolygonOffset(!1)}function ye(t,e,r,i){if(null!==(!0===r.isScene?r.overrideMaterial:null))return;void 0===z.state.transmissionRenderTarget[i.id]&&(z.state.transmissionRenderTarget[i.id]=new U.d(1,1,{generateMipmaps:!0,type:_t.has("EXT_color_buffer_half_float")||_t.has("EXT_color_buffer_float")?o.cLu:o.ywz,minFilter:o.D1R,samples:4,stencilBuffer:a,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:n.ep.workingColorSpace}));const u=z.state.transmissionRenderTarget[i.id],c=i.viewport||ut;u.setSize(c.z,c.w);const s=H.getRenderTarget();H.setRenderTarget(u),H.getClearColor(lt),ft=H.getClearAlpha(),ft<1&&H.setClearColor(16777215,.5),kt?qt.render(r):H.clear();const l=H.toneMapping;H.toneMapping=o.uL9;const f=i.viewport;if(void 0!==i.viewport&&(i.viewport=void 0),z.setupLightsView(i),!0===St&&Vt.setGlobalState(H.clippingPlanes,i),de(t,r,i),Mt.updateMultisampleRenderTarget(u),Mt.updateRenderTargetMipmap(u),!1===_t.has("WEBGL_multisampled_render_to_texture")){let t=!1;for(let n=0,a=e.length;n<a;n++){const a=e[n],u=a.object,c=a.geometry,s=a.material,l=a.group;if(s.side===o.ehD&&u.layers.test(i.layers)){const e=s.side;s.side=o._Li,s.needsUpdate=!0,ve(u,r,i,c,s,l),s.side=e,s.needsUpdate=!0,t=!0}}!0===t&&(Mt.updateMultisampleRenderTarget(u),Mt.updateRenderTargetMipmap(u))}H.setRenderTarget(s),H.setClearColor(lt,ft),void 0!==f&&(i.viewport=f),H.toneMapping=l}function de(t,e,r){const n=!0===e.isScene?e.overrideMaterial:null;for(let o=0,i=t.length;o<i;o++){const i=t[o],a=i.object,u=i.geometry,c=null===n?i.material:n,s=i.group;a.layers.test(r.layers)&&ve(a,e,r,u,c,s)}}function ve(t,e,r,n,i,a){t.onBeforeRender(H,e,r,n,i,a),t.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),!0===i.transparent&&i.side===o.ehD&&!1===i.forceSinglePass?(i.side=o._Li,i.needsUpdate=!0,H.renderBufferDirect(r,e,n,i,t,a),i.side=o.Wl3,i.needsUpdate=!0,H.renderBufferDirect(r,e,n,i,t,a),i.side=o.ehD):H.renderBufferDirect(r,e,n,i,t,a),t.onAfterRender(H,e,r,n,i,a)}function me(t,e,r){!0!==e.isScene&&(e=jt);const n=At.get(t),o=z.state.lights,i=z.state.shadowsArray,a=o.state.version,u=Gt.getParameters(t,o.state,i,e,r),c=Gt.getProgramCacheKey(u);let s=n.programs;n.environment=t.isMeshStandardMaterial?e.environment:null,n.fog=e.fog,n.envMap=(t.isMeshStandardMaterial?Nt:Rt).get(t.envMap||n.environment),n.envMapRotation=null!==n.environment&&null===t.envMap?e.environmentRotation:t.envMapRotation,void 0===s&&(t.addEventListener("dispose",ae),s=new Map,n.programs=s);let l=s.get(c);if(void 0!==l){if(n.currentProgram===l&&n.lightsStateVersion===a)return ge(t,u),l}else u.uniforms=Gt.getUniforms(t),t.onBeforeCompile(u,H),l=Gt.acquireProgram(u,c),s.set(c,l),n.uniforms=u.uniforms;const f=n.uniforms;return(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(f.clippingPlanes=Vt.uniform),ge(t,u),n.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),n.lightsStateVersion=a,n.needsLights&&(f.ambientLightColor.value=o.state.ambient,f.lightProbe.value=o.state.probe,f.directionalLights.value=o.state.directional,f.directionalLightShadows.value=o.state.directionalShadow,f.spotLights.value=o.state.spot,f.spotLightShadows.value=o.state.spotShadow,f.rectAreaLights.value=o.state.rectArea,f.ltc_1.value=o.state.rectAreaLTC1,f.ltc_2.value=o.state.rectAreaLTC2,f.pointLights.value=o.state.point,f.pointLightShadows.value=o.state.pointShadow,f.hemisphereLights.value=o.state.hemi,f.directionalShadowMap.value=o.state.directionalShadowMap,f.directionalShadowMatrix.value=o.state.directionalShadowMatrix,f.spotShadowMap.value=o.state.spotShadowMap,f.spotLightMatrix.value=o.state.spotLightMatrix,f.spotLightMap.value=o.state.spotLightMap,f.pointShadowMap.value=o.state.pointShadowMap,f.pointShadowMatrix.value=o.state.pointShadowMatrix),n.currentProgram=l,n.uniformsList=null,l}function be(t){if(null===t.uniformsList){const e=t.currentProgram.getUniforms();t.uniformsList=$.y.seqWithValue(e.seq,t.uniforms)}return t.uniformsList}function ge(t,e){const r=At.get(t);r.outputColorSpace=e.outputColorSpace,r.batching=e.batching,r.batchingColor=e.batchingColor,r.instancing=e.instancing,r.instancingColor=e.instancingColor,r.instancingMorph=e.instancingMorph,r.skinning=e.skinning,r.morphTargets=e.morphTargets,r.morphNormals=e.morphNormals,r.morphColors=e.morphColors,r.morphTargetsCount=e.morphTargetsCount,r.numClippingPlanes=e.numClippingPlanes,r.numIntersection=e.numClipIntersection,r.vertexAlphas=e.vertexAlphas,r.vertexTangents=e.vertexTangents,r.toneMapping=e.toneMapping}fe.setAnimationLoop((function(t){ce&&ce(t)})),"undefined"!=typeof self&&fe.setContext(self),this.setAnimationLoop=function(t){ce=t,re.setAnimationLoop(t),null===t?fe.stop():fe.start()},re.addEventListener("sessionstart",se),re.addEventListener("sessionend",le),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===q)return;if(!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),null===e.parent&&!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),!0===re.enabled&&!0===re.isPresenting&&(!0===re.cameraAutoUpdate&&re.updateCamera(e),e=re.getCamera()),!0===t.isScene&&t.onBeforeRender(H,t,e,Y),z=Wt.get(t,V.length),z.init(e),V.push(z),Ot.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),wt.setFromProjectionMatrix(Ot),xt=this.localClippingEnabled,St=Vt.init(this.clippingPlanes,xt),v=zt.get(t,W.length),v.init(),W.push(v),!0===re.enabled&&!0===re.isPresenting){const t=H.xr.getDepthSensingMesh();null!==t&&he(t,e,-1/0,H.sortObjects)}he(t,e,0,H.sortObjects),v.finish(),!0===H.sortObjects&&v.sort(dt,vt),kt=!1===re.enabled||!1===re.isPresenting||!1===re.hasDepthSensing(),kt&&qt.addToRenderList(v,t),this.info.render.frame++,!0===St&&Vt.beginShadows();const r=z.state.shadowsArray;Ht.render(r,t,e),!0===St&&Vt.endShadows(),!0===this.info.autoReset&&this.info.reset();const n=v.opaque,o=v.transmissive;if(z.setupLights(),e.isArrayCamera){const r=e.cameras;if(o.length>0)for(let e=0,i=r.length;e<i;e++){ye(n,o,t,r[e])}kt&&qt.render(t);for(let e=0,n=r.length;e<n;e++){const n=r[e];pe(v,t,n,n.viewport)}}else o.length>0&&ye(n,o,t,e),kt&&qt.render(t),pe(v,t,e);null!==Y&&(Mt.updateMultisampleRenderTarget(Y),Mt.updateRenderTargetMipmap(Y)),!0===t.isScene&&t.onAfterRender(H,t,e),Zt.resetDefaultState(),it=-1,at=null,V.pop(),V.length>0?(z=V[V.length-1],!0===St&&Vt.setGlobalState(H.clippingPlanes,z.state.camera)):z=null,W.pop(),v=W.length>0?W[W.length-1]:null},this.renderShadowMap=function(t,e,r){!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld(),z=Wt.get(e,V.length),z.init(),V.push(z),xt=this.localClippingEnabled,St=Vt.init(this.clippingPlanes,xt,r),!0===St&&Vt.beginShadows(),Ht.needsUpdate=!0,Ht.render(t,e,r),!0===St&&Vt.endShadows(r),V.pop(),z=V.length>0?V[V.length-1]:null},this.getActiveCubeFace=function(){return X},this.getActiveMipmapLevel=function(){return K},this.getRenderTarget=function(){return Y},this.setRenderTargetTextures=function(t,e,r){At.get(t.texture).__webglTexture=e,At.get(t.depthTexture).__webglTexture=r;const n=At.get(t);n.__hasExternalTextures=!0,n.__autoAllocateDepthBuffer=void 0===r,n.__autoAllocateDepthBuffer||!0===_t.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),n.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(t,e){const r=At.get(t);r.__webglFramebuffer=e,r.__useDefaultFramebuffer=void 0===e},this.setRenderTarget=function(t,e=0,r=0){Y=t,X=e,K=r;let n=!0,o=null,i=!1,a=!1;if(t){const u=At.get(t);void 0!==u.__useDefaultFramebuffer?(It.bindFramebuffer($t.FRAMEBUFFER,null),n=!1):void 0===u.__webglFramebuffer?Mt.setupRenderTarget(t):u.__hasExternalTextures&&Mt.rebindTextures(t,At.get(t.texture).__webglTexture,At.get(t.depthTexture).__webglTexture);const c=t.texture;(c.isData3DTexture||c.isDataArrayTexture||c.isCompressedArrayTexture)&&(a=!0);const s=At.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(o=Array.isArray(s[e])?s[e][r]:s[e],i=!0):o=t.samples>0&&!1===Mt.useMultisampledRTT(t)?At.get(t).__webglMultisampledFramebuffer:Array.isArray(s)?s[r]:s,ut.copy(t.viewport),ct.copy(t.scissor),st=t.scissorTest}else ut.copy(mt).multiplyScalar(yt).floor(),ct.copy(bt).multiplyScalar(yt).floor(),st=gt;if(It.bindFramebuffer($t.FRAMEBUFFER,o)&&n&&It.drawBuffers(t,o),It.viewport(ut),It.scissor(ct),It.setScissorTest(st),i){const n=At.get(t.texture);$t.framebufferTexture2D($t.FRAMEBUFFER,$t.COLOR_ATTACHMENT0,$t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n.__webglTexture,r)}else if(a){const n=At.get(t.texture),o=e||0;$t.framebufferTextureLayer($t.FRAMEBUFFER,$t.COLOR_ATTACHMENT0,n.__webglTexture,r||0,o)}it=-1},this.readRenderTargetPixels=function(t,e,r,n,o,i,a){if(!t||!t.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let u=At.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(u=u[a]),u){It.bindFramebuffer($t.FRAMEBUFFER,u);try{const a=t.texture,u=a.format,c=a.type;if(!Lt.textureFormatReadable(u))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!Lt.textureTypeReadable(c))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");e>=0&&e<=t.width-n&&r>=0&&r<=t.height-o&&$t.readPixels(e,r,n,o,Jt.convert(u),Jt.convert(c),i)}finally{const t=null!==Y?At.get(Y).__webglFramebuffer:null;It.bindFramebuffer($t.FRAMEBUFFER,t)}}},this.readRenderTargetPixelsAsync=async function(t,e,r,n,o,i,a){if(!t||!t.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let u=At.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(u=u[a]),u){It.bindFramebuffer($t.FRAMEBUFFER,u);try{const a=t.texture,u=a.format,c=a.type;if(!Lt.textureFormatReadable(u))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Lt.textureTypeReadable(c))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(e>=0&&e<=t.width-n&&r>=0&&r<=t.height-o){const t=$t.createBuffer();$t.bindBuffer($t.PIXEL_PACK_BUFFER,t),$t.bufferData($t.PIXEL_PACK_BUFFER,i.byteLength,$t.STREAM_READ),$t.readPixels(e,r,n,o,Jt.convert(u),Jt.convert(c),0),$t.flush();const a=$t.fenceSync($t.SYNC_GPU_COMMANDS_COMPLETE,0);await(0,ot.Qe)($t,a,4);try{$t.bindBuffer($t.PIXEL_PACK_BUFFER,t),$t.getBufferSubData($t.PIXEL_PACK_BUFFER,0,i)}finally{$t.deleteBuffer(t),$t.deleteSync(a)}return i}}finally{const t=null!==Y?At.get(Y).__webglFramebuffer:null;It.bindFramebuffer($t.FRAMEBUFFER,t)}}},this.copyFramebufferToTexture=function(t,e=null,r=0){!0!==t.isTexture&&(console.warn("WebGLRenderer: copyFramebufferToTexture function signature has changed."),e=arguments[0]||null,t=arguments[1]);const n=Math.pow(2,-r),o=Math.floor(t.image.width*n),i=Math.floor(t.image.height*n),a=null!==e?e.x:0,u=null!==e?e.y:0;Mt.setTexture2D(t,0),$t.copyTexSubImage2D($t.TEXTURE_2D,r,0,0,a,u,o,i),It.unbindTexture()},this.copyTextureToTexture=function(t,e,r=null,n=null,o=0){let i,a,u,c,s,l;!0!==t.isTexture&&(console.warn("WebGLRenderer: copyTextureToTexture function signature has changed."),n=arguments[0]||null,t=arguments[1],e=arguments[2],o=arguments[3]||0,r=null),null!==r?(i=r.max.x-r.min.x,a=r.max.y-r.min.y,u=r.min.x,c=r.min.y):(i=t.image.width,a=t.image.height,u=0,c=0),null!==n?(s=n.x,l=n.y):(s=0,l=0);const f=Jt.convert(e.format),h=Jt.convert(e.type);Mt.setTexture2D(e,0),$t.pixelStorei($t.UNPACK_FLIP_Y_WEBGL,e.flipY),$t.pixelStorei($t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),$t.pixelStorei($t.UNPACK_ALIGNMENT,e.unpackAlignment);const p=$t.getParameter($t.UNPACK_ROW_LENGTH),y=$t.getParameter($t.UNPACK_IMAGE_HEIGHT),d=$t.getParameter($t.UNPACK_SKIP_PIXELS),v=$t.getParameter($t.UNPACK_SKIP_ROWS),m=$t.getParameter($t.UNPACK_SKIP_IMAGES),b=t.isCompressedTexture?t.mipmaps[o]:t.image;$t.pixelStorei($t.UNPACK_ROW_LENGTH,b.width),$t.pixelStorei($t.UNPACK_IMAGE_HEIGHT,b.height),$t.pixelStorei($t.UNPACK_SKIP_PIXELS,u),$t.pixelStorei($t.UNPACK_SKIP_ROWS,c),t.isDataTexture?$t.texSubImage2D($t.TEXTURE_2D,o,s,l,i,a,f,h,b.data):t.isCompressedTexture?$t.compressedTexSubImage2D($t.TEXTURE_2D,o,s,l,b.width,b.height,f,b.data):$t.texSubImage2D($t.TEXTURE_2D,o,s,l,i,a,f,h,b),$t.pixelStorei($t.UNPACK_ROW_LENGTH,p),$t.pixelStorei($t.UNPACK_IMAGE_HEIGHT,y),$t.pixelStorei($t.UNPACK_SKIP_PIXELS,d),$t.pixelStorei($t.UNPACK_SKIP_ROWS,v),$t.pixelStorei($t.UNPACK_SKIP_IMAGES,m),0===o&&e.generateMipmaps&&$t.generateMipmap($t.TEXTURE_2D),It.unbindTexture()},this.copyTextureToTexture3D=function(t,e,r=null,n=null,o=0){let i,a,u,c,s,l,f,h,p;!0!==t.isTexture&&(console.warn("WebGLRenderer: copyTextureToTexture3D function signature has changed."),r=arguments[0]||null,n=arguments[1]||null,t=arguments[2],e=arguments[3],o=arguments[4]||0);const y=t.isCompressedTexture?t.mipmaps[o]:t.image;null!==r?(i=r.max.x-r.min.x,a=r.max.y-r.min.y,u=r.max.z-r.min.z,c=r.min.x,s=r.min.y,l=r.min.z):(i=y.width,a=y.height,u=y.depth,c=0,s=0,l=0),null!==n?(f=n.x,h=n.y,p=n.z):(f=0,h=0,p=0);const d=Jt.convert(e.format),v=Jt.convert(e.type);let m;if(e.isData3DTexture)Mt.setTexture3D(e,0),m=$t.TEXTURE_3D;else{if(!e.isDataArrayTexture&&!e.isCompressedArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Mt.setTexture2DArray(e,0),m=$t.TEXTURE_2D_ARRAY}$t.pixelStorei($t.UNPACK_FLIP_Y_WEBGL,e.flipY),$t.pixelStorei($t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),$t.pixelStorei($t.UNPACK_ALIGNMENT,e.unpackAlignment);const b=$t.getParameter($t.UNPACK_ROW_LENGTH),g=$t.getParameter($t.UNPACK_IMAGE_HEIGHT),w=$t.getParameter($t.UNPACK_SKIP_PIXELS),S=$t.getParameter($t.UNPACK_SKIP_ROWS),x=$t.getParameter($t.UNPACK_SKIP_IMAGES);$t.pixelStorei($t.UNPACK_ROW_LENGTH,y.width),$t.pixelStorei($t.UNPACK_IMAGE_HEIGHT,y.height),$t.pixelStorei($t.UNPACK_SKIP_PIXELS,c),$t.pixelStorei($t.UNPACK_SKIP_ROWS,s),$t.pixelStorei($t.UNPACK_SKIP_IMAGES,l),t.isDataTexture||t.isData3DTexture?$t.texSubImage3D(m,o,f,h,p,i,a,u,d,v,y.data):e.isCompressedArrayTexture?$t.compressedTexSubImage3D(m,o,f,h,p,i,a,u,d,y.data):$t.texSubImage3D(m,o,f,h,p,i,a,u,d,v,y),$t.pixelStorei($t.UNPACK_ROW_LENGTH,b),$t.pixelStorei($t.UNPACK_IMAGE_HEIGHT,g),$t.pixelStorei($t.UNPACK_SKIP_PIXELS,w),$t.pixelStorei($t.UNPACK_SKIP_ROWS,S),$t.pixelStorei($t.UNPACK_SKIP_IMAGES,x),0===o&&e.generateMipmaps&&$t.generateMipmap(m),It.unbindTexture()},this.initRenderTarget=function(t){void 0===At.get(t).__webglFramebuffer&&Mt.setupRenderTarget(t)},this.initTexture=function(t){t.isCubeTexture?Mt.setTextureCube(t,0):t.isData3DTexture?Mt.setTexture3D(t,0):t.isDataArrayTexture||t.isCompressedArrayTexture?Mt.setTexture2DArray(t,0):Mt.setTexture2D(t,0),It.unbindTexture()},this.resetState=function(){X=0,K=0,Y=null,It.reset(),Zt.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return o._RZ}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t;const e=this.getContext();e.drawingBufferColorSpace=t===o.ntt?"display-p3":"srgb",e.unpackColorSpace=n.ep.workingColorSpace===o.AmZ?"display-p3":"srgb"}}var at=r(85285),ut=r(5164);function ct(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return st(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?st(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function st(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}ut.T.prototype.enableWasm=function(){var t=this;if(!this._object3D){this.deleted=!1,this._object3D=new c.Iq.Object3D,this.matrixWorld.enableWasm(this._object3D.getMatrixWorld()),this.matrix.enableWasm(this._object3D.getMatrix());var e=new c.Iq.CallbackHandler;e.callbackFn=function(){t.deleted=!0},this._object3D.setDeleteCallbackHandler(e)}};var lt=ut.T.prototype.add;ut.T.prototype.add=function(){if(this.deleted)return this;for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];if(lt.call.apply(lt,[this].concat(e)),this._object3D){var n,o=ct(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;ft(this,i)}}catch(t){o.e(t)}finally{o.f()}}return this};var ft=function(t,e){e._object3D||(e.enableWasm(),e.updateMatrix()),t._object3D.add(e._object3D);var r,n=ct(e.children);try{for(n.s();!(r=n.n()).done;){var o=r.value;ft(e,o)}}catch(t){n.e(t)}finally{n.f()}return e},ht=ut.T.prototype.remove;ut.T.prototype.remove=function(){if(this.deleted)return this;for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];if(this._object3D){var n,o=ct(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;pt(this,i)}}catch(t){o.e(t)}finally{o.f()}}return ht.call.apply(ht,[this].concat(e)),this};var pt=function(t,e){e._object3D||(e.enableWasm(),e.updateMatrix()),t._object3D.remove(e._object3D);var r,n=ct(e.children);try{for(n.s();!(r=n.n()).done;){var o=r.value;pt(e,o)}}catch(t){n.e(t)}finally{n.f()}return e},yt=ut.T.prototype.removeFromParent;ut.T.prototype.removeFromParent=function(){return this.deleted||(this._object3D&&(console.log(this,this.parent),this._object3D.removeFromParent()),yt.call(this)),this};var dt=ut.T.prototype.clear;ut.T.prototype.clear=function(){return this.deleted||(this._object3D&&this._object3D.clear(),dt.call(this)),this},ut.T.prototype.newWorldMatrixMemory=function(t){this.deleted||(this._object3D?this._object3D.newWorldMatrixMemory(t):console.error("Object3D is not backed by WASM: ",this))},ut.T.prototype.clearWorldMatrixMemory=function(){this.deleted||(this._object3D?this._object3D.clearWorldMatrixMemory():console.error("Object3D is not backed by WASM: ",this))},ut.T.prototype.addAnimation=function(t){if(!this.deleted)return this._object3D?this._object3D.addAnimation(t):void console.error("Object3D is not backed by WASM: ",this)},ut.T.prototype.removeAnimation=function(t){this.deleted||(this._object3D?this._object3D.removeAnimation(t):console.error("Object3D is not backed by WASM: ",this))},ut.T.prototype.clearAnimations=function(){this.deleted||(this._object3D?this._object3D.clearAnimations():console.error("Object3D is not backed by WASM: ",this))};function vt(t){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vt(t)}function mt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gt(n.key),n)}}function bt(t,e,r){return(e=gt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gt(t){var e=function(t,e){if("object"!=vt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=vt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==vt(e)?e:e+""}g.y.prototype.enableWasm=function(t){var e=this;if(this._matrix4)throw new Error("Matrix4 already enabled, don't enable again");this._matrix4=t||new c.Iq.Matrix4,this._elementPtr=this._matrix4.getElements();var r=this._elementPtr/4;this.elements=c.Iq.HEAPF32.subarray(r,r+16);var n=new c.Iq.CallbackHandler;n.callbackFn=function(){e._matrix4=void 0,e.elements=[]},this._matrix4.setRemoveElementReferenceCallback(n)},n.ep.enabled=!0,n.ep._workingColorSpace=o.KI_;var wt=function(){return t=function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=e,bt(this,"scene",void 0),bt(this,"camera",void 0),bt(this,"renderer",void 0),bt(this,"composer",void 0),bt(this,"postProcessing",void 0),this.scene=new i.x,this.scene.matrixWorldAutoUpdate=!1,this.camera=r,this.scene.add(this.camera),this.renderer=new it({canvas:e,powerPreference:"high-performance",antialias:!1,stencil:!1,depth:!1,devicePixelRatio:1,alpha:n}),this.renderer.toneMappingExposure=1.5,this.renderer.localClippingEnabled=!0,this.renderer.shadowMap.autoUpdate=!1,this.renderer.debug.checkShaderErrors="prod"!==at.Vi,this.renderer.info.autoReset=!1,this.renderer.sortObjects=!1,this.renderer.outputColorSpace=o.GUF,this.composer=new u.xC(this.renderer),this.composer.addPass(new u.CD(this.scene,this.camera)),this.postProcessing=new v(this),this.composer.addPass(this.postProcessing)},(e=[{key:"render",value:function(t){this.composer.render(t)}},{key:"updateResolution",value:function(t,e){this.renderer.setSize(t,e),this.renderer.setSize(t*c.Xd.video.renderScale,e*c.Xd.video.renderScale,!1),this.composer.setSize(t*c.Xd.video.renderScale,e*c.Xd.video.renderScale,!1),this.camera instanceof a.c&&(this.camera.aspect=t/e,this.camera.updateProjectionMatrix())}},{key:"dispose",value:function(){this.renderer.dispose(),this.renderer.forceContextLoss(),this.composer.dispose(),this.postProcessing.dispose(),this.canvas.remove()}}])&&mt(t.prototype,e),r&&mt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()},38993:(t,e,r)=>{r.d(e,{c:()=>n});var n="\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : stegu\n//     Lastmod : 20201014 (stegu)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//               https://github.com/stegu/webgl-noise\n//\nvec3 _mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 _mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n  return _mod289(((x*34.0)+1.0)*x);\n}\nvec4 taylorInvSqrt(vec4 r)\n{\nreturn 1.79284291400159 - 0.85373472095314 * r;\n}\nfloat snoise(vec3 v)\n{\nconst vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\nconst vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n// First corner\nvec3 i  = floor(v + dot(v, C.yyy) );\nvec3 x0 =   v - i + dot(i, C.xxx) ;\n// Other corners\nvec3 g = step(x0.yzx, x0.xyz);\nvec3 l = 1.0 - g;\nvec3 i1 = min( g.xyz, l.zxy );\nvec3 i2 = max( g.xyz, l.zxy );\n//   x0 = x0 - 0.0 + 0.0 * C.xxx;\n//   x1 = x0 - i1  + 1.0 * C.xxx;\n//   x2 = x0 - i2  + 2.0 * C.xxx;\n//   x3 = x0 - 1.0 + 3.0 * C.xxx;\nvec3 x1 = x0 - i1 + C.xxx;\nvec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\nvec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n// Permutations\ni = _mod289(i);\nvec4 p = permute( permute( permute(\n          i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n        + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n        + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\nfloat n_ = 0.142857142857; // 1.0/7.0\nvec3  ns = n_ * D.wyz - D.xzx;\nvec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\nvec4 x_ = floor(j * ns.z);\nvec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\nvec4 x = x_ *ns.x + ns.yyyy;\nvec4 y = y_ *ns.x + ns.yyyy;\nvec4 h = 1.0 - abs(x) - abs(y);\nvec4 b0 = vec4( x.xy, y.xy );\nvec4 b1 = vec4( x.zw, y.zw );\n//vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n//vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\nvec4 s0 = floor(b0)*2.0 + 1.0;\nvec4 s1 = floor(b1)*2.0 + 1.0;\nvec4 sh = -step(h, vec4(0.0));\nvec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\nvec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\nvec3 p0 = vec3(a0.xy,h.x);\nvec3 p1 = vec3(a0.zw,h.y);\nvec3 p2 = vec3(a1.xy,h.z);\nvec3 p3 = vec3(a1.zw,h.w);\n//Normalise gradients\nvec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\np0 *= norm.x;\np1 *= norm.y;\np2 *= norm.z;\np3 *= norm.w;\n// Mix final noise value\nvec4 m = max(0.5 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\nm = m * m;\nreturn 105.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                             dot(p2,x2), dot(p3,x3) ) );\n}\nfloat FBM(vec3 p) {\nfloat value = 0.0;\nfloat amplitude = 0.5;\nfloat frequency = 0.0;\nfor (int i = 0; i < 6; ++i) {\n value += amplitude * snoise(p);\n p *= 2.0;\n amplitude *= 0.5;\n}\nreturn value;\n}\n"},90678:(t,e,r)=>{r.d(e,{t:()=>_});var n=r(97939),o=r(53909),i=r(6534),a=r(28800),u=r(6871),c=r(88771),s=r(57662),l=r(99908),f=r(55970),h=r(9284),p=r(78133),y=r(88757),d=r(61182),v=r(56588),m=r(31154),b=r(55174),g=r(57241),w=r(34999),S=r(38287);function x(t){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x(t)}function O(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return P(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?P(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function P(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function E(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,T(n.key),n)}}function j(t,e,r){return e&&E(t.prototype,e),r&&E(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function k(t,e,r){return(e=T(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T(t){var e=function(t,e){if("object"!=x(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=x(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==x(e)?e:e+""}var _=j((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),k(this,"name",void 0),k(this,"shaders",[])})),L=[n.qn,o.T,i.x,a.F,u.j,c.U,s.E,l.W,f.x,h.I,p.R,y.Y,d.l,v.L,m.v,b.k,g.F,w.n],I=/^[ \t]*#include +<([\w\d./]+)>/gm,C=function(t,e){return t.replace(I,(function(t,r){var n=e[r]||S.W[r];if(void 0===n)throw new Error("Can not resolve #include <"+r+">");return C(n,e)}))};L.forEach((function(t){t.prototype.onBeforeCompile=function(t){if(this.mods){var e,r={},n=O(this.mods);try{for(n.s();!(e=n.n()).done;){var o,i=e.value;null===(o=i.shaders)||void 0===o||o.push(t),i.compile(t,r)}}catch(t){n.e(t)}finally{n.f()}t.fragmentShader=C(t.fragmentShader,r),t.vertexShader=C(t.vertexShader,r)}},t.prototype.addMod=function(t){this instanceof i.x||(this.mods||(this.mods=[]),this.mods=this.mods.filter((function(e){return e.name!==t.name})),this.mods.push(t),this.needsUpdate=!0)},t.prototype.removeMod=function(t){this.mods&&(this.mods=this.mods.filter((function(e){return e!==t})),this.needsUpdate=!0)}}))},57103:(t,e,r)=>{r.d(e,{J:()=>g,j:()=>b});var n=r(6534),o=r(19528),i=r(63463),a=r(33966),u=r(48418);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,m(n.key),n)}}function f(t,e,r){return e&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function h(t,e,r){return e=y(e),function(t,e){if(e&&("object"==c(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,p()?Reflect.construct(e,r||[],y(t).constructor):e.apply(t,r))}function p(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(p=function(){return!!t})()}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}function d(t,e){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},d(t,e)}function v(t,e,r){return(e=m(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m(t){var e=function(t,e){if("object"!=c(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==c(e)?e:e+""}var b=function(t){function e(t){var r,a,c;if(s(this,e),v(c=h(this,e,[new n.x({map:new o.x,alphaTest:.5})]),"_canvas",void 0),v(c,"_content",void 0),v(c,"_height",void 0),v(c,"_texture",void 0),v(c,"_scale",void 0),null===(r=u.Xx.map)||void 0===r||r.registerDynamicMesh(c),c._canvas=document.createElement("canvas"),c._content=t.content,c._height=t.height,!c.material.map)throw new Error("Texture is undefined");return c._texture=c.material.map,c._texture.minFilter=i.wem,c._scale=null!==(a=t.scale)&&void 0!==a?a:1,c.rasterize(),c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(e,t),f(e,[{key:"setScale",value:function(t){this._scale=t,this.rasterize()}},{key:"content",get:function(){return this._content},set:function(t){this._content=t,this.rasterize()}},{key:"rasterize",value:function(){var t=this,e=this._canvas.getContext("2d");if(!e)throw new Error("Canvas context is undefined");e.clearRect(0,0,this._canvas.width,this._canvas.height),this._canvas.height=this._height,this._canvas.width=0===this._content.length?1:0,this._content.forEach((function(e){e.content.rasterize();var r=t._height/e.content.canvas.height;t._canvas.width+=Math.floor(e.content.canvas.width*r)}));var r=0;this._content.forEach((function(n){var o=t._height/n.content.canvas.height,i=Math.floor(n.content.canvas.width*o);e.drawImage(n.content.canvas,r,0,i,t._canvas.height),r+=i})),this._texture.dispose(),this._texture.image=this._canvas,this._texture.needsUpdate=!0,this.material.needsUpdate=!0,this.scale.set(.005*this._canvas.width*this._scale,.005*this._canvas.height*this._scale,1),this.updateMatrix()}}])}(a.j),g=f((function t(){s(this,t),v(this,"canvas",void 0)}))},5421:(t,e,r)=>{function n(t,e){t instanceof Array?t.forEach((function(t){return e(t)})):e(t)}r.d(e,{h:()=>n})},47473:(t,e,r)=>{r.d(e,{X:()=>o});var n=r(47472);function o(t,e){t instanceof Array?t.forEach((function(t){return o(t,e)})):t instanceof n.K?e(t):t.traverse((function(t){t instanceof n.K&&e(t)}))}},91361:(t,e,r)=>{r.d(e,{Ab:()=>a,B5:()=>o,EP:()=>i,b$:()=>u});var n=r(48418),o=.5;function i(t){n.Xd.audio.master=t,this.audioListener.setMasterVolume(t*n.Xd.audio.sfx*o),n.g2.setVolume(t*n.Xd.audio.music)}function a(t){n.Xd.audio.sfx=t,this.audioListener.setMasterVolume(t*n.Xd.audio.master*o)}function u(t){n.Xd.audio.music=t,n.g2.setVolume(t*n.Xd.audio.master)}},97774:(t,e,r)=>{r.d(e,{u:()=>l});var n=r(75203);var o=r(9332),i=r(48418);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s(n.key),n)}}function c(t,e,r){return(e=s(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(t){var e=function(t,e){if("object"!=a(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==a(e)?e:e+""}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return e=t,a=[{key:"getUserId",value:function(){if(t.profile)return t.profile.id;var e=i.tO.get("userId");return e&&40===e.length||(e=function(){for(var t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<4;r++)t+=e.charAt(Math.floor(62*Math.random()));return(0,n.Z)()+t}(),i.tO.set("userId",e)),e}},{key:"getSessionHash",value:function(){var e;return null!==(e=t.sessionHash)&&void 0!==e?e:t.getUserId()}},{key:"getSessionId",value:function(){try{var t;return null!==(t=sessionStorage.getItem("sid"))&&void 0!==t?t:void 0}catch(t){(0,o.Z)()}}},{key:"setSessionInfo",value:function(e,r){try{sessionStorage.setItem("sid",e)}catch(t){(0,o.Z)()}t.sessionHash=r}},{key:"clearSessionInfo",value:function(){try{sessionStorage.removeItem("sid")}catch(t){(0,o.Z)()}t.sessionHash=void 0}},{key:"setFirebaseProfile",value:function(e){t.profile=e,null!=e&&e.trackingId&&i.tO.set("trackingId",e.trackingId)}},{key:"getTrackingId",value:function(){var e;if(null!==(e=t.profile)&&void 0!==e&&e.trackingId)return t.profile.trackingId;var r=i.tO.get("trackingId");return r||(r=t.getUserId(),i.tO.set("trackingId",r)),r}}],(r=null)&&u(e.prototype,r),a&&u(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,a}();c(l,"sessionHash",void 0),c(l,"profile",void 0)},7142:(t,e,r)=>{r.d(e,{Y:()=>n});var n=function(t){var e=0;return t.forEach((function(t){return e+=t})),e/t.length}},68957:(t,e,r)=>{r.d(e,{Z:()=>o});var n=r(85285);function o(){return"dev"===n.Vi&&n.eL?"dev":"dev"===n.Vi?"staging":n.Vi}},69300:(t,e,r)=>{r.d(e,{h:()=>a});var n=r(69628);function o(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function a(t){var e,r,o,i,a,c,s=t.attachedItems.find((function(t){return t.type===n.ItemType.WRAP})),l=t.attachedItems.find((function(t){return t.type===n.ItemType.TIRE}));return{instanceId:u(t),modelId:t.type===n.ItemType.MODEL?t.modelId:n.Model.CAVALLINO_288_GTO,wrap:{id:null!==(e=null==s?void 0:s.wrapId)&&void 0!==e?e:n.Wrap.BLOODHOUND_RED,float:null!==(r=null==s?void 0:s.float)&&void 0!==r?r:0,pattern:null!==(o=null==s?void 0:s.pattern)&&void 0!==o?o:1},tire:{id:null!==(i=null==l?void 0:l.tireId)&&void 0!==i?i:n.Tire.CLASSIC,pattern:null!==(a=null==l?void 0:l.pattern)&&void 0!==a?a:1,float:null!==(c=null==s?void 0:s.float)&&void 0!==c?c:0}}}function u(t){var e=t.attachedItems.map((function(t){return t.instanceId}));return[t.instanceId].concat(o(e)).join("-")}},99648:(t,e,r)=>{r.d(e,{h:()=>o});var n=r(48418);function o(t){for(var e=n.Iq._malloc(t.byteLength),r=0;r<t.byteLength;r++)n.Iq.HEAPU8[e+r]=t[r];return e}},28952:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){o=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},u="function"==typeof Symbol?Symbol:{},c=u.iterator||"@@iterator",s=u.asyncIterator||"@@asyncIterator",l=u.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var o=e&&e.prototype instanceof g?e:g,i=Object.create(o.prototype),u=new C(n||[]);return a(i,"_invoke",{value:T(t,r,u)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var y="suspendedStart",d="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function S(){}var x={};f(x,c,(function(){return this}));var O=Object.getPrototypeOf,P=O&&O(O(A([])));P&&P!==r&&i.call(P,c)&&(x=P);var E=S.prototype=g.prototype=Object.create(x);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,a,u,c){var s=p(t[o],t,a);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==n(f)&&i.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,u,c)}),(function(t){r("throw",t,u,c)})):e.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,c)}))}c(s.arg)}var o;a(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}})}function T(e,r,n){var o=y;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=_(u,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===y)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var s=p(e,r,n);if("normal"===s.type){if(o=n.done?m:d,s.arg===b)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=m,n.method="throw",n.arg=s.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(i.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(n(e)+" is not iterable")}return w.prototype=S,a(E,"constructor",{value:S,configurable:!0}),a(S,"constructor",{value:w,configurable:!0}),w.displayName=f(S,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,S):(t.__proto__=S,f(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(k.prototype),f(k.prototype,s,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(h(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),f(E,l,"Generator"),f(E,c,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),s=i.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function i(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function a(t){return u.apply(this,arguments)}function u(){var t;return t=o().mark((function t(e){var r;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=Array.isArray(e)?e:[e]).forEach((function(t){return t.wait_for_hydration()})),t.abrupt("return",new Promise((function(t){var e=setInterval((function(){r=r.filter((function(t){return!t.is_hydrated()})),0===r.length&&(clearInterval(e),t())}),10)})));case 3:case"end":return t.stop()}}),t)})),u=function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function u(t){i(a,n,o,u,c,"next",t)}function c(t){i(a,n,o,u,c,"throw",t)}u(void 0)}))},u.apply(this,arguments)}r.d(e,{e:()=>a})},82140:(t,e,r)=>{r.d(e,{I0:()=>d,h:()=>y,v9:()=>v});var n=r(93192),o=r(27255),i=r(17902),a=r(47056),u=r(96849),c=r(61201),s=r(87331),l=r(18973),f=r(41475),h=r(71274),p=r(87655),y=(0,r(52438).xC)({reducer:{mainMenu:n.ZP,global:o.ZP,ui:i.ZP,game:a.ZP,grandPrix:u.ZP,tutorial:c.ZP,timeTrial:s.Z,spectator:l.ZP,gamepad:f.Z,music:h.ZP}}),d=function(){return(0,p.I0)()},v=p.v9},4805:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a(n.key),n)}}function i(t,e,r){return(e=a(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}r.d(e,{U:()=>u});var u=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,"lastNumCoins",0),i(this,"coinCounterRef",void 0),i(this,"backgroundRef",void 0),i(this,"coinCanvasCb",void 0)},(e=[{key:"setCoinCanvasCb",value:function(t){this.coinCanvasCb=t}},{key:"setRef",value:function(t){this.coinCounterRef=t}},{key:"setBackgroundRef",value:function(t){this.backgroundRef=t}},{key:"setCoins",value:function(t){var e;t!==this.lastNumCoins&&(t>15&&(t=15),this.coinCounterRef&&(this.coinCounterRef.innerText=t.toString(),this.coinCounterRef.style.color=15===t?"#f9e447":"#ffffff",this.backgroundRef))&&(this.backgroundRef.style.width="".concat(t/15*100,"%"),t>this.lastNumCoins&&(null===(e=this.coinCanvasCb)||void 0===e||e.call(this)),this.lastNumCoins=t)}}])&&o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}())},79594:(t,e,r)=>{r.d(e,{n:()=>s});var n=r(82140),o=r(47056);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,c(n.key),n)}}function u(t,e,r){return(e=c(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}var s=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,"inventory",[]),u(this,"lastInventoryLength",0),u(this,"timeout",void 0)},(e=[{key:"setInventory",value:function(t){this.updateVisibility(t),this.inventory=t}},{key:"updateVisibility",value:function(t){var e=this;t.length!==this.lastInventoryLength&&(this.lastInventoryLength=t.length,this.timeout&&clearTimeout(this.timeout),t.length>0?this.setVisibility(!0):this.timeout=setTimeout((function(){return e.setVisibility(!1)}),2e3))}},{key:"setVisibility",value:function(t){n.h.dispatch((0,o.yi)(t))}},{key:"getInventoryItem",value:function(t){return this.inventory[t]}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}())},71881:(t,e,r)=>{r.d(e,{$:()=>n});var n=function(t){return t[t.NO_ITEM=0]="NO_ITEM",t[t.NITRO_ITEM=1]="NITRO_ITEM",t[t.CRATE_ITEM=2]="CRATE_ITEM",t[t.MISSILE_ITEM=3]="MISSILE_ITEM",t[t.HOMING_MISSILE_ITEM=4]="HOMING_MISSILE_ITEM",t[t.MEGA_MISSILE_ITEM=5]="MEGA_MISSILE_ITEM",t[t.COIN_ITEM=6]="COIN_ITEM",t[t.TRIPLE_NITRO_ITEM=7]="TRIPLE_NITRO_ITEM",t[t.DOUBLE_NITRO_ITEM=8]="DOUBLE_NITRO_ITEM",t[t.DOUBLE_HOMING_MISSILE_ITEM=9]="DOUBLE_HOMING_MISSILE_ITEM",t[t.FIRE_NITRO_ITEM=10]="FIRE_NITRO_ITEM",t}({})},65124:(t,e,r)=>{r.d(e,{T:()=>l});var n=r(82140);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s(n.key),n)}}function c(t,e,r){return(e=s(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var l=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,"paused",!1),c(this,"fpsElement",null),c(this,"frameTimeElement",null),c(this,"physicsTimeElement",null),c(this,"gpuTimeElement",null),c(this,"bufferSize",500),c(this,"visualRefreshRate",11),c(this,"visualAverageWindowSize",11),c(this,"frame",0),c(this,"fps",void 0),c(this,"latestFps",0),c(this,"cpuTime",void 0),c(this,"latestCpuTime",0),c(this,"physicsTime",void 0),c(this,"latestPhysicsTime",0),c(this,"gpuTime",void 0),c(this,"latestGpuTime",0),c(this,"physicsTimeBuffer",[]),this.createBuffers()},(e=[{key:"createBuffers",value:function(){this.fps=new Float32Array(this.bufferSize),this.cpuTime=new Float32Array(this.bufferSize),this.physicsTime=new Float32Array(this.bufferSize),this.gpuTime=new Float32Array(this.bufferSize)}},{key:"setBufferSize",value:function(t){this.bufferSize=t,this.createBuffers()}},{key:"bufferStart",get:function(){return this.frame%this.bufferSize}},{key:"reportGpuTime",value:function(t,e){this.paused||(this.gpuTime[t%this.bufferSize]=e,this.latestGpuTime=e)}},{key:"fixedUpdate",value:function(t){this.paused||this.physicsTimeBuffer.push(t)}},{key:"update",value:function(t,e,r){if(!this.paused){this.frame=t,this.fps[t%this.bufferSize]=e,this.latestFps=e,this.cpuTime[t%this.bufferSize]=r,this.latestCpuTime=r;var n=this.physicsTimeBuffer.reduce((function(t,e){return t+e}),0);this.physicsTime[t%this.bufferSize]=n,this.latestPhysicsTime=n,this.physicsTimeBuffer=[],t%this.visualRefreshRate==0&&this.updateVisuals()}}},{key:"updateVisuals",value:function(){if(this.fpsElement){var t=Math.round(this.average(this.fps));this.fpsElement.textContent="".concat(t)}if(this.frameTimeElement){var e=this.average(this.cpuTime);this.frameTimeElement.textContent="".concat(e.toFixed(2)," ms")}if(this.physicsTimeElement){var r=this.average(this.physicsTime);this.physicsTimeElement.textContent="".concat(r.toFixed(2)," ms")}if(this.gpuTimeElement){var n=this.average(this.gpuTime);this.gpuTimeElement.textContent="".concat(n.toFixed(2)," ms")}}},{key:"average",value:function(t){for(var e=0,r=0;r<this.visualAverageWindowSize;r++)e+=t[(this.bufferStart-r+t.length)%t.length];return e/this.visualAverageWindowSize}},{key:"downloadReport",value:function(){for(var t,e="frame, fps, cpu, phys, gpu\n",r=0;r<this.bufferSize;r++){var o=(this.bufferStart+r)%this.bufferSize;e+="".concat(this.frame-this.bufferSize+r,", ").concat(this.fps[o],", ").concat(this.cpuTime[o],", ").concat(this.physicsTime[o],", ").concat(this.gpuTime[o],"\n")}var i=document.createElement("a");i.href="data:text/csv;charset=utf-8,"+encodeURI(e),i.target="_blank";var a=null===(t=n.h.getState().global.profile)||void 0===t?void 0:t.username;i.download="performance-report-".concat(a?a+"-":"").concat((new Date).toISOString(),".csv"),i.click()}},{key:"uploadReport",value:function(t){this.paused=!0;var e=t.split("\n").filter((function(t){return""!==t.trim()}));this.setBufferSize(e.length-1);for(var r=1;r<e.length;r++){var n=i(e[r].split(",").map((function(t){return t.trim()})),5),o=n[0],a=n[1],u=n[2],c=n[3],s=n[4];if(o&&a&&u&&c&&s){var l=(r-1)%this.bufferSize;this.fps[l]=parseFloat(a),this.cpuTime[l]=parseFloat(u),this.physicsTime[l]=parseFloat(c),this.gpuTime[l]=parseFloat(s)}}var f=e[e.length-1].split(",")[0].trim();this.frame=parseInt(f)}}])&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}())},312:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a(n.key),n)}}function i(t,e,r){return(e=a(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}r.d(e,{o:()=>u});var u=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,"ref",void 0),i(this,"completionListeners",void 0),i(this,"progress",0)},(e=[{key:"setRef",value:function(t,e){this.ref=t,this.completionListeners=e,this.setProgress(this.progress)}},{key:"setProgress",value:function(t){this.ref&&(this.ref.style.width="".concat(30+70*t,"%"),this.progress=t,1===t&&this.completionListeners&&this.completionListeners())}}])&&o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}())},73967:(t,e,r)=>{t.exports=r.p+"f1998d5ed66bc74f72b2.webp"}}]);